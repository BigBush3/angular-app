!function(){var t,n,e,r,a,i,o,s={version:"0.7.35",container:null,data:[]},l=10,u=1,c={},h={};if(s.display=function(f){var p,d=s.container,k=[],z=0,A=!1;G((t=P.set(f).applyDefaults(f)).zoomextend)&&(l=t.zoomextend),G(t.zoomlevel)&&(u=t.zoomlevel);var N=document.getElementById(t.container);if(N){e="#"+t.container;var j=window.getComputedStyle(N,null);parseInt(j.width)||t.width||(N.style.width=H(N.parentNode.clientWidth))}else e="body",N=null;var W=[16,16],$=Qt(),Z=G(t.background.width)?$+t.background.width:$,X=window.devicePixelRatio||1,J=Vt(t.projection,t.projectionRatio);if(J){t.lines.graticule.lat&&"outline"===t.lines.graticule.lat.pos[0]&&(J.scale-=2);var K=J.ratio,tt=Math.round($/K),rt=Math.round(Z/K),ht=J.scale*$/1024,ft=t.stars.size,pt=t.dsos.size||ft,dt=t.stars.exponent,gt=t.dsos.exponent||dt,vt=1,mt=b(t.center),bt=t.datapath;"body"!==e&&(N.style.height=H(rt)),n=s.projection(t.projection).rotate(mt).translate([Z/2,rt/2]).scale(ht*u),r=d3.geo.zoom().projection(n).center([Z/2,rt/2]).scaleExtent([ht,ht*l]).on("zoom.redraw",jt),ht*=u;var wt=d3.select(e).selectAll("canvas"),xt=""!==t.culture&&"iau"!==t.culture?t.culture:"";0===wt[0].length&&(wt=d3.select(e).append("canvas")),wt.style("width",H(Z)).style("height",H(rt)).attr("width",Z*X).attr("height",rt*X);var St=wt.node().getContext("2d");St.setTransform(X,0,0,X,0,0);var _t=d3.geo.graticule().minorStep([15,10]);a=d3.geo.path().projection(n).context(St),d?d.selectAll(e+" *").remove():d=d3.select(e).append("container"),t.interactive?(wt.call(r),d3.select(e).on("dblclick",function(){return Tt(1.5625),!1})):wt.attr("style","cursor: default!important"),Rt(J.clip),d3.select(window).on("resize",At),!0===t.interactive&&!0===t.controls&&null===U("celestial-zoomin")&&(d3.select(e).append("input").attr("type","button").attr("id","celestial-zoomin").attr("value","+").on("click",function(){return Tt(1.25),!1}),d3.select(e).append("input").attr("type","button").attr("id","celestial-zoomout").attr("value","\u2212").on("click",function(){return Tt(.8),!1})),i=d3.geo.circle().angle([90]),o=d3.geo.circle().angle([179.9]),function(t){var n=P.set(t),r=s.projections(),a=s.eulerAngles(),i=d3.select(e+" ~ #celestial-form");i.size()<1&&(i=d3.select(e).select(function(){return this.parentNode}).append("div").attr("id","celestial-form"));var o=i.append("div").attr("class","ctrl").append("form").attr("id","params").attr("name","params").attr("method","get").attr("action","#"),l=o.append("div").attr("class","col").attr("id","general");l.append("label").attr("title","Map width in pixel, 0 indicates full width").attr("for","width").html("Width "),l.append("input").attr("type","number").attr("maxlength","4").attr("max","20000").attr("min","0").attr("title","Map width").attr("id","width").attr("value",n.width).on("change",function(){var t=this.value;!1!==at(this)&&(n.width=t,s.resize({width:t}))}),l.append("span").html("px"),l.append("label").attr("title","Map projection, (hemi) indicates hemispherical projection").attr("for","projection").html("Projection");var u=l.append("select").attr("id","projection").on("change",function(){this&&(n.projection=this.value,P.set(n),s.reproject(n))}),c=0,h=Object.keys(r).map(function(t,e){return t===n.projection&&(c=e),{o:t,n:r[t].clip&&!0===r[t].clip?r[t].n+" (hemi)":r[t].n}});u.selectAll("option").data(h).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),u.property("selectedIndex",c),c=0,l.append("label").attr("title","Coordinate space in which the map is displayed").attr("for","transform").html("Coordinates"),u=l.append("select").attr("id","transform").on("change",function(){var t=this.value,e=ot(t,n.transform);null!==e&&(n.center[0]=e),n.transform=t,P.set(n),s.reload(n)}),h=Object.keys(a).map(function(t,e){return t===n.transform&&(c=e),{o:t,n:t.replace(/^([a-z])/,function(t,n){return n.toUpperCase()})}}),u.selectAll("option").data(h).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),u.property("selectedIndex",c),l.append("br"),l.append("label").attr("title","Center coordinates long/lat in selected coordinate space").attr("for","centerx").html("Center"),l.append("input").attr("type","number").attr("id","centerx").attr("title","Center right ascension/longitude").attr("max","24").attr("min","0").attr("step","0.1").on("change",m),l.append("span").attr("id","cxunit").html("h"),l.append("input").attr("type","number").attr("id","centery").attr("title","Center declination/latitude").attr("max","90").attr("min","-90").attr("step","0.1").on("change",m),l.append("span").html("\xb0"),l.append("label").attr("title","Orientation").attr("for","centerz").html("Orientation"),l.append("input").attr("type","number").attr("id","centerz").attr("title","Center orientation").attr("max","180").attr("min","-180").attr("step","0.1").on("change",m),l.append("span").html("\xb0"),l.append("label").attr("for","orientationfixed").attr("class","advanced").html("Fixed"),l.append("input").attr("type","checkbox").attr("id","orientationfixed").attr("class","advanced").property("checked",n.orientationfixed).on("change",S),l.append("label").attr("title","Center and zoom in on this constellation").attr("for","constellation").html("Show"),l.append("select").attr("id","constellation").on("change",function(){var t=this.value;t&&k(t)}),st(n.center,n.transform),(l=o.append("div").attr("class","col").attr("id","stars")).append("label").attr("class","header").attr("for","stars-show").html("Stars"),l.append("input").attr("type","checkbox").attr("id","stars-show").property("checked",n.stars.show).on("change",S),l.append("label").attr("for","stars-limit").html("down to magnitude"),l.append("input").attr("type","number").attr("id","stars-limit").attr("title","Star display limit (magnitude)").attr("value",n.stars.limit).attr("max","6").attr("min","-1").attr("step","0.1").on("change",S),l.append("label").attr("for","stars-colors").html("with spectral colors"),l.append("input").attr("type","checkbox").attr("id","stars-colors").property("checked",n.stars.colors).on("change",S),l.append("label").attr("for","stars-color").html("or default color "),l.append("input").attr("type","color").attr("autocomplete","off").attr("id","stars-style-fill").attr("title","Star color").property("value",n.stars.style.fill).on("change",S),l.append("br");var f=R.starnames[n.culture]||R.starnames.iau;for(var p in f)if(V(f,p)){var d=Object.keys(f[p]);d.length>1?(l.append("label").attr("for","stars-"+p).html("Show"),c=0,l.append("label").attr("title","Type of star name").attr("id","label-propername").attr("for","stars-"+p+"Type").html(function(){return"propername"===p?"proper names":""}),u=l.append("select").attr("id","stars-"+p+"Type").attr("class",function(){return"propername"===p?"advanced":""}).on("change",S),h=d.map(function(t,e){return t===n.stars[p+"Type"]&&(c=e),{o:t,n:f[p][t]}}),u.selectAll("option").data(h).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),u.property("selectedIndex",c),l.append("input").attr("type","checkbox").attr("id","stars-"+p).property("checked",n.stars[p]).on("change",S)):1===d.length&&(l.append("label").attr("for","stars-"+p).html(" "+f[p][d[0]]),l.append("input").attr("type","checkbox").attr("id","stars-"+p).property("checked",n.stars[p]).on("change",S)),l.append("label").attr("for","stars-"+p+"Limit").html("down to mag"),l.append("input").attr("type","number").attr("id","stars-"+p+"Limit").attr("title","Star name display limit (magnitude)").attr("value",n.stars[p+"Limit"]).attr("max","6").attr("min","-1").attr("step","0.1").on("change",S)}for(p in l.append("br"),l.append("label").attr("for","stars-size").attr("class","advanced").html("Stellar disk size: base"),l.append("input").attr("type","number").attr("id","stars-size").attr("class","advanced").attr("title","Size of the displayed star disk; base").attr("value",n.stars.size).attr("max","100").attr("min","0").attr("step","0.1").on("change",S),l.append("label").attr("for","stars-exponent").attr("class","advanced").html(" * e ^ (exponent"),l.append("input").attr("type","number").attr("id","stars-exponent").attr("class","advanced").attr("title","Size of the displayed star disk; exponent").attr("value",n.stars.exponent).attr("max","3").attr("min","-1").attr("step","0.01").on("change",S),l.append("span").attr("class","advanced").text(" * (magnitude + 2))  [* adaptation]"),nt(ct("stars-show")),(l=o.append("div").attr("class","col").attr("id","dsos")).append("label").attr("class","header").attr("title","Deep Space Objects").attr("for","dsos-show").html("DSOs"),l.append("input").attr("type","checkbox").attr("id","dsos-show").property("checked",n.dsos.show).on("change",S),l.append("label").attr("for","dsos-limit").html("down to mag"),l.append("input").attr("type","number").attr("id","dsos-limit").attr("title","DSO display limit (magnitude)").attr("value",n.dsos.limit).attr("max","6").attr("min","0").attr("step","0.1").on("change",S),l.append("label").attr("for","dsos-colors").html("with symbol colors"),l.append("input").attr("type","checkbox").attr("id","dsos-colors").property("checked",n.dsos.colors).on("change",S),l.append("label").attr("for","dsos-color").html("or default color "),l.append("input").attr("type","color").attr("autocomplete","off").attr("id","dsos-style-fill").attr("title","DSO color").property("value",n.dsos.style.fill).on("change",S),l.append("br"),f=R.dsonames[n.culture]||R.dsonames.iau)if(V(f,p)){var g=Object.keys(f[p]);l.append("label").attr("for","dsos-"+p).html("Show"),c=0,l.append("label").attr("title","Type of DSO name").attr("for","dsos-"+p+"Type").attr("class","advanced").html(""),u=l.append("select").attr("id","dsos-"+p+"Type").attr("class","advanced").on("change",S),h=g.map(function(t,e){return t===n.stars[p+"Type"]&&(c=e),{o:t,n:f[p][t]}}),u.selectAll("option").data(h).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),u.property("selectedIndex",c),l.append("label").attr("for","dsos-"+p).html("names"),l.append("input").attr("type","checkbox").attr("id","dsos-"+p).property("checked",n.dsos[p]).on("change",S)}for(p in l.append("label").attr("for","dsos-nameLimit").html("down to mag"),l.append("input").attr("type","number").attr("id","dsos-nameLimit").attr("title","DSO name display limit (magnitude)").attr("value",n.dsos.nameLimit).attr("max","6").attr("min","0").attr("step","0.1").on("change",S),l.append("br"),l.append("label").attr("for","dsos-size").attr("class","advanced").html("DSO symbol size: (base"),l.append("input").attr("type","number").attr("id","dsos-size").attr("class","advanced").attr("title","Size of the displayed symbol: base").attr("value",n.dsos.size).attr("max","100").attr("min","0").attr("step","0.1").on("change",S),l.append("label").attr("for","dsos-exponent").attr("class","advanced").html(" * 2 [* adaptation] - magnitude) ^ exponent"),l.append("input").attr("type","number").attr("id","dsos-exponent").attr("class","advanced").attr("title","Size of the displayed symbol; exponent").attr("value",n.dsos.exponent).attr("max","3").attr("min","-1").attr("step","0.01").on("change",S),nt(ct("dsos-show")),(l=o.append("div").attr("class","col").attr("id","constellations")).append("label").attr("class","header").html("Constellations"),f=R.constellations[n.culture]||R.constellations.iau)if(V(f,p)){var v=Object.keys(f[p]);v.length>1?(l.append("label").attr("for","constellations-"+p).html("Show"),c=0,l.append("label").attr("title","Language of constellation names").attr("for","constellations-"+p+"Type").attr("class","advanced").html(""),u=l.append("select").attr("id","constellations-"+p+"Type").attr("class","advanced").on("change",S),h=v.map(function(t,e){return t===n.constellations[p+"Type"]&&(c=e),{o:t,n:f[p][t]}}),u.selectAll("option").data(h).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),u.property("selectedIndex",c),l.append("label").attr("for","constellations-"+p).html("names"),l.append("input").attr("type","checkbox").attr("id","constellations-"+p).property("checked",n.constellations[p]).on("change",S)):1===v.length&&(l.append("label").attr("for","constellations-"+p).attr("class","advanced").html(" "+f[p][v[0]]),l.append("input").attr("type","checkbox").attr("id","constellations-"+p).attr("class","advanced").property("checked",n.constellations[p]).on("change",S))}l.append("label").attr("for","constellations-lines").html(" lines"),l.append("input").attr("type","checkbox").attr("id","constellations-lines").property("checked",n.constellations.lines).on("change",S),l.append("label").attr("for","constellations-bounds").html(" boundaries"),l.append("input").attr("type","checkbox").attr("id","constellations-bounds").property("checked",n.constellations.bounds).on("change",S),nt(ct("constellations-names")),(l=o.append("div").attr("class","col").attr("id","lines")).append("label").attr("class","header").html("Lines"),l.append("label").attr("title","Latitude/longitude grid lines").attr("for","lines-graticule").html("Graticule"),l.append("input").attr("type","checkbox").attr("id","lines-graticule-show").property("checked",n.lines.graticule.show).on("change",S),l.append("label").attr("for","lines-equatorial").html("Equator"),l.append("input").attr("type","checkbox").attr("id","lines-equatorial-show").property("checked",n.lines.equatorial.show).on("change",S),l.append("label").attr("for","lines-ecliptic").html("Ecliptic"),l.append("input").attr("type","checkbox").attr("id","lines-ecliptic-show").property("checked",n.lines.ecliptic.show).on("change",S),l.append("label").attr("for","lines-galactic").html("Galactic plane"),l.append("input").attr("type","checkbox").attr("id","lines-galactic-show").property("checked",n.lines.galactic.show).on("change",S),l.append("label").attr("for","lines-supergalactic").html("Supergalactic plane"),l.append("input").attr("type","checkbox").attr("id","lines-supergalactic-show").property("checked",n.lines.supergalactic.show).on("change",S),(l=o.append("div").attr("class","col").attr("id","other")).append("label").attr("class","header").html("Other"),l.append("label").attr("for","mw-show").html("Milky Way"),l.append("input").attr("type","checkbox").attr("id","mw-show").property("checked",n.mw.show).on("change",S),l.append("label").attr("for","mw-style-fill").attr("class","advanced").html(" color"),l.append("input").attr("type","color").attr("id","mw-style-fill").attr("class","advanced").attr("title","Milky Way color").attr("value",n.mw.style.fill).on("change",S),l.append("label").attr("for","mw-style-opacity").attr("class","advanced").html(" opacity"),l.append("input").attr("type","number").attr("id","mw-style-opacity").attr("class","advanced").attr("title","Transparency of each Milky Way layer").attr("value",n.mw.style.opacity).attr("max","1").attr("min","0").attr("step","0.01").on("change",S),l.append("label").attr("for","advanced").html("Advanced options"),l.append("input").attr("type","checkbox").attr("id","advanced").property("checked",n.advanced).on("change",S),l.append("br"),l.append("label").attr("for","background-fill").html("Background color"),l.append("input").attr("type","color").attr("id","background-fill").attr("title","Background color").attr("value",n.background.fill).on("change",S),l.append("label").attr("for","background-opacity").attr("class","advanced").html("opacity"),l.append("input").attr("type","number").attr("id","background-opacity").attr("class","advanced").attr("title","Background opacity").attr("value",n.background.opacity).attr("max","1").attr("min","0").attr("step","0.01").on("change",S),l.append("label").attr("title","Star/DSO sizes are increased with higher zoom-levels").attr("for","adaptable").attr("class","advanced").html("Adaptable object sizes"),l.append("input").attr("type","checkbox").attr("id","adaptable").attr("class","advanced").property("checked",n.adaptable).on("change",S);var M=F[n.culture];function m(){!1!==at(this)&&!1!==b()&&s.rotate(n)}function b(){var t=ct("centerx"),e=ct("centery"),r=ct("centerz");if(t&&e){if("equatorial"!==n.transform)n.center[0]=parseFloat(t.value);else{var a=parseFloat(t.value);n.center[0]=a>12?15*a-360:15*a}n.center[1]=parseFloat(e.value);var i=parseFloat(r.value);return n.center[2]=isNaN(i)?0:i,""!==t.value&&""!==e.value}}function x(t){var n=d3.time.format("%Y%m%dT%H%M%S%Z"),e="d3-celestial",r=s.date();return r&&(e+=n(r)),e+t}function k(t){var n,e=[],r=L;if("---"===t)return s.constellation=null,1!==(n=s.zoomBy())&&e.push({param:"zoom",value:1/n,duration:0}),void s.animate(e,!1);if(("function"==(i=typeof(a=s.constellations))||"object"===i&&a)&&V(s.constellations,t)){var a,i,o=s.constellations[t],l=y(o.center,w[r.transform]);r.center=l,st(r.center,r.transform),1!==(n=s.zoomBy())&&e.push({param:"zoom",value:1/n,duration:0}),e.push({param:"center",value:l,duration:0}),e.push({param:"zoom",value:1+360/o.scale,duration:0}),s.constellation=t,s.animate(e,!1)}}function S(){var t,e=this;switch(Object.assign(n,P.set()),e.type){case"checkbox":t=e.checked,nt(e);break;case"number":if(!1===at(e))return;t=parseFloat(e.value);break;case"color":if(!1===it(e))return;t=e.value;break;case"text":if(-1===e.id.search(/fill$/))return;if(!1===it(e))return;t=e.value;break;case"select-one":t=e.value}null!==t&&(_(e.id,t),"dsos-style-fill"===e.id?(_("dsos-style-stroke",t),_("dsos-nameStyle-fill",t)):"constellations-namesType"===e.id?ut():"lang"===e.id?q(t):"advanced"===e.id&&lt(t),b(),Object.assign(L,n),s.apply(n))}function _(t,e){var r=t.split("-");switch(r.length){case 1:n[r[0]]=e;break;case 2:n[r[0]][r[1]]=e;break;case 3:n[r[0]][r[1]][r[2]]=e;break;default:return}}function q(t){Object.assign(n,L),n.lang=t;for(var e=["constellations","planets"],r=0;r<e.length;r++)n[e[r]].namesType=V(R[e[r]][n.culture].names,t)?t:V(R[e[r]][n.culture].names,"desig")?"desig":"name";return n.dsos.namesType=V(R.dsonames[n.culture].names,t)?t:"desig",n.stars.propernameType=V(R.starnames[n.culture].propername,t)?t:"desig",Object.assign(L,n),T(),ut(),n}function T(){d3.selectAll(e+" ~ #celestial-form input, "+e+" ~  #celestial-form select").each(function(t,e){if(void 0!==this){var r=this.id;if("lat"===r||"lon"===r)Y(n.geopos)&&(this.value="lat"===r?n.geopos[0]:n.geopos[1]);else if(-1!==r.search(/center/)){if(Y(n.center))switch(r){case"centerx":this.value=n.center[0];break;case"centery":this.value=n.center[1];break;case"centerz":this.value=n.center[2]||0}}else{if("datetime"===r||"hr"===r||"min"===r||"sec"===r||"tz"===r)return;if("button"!==this.type){var a=z(r);switch(this.type){case"checkbox":this.checked=a,nt(r);break;case"number":if(!1===at(this))break;this.value=parseFloat(z(r));break;case"color":if(!1===it(this))break;this.value=a;break;case"text":if(-1===r.search(/fill$/))break;if(!1===it(this))break;this.value=a;break;case"select-one":this.value=a}}}}})}function z(t){var e=t.split("-");switch(e.length){case 1:return n[e[0]];case 2:return n[e[0]][e[1]];case 3:return n[e[0]][e[1]][e[2]];default:return}}c=0,l.append("label").attr("title","General language setting").attr("for","lang").html("Object names "),u=l.append("select").attr("id","lang").on("change",S),h=M.map(function(t,e){return t===n.lang&&(c=e),{o:t,n:R.constellations[n.culture].names[t]}}),h=[{o:"---",n:"(Select language)"}].concat(h),u.selectAll("option").data(h).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),u.property("selectedIndex",c),(l=o.append("div").attr("class","col").attr("id","download")).append("label").attr("class","header").html("Download"),l.append("input").attr("type","button").attr("id","download-png").attr("value","PNG Image").on("click",function(){var t=d3.select("body").append("a").node(),n=document.querySelector(e+" canvas");t.download=x(".png"),t.rel="noopener",t.href=n.toDataURL("image/png").replace("image/png","image/octet-stream"),t.click(),d3.select(t).remove()}),l.append("input").attr("type","button").attr("id","download-svg").attr("value","SVG File").on("click",function(){return yt(x(".svg")),!1}),function(){var t,n=/\d+(\.\d+)?/g,e={s:6,d:6},r=s.settings();null!==(t=r.dsos.data.match(n))&&(e.d=parseFloat(t[t.length-1])),6!==e.d&&(ct("dsos-limit").max=e.d,ct("dsos-nameLimit").max=e.d),null!==(t=r.stars.data.match(n))&&(e.s=parseFloat(t[t.length-1])),6!=e.s&&(ct("stars-limit").max=e.s,ct("stars-designationLimit").max=e.s,ct("stars-propernameLimit").max=e.s)}(),ot(n.transform),function(t,n){var r,a;if(V(t,"formFields"))if(!1!==t.form||!0!==t.location)for(a in!1===t.form&&d3.select(e+" ~ #celestial-form").style("display","none"),t.formFields)V(t.formFields,a)&&"location"!==a&&(r=!1===t.formFields[a]?"none":"block",d3.select(e+" ~ #celestial-form").select("#"+a).style({display:r}));else for(a in d3.select(e+" ~ #celestial-form").style("display","inline-block"),t.formFields)V(t.formFields,a)&&"location"!==a&&d3.select(e+" ~ #celestial-form").select("#"+a).style({display:"none"})}(t),lt(n.advanced),s.updateForm=T,s.showConstellation=k,s.setLanguage=function(t){var e=P.set();return-1!==F[n.culture].indexOf(t)&&(e=q(t)),e}}(t),null===U("error")&&d3.select("body").append("div").attr("id","error"),null===U("loc")?function(t){var n=d3.time.format("%Y-%m-%d %H:%M:%S"),r=[0,0],a=[0,0],i=new Date,o=-i.getTimezoneOffset(),l=o,u=P.set(t),c=d3.select(e+" ~ #celestial-form form").insert("div","div#general").attr("id","loc"),h=new kt(u,function(t,n){ct("datetime").value=w(t,n),l=n,q()});V(u,"geopos")&&null!==u.geopos&&2===u.geopos.length&&(a=u.geopos);var f=c.append("div").attr("class","col").attr("id","location").style("display","none");f.append("label").attr("title","Location coordinates long/lat").attr("for","lat").html("Location"),f.append("input").attr("type","number").attr("id","lat").attr("title","Latitude").attr("placeholder","Latitude").attr("max","90").attr("min","-90").attr("step","0.0001").attr("value",a[0]).on("change",function(){!0===at(this)&&q()}),f.append("span").html("\xb0"),f.append("input").attr("type","number").attr("id","lon").attr("title","Longitude").attr("placeholder","Longitude").attr("max","180").attr("min","-180").attr("step","0.0001").attr("value",a[1]).on("change",function(){!0===at(this)&&q()}),f.append("span").html("\xb0"),"geolocation"in navigator&&f.append("input").attr("type","button").attr("value","Here").attr("id","here").on("click",function(){navigator.geolocation.getCurrentPosition(function(t){a=[B(t.coords.latitude,4),B(t.coords.longitude,4)],ct("lat").value=a[0],ct("lon").value=a[1],q()})}),f.append("label").attr("title","Local date/time").attr("for","datetime").html(" Date/time"),f.append("input").attr("type","button").attr("id","day-left").attr("title","One day back").on("click",function(){i.setDate(i.getDate()-1),ct("datetime").value=w(i,l),q()}),f.append("input").attr("type","text").attr("id","datetime").attr("title","Date and time").attr("value",w(i,l)).on("click",b,!0).on("input",function(){this.value=w(i,l),h.isVisible()||b()}),f.append("div").attr("id","datepick").on("click",b),f.append("input").attr("type","button").attr("id","day-right").attr("title","One day forward").on("click",function(){i.setDate(i.getDate()+1),ct("datetime").value=w(i,l),q()}),f.append("input").attr("type","button").attr("value","Now").attr("id","now").on("click",function(){i.setTime(Date.now()),ct("datetime").value=w(i,l),q()}),f.append("br"),f.append("label").attr("title","Show horizon marker").attr("for","horizon-show").html(" Horizon marker"),f.append("input").attr("type","checkbox").attr("id","horizon-show").property("checked",u.horizon.show).on("change",_),f.append("label").attr("title","Show daylight").attr("for","daylight-show").html("Daylight sky"),f.append("input").attr("type","checkbox").attr("id","daylight-show").property("checked",u.daylight.show).on("change",_),f.append("br"),f.append("label").attr("title","Show solar system objects").attr("for","planets-show").html(" Planets, Sun & Moon"),f.append("input").attr("type","checkbox").attr("id","planets-show").property("checked",u.planets.show).on("change",_);var p=R.planets[u.culture]||R.planets.iau;for(var d in p)if(V(p,d)){var g=Object.keys(p[d]);if(g.length>1){var v="symbol"===d?"as":"with";f.append("label").attr("for","planets-"+d+"Type").html(v);var M=0;f.append("label").attr("title","Type of planet name").attr("for","planets-"+d+"Type").attr("class","advanced").html("");var m=f.append("select").attr("id","planets-"+d+"Type").on("change",_),y=g.map(function(t,n){return t===u.planets[d+"Type"]&&(M=n),{o:t,n:p[d][t]}});m.selectAll("option").data(y).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),m.property("selectedIndex",M),"names"===d&&(m.attr("class","advanced"),f.append("label").attr("for","planets-"+d).html("names"),f.append("input").attr("type","checkbox").attr("id","planets-"+d).property("checked",u.planets[d]).on("change",_))}}function b(){h.show(i,l)}function w(t,e){var r;if(e&&"0"!==e){var a=Math.floor(Math.abs(e)/60),i=Math.abs(e)-60*a;r=(e>0?" +":" \u2212")+Q(a)+Q(i)}else r=" \xb10000";return n(t)+r}function k(t){return!(!t||!Y(t)||t.length<2||!G(t[0])||t[0]<-90||t[0]>90||!G(t[1])||t[1]<-180||t[1]>180)}function S(t){return null!=t&&!(!G(t)&&Math.abs(t)>840)}function _(){Object.assign(u,P.set()),u.horizon.show=!!ct("horizon-show").checked,u.daylight.show=!!ct("daylight-show").checked,u.planets.show=!!ct("planets-show").checked,u.planets.names=!!ct("planets-names").checked,u.planets.namesType=ct("planets-namesType").value,u.planets.symbolType=ct("planets-symbolType").value,nt(ct("planets-show")),s.apply(u)}function q(){var t=parseFloat(ct("lon").value),e=parseFloat(ct("lat").value);if(Object.assign(u,P.set()),i=n.parse(ct("datetime").value.slice(0,-6)),!isNaN(t)&&!isNaN(e)){if(e!==a[0]||t!==a[1])return a=[e,t],void T([e,t]);ct("datetime").value=w(i,l);var c=new Date(i.valueOf()-6e4*(l-o));(r=s.getPoint(x.inverse(c,[90,0],a),u.transform))[2]=0,"zenith"===u.follow?s.rotate({center:r}):s.redraw()}}function T(t,n){if(t&&V(u,"settimezone")&&!1!==u.settimezone){var e=Math.floor(i.getTime()/1e3),r=window&&"https:"===window.location.protocol?"https":"http";d3.json(r+"://api.timezonedb.com/v2.1/get-time-zone?key="+u.timezoneid+"&format=json&by=position&lat="+t[0]+"&lng="+t[1]+"&time="+e,function(n,e){if(n)return console.warn(n);l="FAILED"===e.status?60*Math.round(t[1]/15):e.gmtOffset/60,ct("datetime").value=w(i,l),q()})}}nt(ct("planets-show")),lt(u.advanced),d3.select(document).on("mousedown",function(){!function(t,n){for(;t.parentNode;){if("celestial-date"===t.id)return!0;t=t.parentNode}return!1}(d3.event.target)&&h.isVisible()&&h.hide()}),s.dateFormat=w,s.date=function(t,n){if(!t)return i;S(n)&&(l=n),Object.assign(u,P.set()),h.isVisible()&&h.hide(),i.setTime(t.valueOf()),ct("datetime").value=w(t,l),q()},s.timezone=function(t){if(!t)return l;S(t)&&(l=t),Object.assign(u,P.set()),h.isVisible()&&h.hide(),ct("datetime").value=w(i,l),q()},s.position=function(){return a},s.location=function(t,n){if(!t||t.length<2)return a;k(t)&&(a=t.slice(),ct("lat").value=a[0],ct("lon").value=a[1],S(n)?l=n:T(a))},s.skyview=function(t){if(!t)return{date:i,location:a,timezone:l};var n,e=!1;if(h.isVisible()&&h.hide(),V(t,"timezone")&&S(t.timezone)&&(l=t.timezone,e=!0),V(t,"date")&&(n=t.date)&&n instanceof Date&&!isNaN(n)&&(i.setTime(t.date.valueOf()),ct("datetime").value=w(t.date,l),e=!0),!V(t,"location")||!k(t.location)||(a=t.location.slice(),ct("lat").value=a[0],ct("lon").value=a[1],V(t,"timezone")))return!1===e?{date:i,location:a,timezone:l}:void("zenith"===u.follow?q():s.redraw());T(a,V(t,"date"))},s.dtLoc=s.skyview,s.zenith=function(){return r},s.nadir=function(){var t=r[0]+180;return t>180&&(t-=360),[t,-r[1]-.001]},!V(u,"formFields")||!0!==u.location&&!0!==u.formFields.location||d3.select(e+" ~ #celestial-form").select("#location").style({display:"inline-block"}),!k(a)||!0!==u.location&&!0!==u.formFields.location||"zenith"!==u.follow||setTimeout(q,1e3)}(t):!0===t.location&&"zenith"===t.follow&&Et({center:s.zenith()}),!0!==t.location&&!0!==t.formFields.location||(d3.select(e+" #location").style("display","inline-block"),et("horizon-show",J.clip),et("daylight-show",!J.clip)),this.container=d,this.clip=Pt,this.map=a,this.mapProjection=n,this.context=St,this.metrics=function(){return{width:$,height:tt,margin:W,scale:n.scale()}},this.setStyle=Ct,this.setTextStyle=Dt,this.setStyleA=It,this.setConstStyle=function(t,n){var e=C(n);St.font=e[t]},this.symbol=O.symbol,this.dsoSymbol=Ut,this.redraw=jt,this.resize=function(n){return void 0!==n&&(V(n,"width")?t.width=n.width:G(n)&&(t.width=n)),At(!0),t.width},this.reload=function(r){var a;r&&Object.assign(t,P.set(r)),"center"===t.follow&&V(t,"center")?a=b(t.center):"zenith"===t.follow&&(a=b(s.zenith())),a&&n.rotate(a),d.selectAll(e+" *").remove(),qt()},this.apply=function(t){zt(t)},this.reproject=function(t){return Nt(t)},this.rotate=function(n){return n?Et(n):t.center},this.zoomBy=function(t){return t?Tt(t):n.scale()/ht},this.color=function(n){return n&&V(t.dsos.symbols,n)?t.dsos.symbols[n].fill:"#000"},this.starColor=Ht,this.animate=function(t,n){t&&(k=t,z=0,A=!!n,Gt())},this.stop=function(t){clearTimeout(p),!0===t&&(k=[])},this.go=function(t){k.length<1||(t&&t<k.length&&(z=t),Gt())},qt()}function qt(){for(var n in Rt(J.clip),d.append("path").datum(_t.outline).attr("class","outline"),d.append("path").datum(i).attr("class","horizon"),d.append("path").datum(o).attr("class","daylight"),_t.minorStep("equatorial"===t.transform?[15,10]:[10,10]),t.lines)V(t.lines,n)&&("graticule"===n?(d.append("path").datum(_t).attr("class","graticule"),V(t.lines.graticule,"lon")&&t.lines.graticule.lon.pos.length>0&&d.selectAll(e+" .gridvalues_lon").data(E("lon",t.lines.graticule.lon.pos)).enter().append("path").attr("class","graticule_lon"),V(t.lines.graticule,"lat")&&t.lines.graticule.lat.pos.length>0&&d.selectAll(e+" .gridvalues_lat").data(E("lat",t.lines.graticule.lat.pos)).enter().append("path").attr("class","graticule_lat")):d.append("path").datum(d3.geo.circle().angle([90]).origin(y(g[n],w[t.transform]))).attr("class",n));d3.json(bt+"mw.json",function(n,r){if(n)return window.alert("Data file could not be loaded or doesn't exist. See readme.md"),console.warn(n);var a=_(r,t.transform),i=T(a);d.selectAll(e+" .mway").data(a.features).enter().append("path").attr("class","mw"),d.selectAll(e+" .mwaybg").data(i.features).enter().append("path").attr("class","mwbg"),jt()}),d3.json(bt+Ft("constellations"),function(n,r){if(n)return console.warn(n);var a=_(r,t.transform);d.selectAll(e+" .constnames").data(a.features).enter().append("text").attr("class","constname"),s.constellations=function(t){for(var n={},e=t.features,r=0;r<e.length;r++)n[e[r].id]={center:e[r].properties.display.slice(0,2),scale:e[r].properties.display[2]};return n}(a),jt()}),d3.json(bt+Ft("constellations","borders"),function(n,r){if(n)return console.warn(n);var a=_(r,t.transform);d.selectAll(e+" .bounds").data(a.features).enter().append("path").attr("class","boundaryline"),jt()}),d3.json(bt+Ft("constellations","lines"),function(n,r){if(n)return console.warn(n);var a=_(r,t.transform);d.selectAll(e+" .lines").data(a.features).enter().append("path").attr("class","constline"),ut(),jt()}),d3.json(bt+t.stars.data,function(n,r){if(n)return console.warn(n);var a=_(r,t.transform);d.selectAll(e+" .stars").data(a.features).enter().append("path").attr("class","star"),jt()}),d3.json(bt+Ft("starnames"),function(t,n){if(t)return console.warn(t);Object.assign(c,n),jt()}),d3.json(bt+t.dsos.data,function(n,r){if(n)return console.warn(n);var a=_(r,t.transform);d.selectAll(e+" .dsos").data(a.features).enter().append("path").attr("class","dso"),jt()}),d3.json(bt+Ft("dsonames"),function(t,n){if(t)return console.warn(t);Object.assign(h,n),jt()}),d3.json(bt+Ft("planets"),function(n,r){if(n)return console.warn(n);var a=function(n){var e=[];for(var r in n)if(V(n,r)&&-1!==t.planets.which.indexOf(r)){var a=Mt().id(r);V(n[r],"parent")&&a.parentBody(n[r].parent),a.elements(n[r].elements[0]).params(n[r]),"ter"===r?s.origin=a:e.push(a)}return e}(r);d.selectAll(e+" .planets").data(a).enter().append("path").attr("class","planet"),jt()}),s.data.length>0&&s.data.forEach(function(t){V(t,"file")?d3.json(t.file,t.callback):setTimeout(t.callback,0)},this),t.lang&&""!=t.lang&&zt(s.setLanguage(t.lang))}function Tt(e){if(e&&1!==e){var a=n.scale(),i=a*e,o=r.scaleExtent(),s=1500*Math.sqrt(Math.abs(1-e));if(i<o[0]&&(i=o[0]),i>o[1]&&(i=o[1]),!0===t.disableAnimations)return n.scale(i),r.scale(i),jt(),0;var l=d3.interpolateNumber(a,i);return d3.select({}).transition().duration(s).tween("scale",function(){return function(t){var e=l(t);n.scale(e),jt()}}).transition().duration(0).tween("scale",function(){r.scale(i),jt()}),s}}function zt(n){t=P.set(n),jt()}function Et(e){var r,a,i,o=t.center,s=n.rotate(),l=n.scale(),u=2e3,c=!1,h=t.orientationfixed;B(s[1],1)===-B(e.center[1],1)&&(c=!0),t=t.set(e);var f,p,d=B(d3.geo.distance(o,t.center),2),g=d3.geo.distance([o[2],0],[t.center[2],0]);return d<.035&&g<.035||!0===t.disableAnimations?(mt=b(t.center),n.rotate(mt),jt(),0):(a=l>1.4*ht?d3.interpolateNumber(l,ht):function(){return l},i=0===g?function(){return s[2]}:(f=((f=o[2])*m+v)%v,p=((p=t.center[2])*m+v)%v,Math.abs(f-p)>Math.PI&&(f>p?f-=v:p>f&&(p-=v)),d3.interpolateNumber(f/m,p/m)),d>3.14&&(t.center[0]-=.01),t.orientationfixed=!1,r=0===d?function(){return t.center}:d3.geo.interpolate(o,t.center),u=0!==d?u*d:u*g,d3.select({}).transition().duration(u).tween("center",function(){return function(t){var e=b(r(t));e[2]=i(t);var o=a(t<.5?t:1-t);c&&(e[1]=s[1]),n.scale(o),n.rotate(e),jt()}}).transition().duration(0).tween("center",function(){t.orientationfixed=h,mt=b(t.center),n.rotate(mt),jt()}),u)}function At(e){$=Qt(),(t.width!==$||e)&&(tt=$/K,Z=G(t.background.width)?$+t.background.width:$,rt=Math.round(Z/K),ht=J.scale*$/1024,wt.style("width",H(Z)).style("height",H(rt)).attr("width",Z*X).attr("height",rt*X),r.scaleExtent([ht,ht*l]).scale(ht*u),n.translate([Z/2,rt/2]).scale(ht*u),N&&(N.style.height=H(tt)),ht*=u,jt())}function Nt(e){var i=Vt(e.projection,e.projectionRatio);if(i){var o=n.rotate(),c=n.center(),h=n.scale(),f=r.scaleExtent(),p=s.projection(t.projection).center(c).translate([Z/2,rt/2]).scale([f[0]]),d=2500,g=0,v=d3.interpolateNumber(K,i.ratio);J.clip==i.clip&&!0!==t.disableAnimations||(d=0),Rt(i.clip);var M=s.projection(e.projection).center(c).translate([Z/2,Z/i.ratio/2]).scale([i.scale*$/1024]),m=t.adaptable;return h>f[0]?(g=Tt(.1),setTimeout(Nt,g,e),g+d):((t.location||t.formFields.location)&&(et("horizon-show",i.clip),et("daylight-show",!i.clip)),n=function(t,n){var e,r=d3.geo.projection(function(r,a){var i=t([r*=180/Math.PI,a*=180/Math.PI]),o=n([r,a]);return[(1-e)*i[0]+e*o[0],(e-1)*i[1]-e*o[1]]}).scale(1),a=r.center,i=r.translate;return r.alpha=function(o){if(!arguments.length)return e;e=+o;var s=t.center(),l=n.center(),u=t.translate(),c=n.translate();return a([(1-e)*s[0]+e*l[0],(1-e)*s[1]+e*l[1]]),i([(1-e)*u[0]+e*c[0],(1-e)*u[1]+e*c[1]]),r},delete r.translate,delete r.center,r.alpha(0)}(p,M),t.adaptable=!1,d3.select({}).transition().duration(d).tween("projection",function(){return function(t){n.alpha(t).rotate(o),a.projection(n),Rt(i.clip),K=v(t),tt=$/K,wt.style("width",H(Z)).style("height",H(rt)).attr("width",Z*X).attr("height",rt*X),N&&(N.style.height=H(rt)),jt()}}).transition().duration(0).tween("projection",function(){K=(J=i).ratio,tt=$/J.ratio,rt=G(t.background.width)?tt+t.background.width:tt,ht=J.scale*$/1024,wt.style("width",H(Z)).style("height",H(rt)).attr("width",Z*X).attr("height",rt*X),N&&(N.style.height=H(rt)),t.projection=e.projection,n=s.projection(e.projection).rotate(o).translate([Z/2,rt/2]).scale(ht*u),a.projection(n),Rt(J.clip),r.projection(n).scaleExtent([ht,ht*l]).scale(ht*u),t.adaptable=m,ht*=u,jt()}),d)}}function jt(){var r,u,f,p,g=n.rotate();for(var v in St.setTransform(X,0,0,X,0,0),t.adaptable&&(vt=Math.sqrt(n.scale()/ht)),vt||(vt=1),ft=t.stars.size,dt=t.stars.exponent,pt=t.dsos.size||ft,gt=t.dsos.exponent,t.orientationfixed&&t.center.length>2&&(g[2]=t.center[2],n.rotate(g)),t.center=[-g[0],-g[1],g[2]],st(t.center,t.transform),St.clearRect(0,0,Z+W[0],rt+W[1]),Lt(),t.mw.show&&(d.selectAll(e+" .mw").each(function(n){Ct(t.mw.style),a(n),St.fill()}),"supergalactic"!==t.transform&&t.background.opacity>.95&&d.selectAll(e+" .mwbg").each(function(n){Ct(t.background),a(n),St.fill()})),t.lines)V(t.lines,v)&&!0===t.lines[v].show&&(Ct(t.lines[v]),d.selectAll(e+" ."+v).attr("d",a),St.stroke());if(V(t.lines.graticule,"lon")&&(Dt(t.lines.graticule.lon),d.selectAll(e+" .graticule_lon").each(function(t,e){if(Pt(t.geometry.coordinates)){var r=n(t.geometry.coordinates);Bt(r,t.properties.orientation),St.fillText(t.properties.value,r[0],r[1])}})),V(t.lines.graticule,"lat")&&(Dt(t.lines.graticule.lat),d.selectAll(e+" .graticule_lat").each(function(t,e){if(Pt(t.geometry.coordinates)){var r=n(t.geometry.coordinates);Bt(r,t.properties.orientation),St.fillText(t.properties.value,r[0],r[1])}})),t.constellations.bounds&&(d.selectAll(e+" .boundaryline").each(function(n){if(Ct(t.constellations.boundStyle),s.constellation){var e=new RegExp("\\b"+s.constellation+"\\b");-1!==n.ids.search(e)&&(St.lineWidth*=1.5,St.globalAlpha=1,St.setLineDash([]))}a(n),St.stroke()}),St.setLineDash([])),t.constellations.lines&&d.selectAll(e+" .constline").each(function(n){It(n.properties.rank,t.constellations.lineStyle),a(n),St.stroke()}),Lt(!0),t.constellations.names&&d.selectAll(e+" .constname").each(function(e){if(Pt(e.geometry.coordinates)){It(e.properties.rank,t.constellations.nameStyle);var r=n(e.geometry.coordinates);St.fillText(function(n){return n.properties[t.constellations.namesType]}(e),r[0],r[1])}}),t.stars.show&&(Ct(t.stars.style),d.selectAll(e+" .star").each(function(e){if(Pt(e.geometry.coordinates)&&e.properties.mag<=t.stars.limit){var r=n(e.geometry.coordinates),a=function(t){var n=t.properties.mag;if(null===n)return.1;var e=ft*vt*Math.exp(dt*(n+2));return Math.max(e,.1)}(e);St.fillStyle=Ht(e),St.beginPath(),St.arc(r[0],r[1],a,0,2*Math.PI),St.closePath(),St.fill(),t.stars.designation&&e.properties.mag<=t.stars.designationLimit*vt&&(Dt(t.stars.designationStyle),St.fillText(V(c,i=e.id)?c[i][t.stars.designationType]:"",r[0]+a,r[1])),t.stars.propername&&e.properties.mag<=t.stars.propernameLimit*vt&&(Dt(t.stars.propernameStyle),St.fillText(function(n){var e=t.stars.propernameType;return V(c,n)?V(c[n],e)?c[n][e]:c[n].name:""}(e.id),r[0]-a,r[1]))}var i})),t.dsos.show&&d.selectAll(e+" .dso").each(function(e){if(Pt(e.geometry.coordinates)&&Ot(e.properties,t.dsos.limit)){var r=n(e.geometry.coordinates),a=e.properties.type;Ct(!0===t.dsos.colors?t.dsos.symbols[a]:t.dsos.style);var i=Ut(e,r);V(t.dsos.symbols[a],"stroke")?St.stroke():St.fill(),t.dsos.names&&Ot(e.properties,t.dsos.nameLimit*vt)&&(Dt(t.dsos.nameStyle),!0===t.dsos.colors&&(St.fillStyle=t.dsos.symbols[a].fill),St.fillText(function(n){var e=t.dsos.namesType,r=n.id;return"desig"!==e&&V(h,r)&&V(h[r],e)?h[r][e]:n.properties.desig}(e),r[0]+i,r[1]-i))}}),(t.location||t.formFields.location)&&t.planets.show&&s.origin){var M=s.date(),m=s.origin(M).spherical();d.selectAll(e+" .planet").each(function(e){var r,a,i=e.id(),o=12*vt,s=e(M).equatorial(m),l=y(s.ephemeris.pos,w[t.transform]);if(Pt(l)){var u=n(l),c=t.planets.symbols[i];if("letter"===t.planets.symbolType?(Dt(t.planets.symbolStyle),St.fillStyle=c.fill,St.fillText(c.letter,u[0],u[1])):"lun"===i?(V(c,"size")&&G(c.size)&&(o=c.size*vt),St.fillStyle=c.fill,O.symbol().type("crescent").size(o*o).age(s.ephemeris.age).position(u)(St)):"disk"===t.planets.symbolType?(o=V(c,"size")&&G(c.size)?c.size*vt:function(t){var n=t.mag;if(null===n)return 2;var e=4*vt*Math.exp(-.05*(n+2));return Math.max(e,2)}(s.ephemeris),St.fillStyle=c.fill,O.symbol().type("circle").size(o*o).position(u)(St),St.fill()):"symbol"===t.planets.symbolType&&(Dt(t.planets.symbolStyle),St.font=(a=(r=t.planets.symbolStyle.font).replace(/(^\D*)(\d+)(\D.+$)/i,"$2"),a=Math.round(vt*a),r.replace(/(^\D*)(\d+)(\D.+$)/i,"$1"+a+"$3")),St.fillStyle=c.fill,St.fillText(c[t.planets.symbolType],u[0],u[1])),t.planets.names){var h=s[t.planets.namesType];Dt(t.planets.nameStyle),St.fillStyle=c.fill,St.fillText(h,u[0]-o/2,u[1]+o/2)}}})}if(s.data.length>0&&s.data.forEach(function(t){t.redraw()}),(t.location||t.formFields.location)&&t.daylight.show&&J.clip){var b=q("sol");if(b){var x=s.zenith(),k=b.ephemeris.pos,_=d3.geo.distance(x,k),T=n(k);o.origin(k),function(t,n){var e,r,a,i,o=1.36;if(t>1.885)return St.fillStyle="transparent",void(St.globalAlpha=0);t<=o?(r="#daf1fa",a="#93d7f0",i="#57c0e8",e=-(o-t)/10):(e=(t-o)/(1.885-o),r=d3.interpolateLab("#daf1fa","#e8c866")(e),a=d3.interpolateLab("#93c7d0","#ff854a")(e),i=d3.interpolateLab("#57b0c8","#6caae2")(e));var s=St.createRadialGradient(n[0],n[1],0,n[0],n[1],300);s.addColorStop(0,r),s.addColorStop(.2+.4*e,a),s.addColorStop(1,i),St.fillStyle=s,St.globalAlpha=.9*(1-(Math.pow(Math.E,1.4*e)-1)/(Math.pow(Math.E,1.4)-1))}(_,T),d.selectAll(e+" .daylight").datum(o).attr("d",a),St.fill(),St.fillStyle="#fff",Pt(k)&&(St.beginPath(),St.arc(T[0],T[1],6,0,2*Math.PI),St.closePath(),St.fill())}}(t.location||t.formFields.location)&&t.horizon.show&&!J.clip&&(i.origin(s.nadir()),Ct(t.horizon),d.selectAll(e+" .horizon").datum(i).attr("d",a),St.fill(),t.horizon.stroke&&St.stroke()),t.controls&&(r=n.scale(),u=U("celestial-zoomin"),f=U("celestial-zoomout"),p=J.scale*$/1024,u&&f&&(u.disabled=r>=p*l*.99,f.disabled=r<=p)),S&&s.runCallback()}function Lt(r){var i=n.rotate();Vt(t.projection,f.projectionRatio),n.rotate([0,0]),Ct(t.background),d.selectAll(e+" .outline").attr("d",a),!0===r?(St.globalAlpha=1,St.stroke()):St.fill(),n.rotate(i)}function Pt(n){return J.clip&&d3.geo.distance(t.center,n)>M?0:1}function Ct(t){St.fillStyle=t.fill||null,St.strokeStyle=t.stroke||null,St.lineWidth=t.width||null,St.globalAlpha=null!==t.opacity?t.opacity:1,St.font=t.font||null,V(t,"dash")?St.setLineDash(t.dash):St.setLineDash([]),St.beginPath()}function Dt(t){St.fillStyle=t.fill,St.textAlign=t.align||"left",St.textBaseline=t.baseline||"bottom",St.globalAlpha=null!==t.opacity?t.opacity:1,St.font=t.font}function It(t,n){t=t||1,St.fillStyle=Y(n.fill)?n.fill[t-1]:null,St.strokeStyle=Y(n.stroke)?n.stroke[t-1]:null,St.lineWidth=Y(n.width)?n.width[t-1]:null,St.globalAlpha=Y(n.opacity)?n.opacity[t-1]:1,St.font=Y(n.font)?n.font[t-1]:null,V(n,"dash")?St.setLineDash(n.dash):St.setLineDash([]),St.textAlign=n.align||"left",St.textBaseline=n.baseline||"bottom",St.beginPath()}function Rt(t){n.clipAngle(t?90:null)}function Ft(t,n,e){return t+(n=n?"."+n:"")+(V(R[t],xt)?"."+xt:"")+(e?"."+e:".json")}function Ot(t,n){return 999===t.mag&&Math.sqrt(parseInt(t.dim))>n||999!==t.mag&&t.mag<=n}function Ut(n,e){var r=n.properties,a=function(t){return t.mag&&999!==t.mag?Math.pow(2*pt*vt-t.mag,gt):Math.pow(parseInt(t.dim)*pt*vt/7,.5)}(r)||9,i=function(n){return n&&V(t.dsos.symbols,n)?t.dsos.symbols[n].shape:"circle"}(r.type);return O.symbol().type(i).size(a).position(e)(St),Math.sqrt(a)/2}function Ht(n){var e=n.properties.bv;return!t.stars.colors||isNaN(e)?t.stars.style.fill:D(e)}function Bt(t,n){for(var e=n.split(""),r="center",a="middle",i=e.length-1;i>=0;i--)switch(e[i]){case"N":a="bottom";break;case"S":a="top";break;case"E":r="left",t[0]+=2;break;case"W":r="right",t[0]-=2}return St.textAlign=r,St.textBaseline=a,t}function Qt(){return G(t.width)&&t.width>0?t.width:N?N.getBoundingClientRect().width-2*W[0]:window.getBoundingClientRect().width-2*W[0]}function Vt(t,n){if(V(I,t)){var e=I[t];return V(e,"ratio")||(e.ratio=2),e.ratio=n||e.ratio,e}}function Gt(){if(k&&!(k.length<1)){var t,n=k[z];switch(n.param){case"projection":t=Nt({projection:n.value});break;case"center":t=Et({center:n.value});break;case"zoom":t=Tt(n.value)}n.callback&&setTimeout(n.callback,t),z++,!0===A&&z===k.length&&(z=0),t=0===n.duration||n.duration<t?t:n.duration,z<k.length&&(p=setTimeout(Gt,t))}}},"object"==typeof module&&module.exports){var f=require("./lib/d3.js"),p=require("./lib/d3.geo.projection.js");module.exports={Celestial:function(){return s},d3:function(){return f},"d3.geo.projection":function(){return p}}}s.projection=function(t){var n,e,r;if(!V(I,t))throw new Error("Projection not supported: "+t);return e=null!==(n=I[t]).arg?d3.geo[t].raw(n.arg):d3.geo[t].raw,(r=function(t,n){return e(-t,n)}).invert=function(t,n){try{var r=e.invert(t,n);return r[0]=r&&-r[0],r}catch(a){console.log(a)}},d3.geo.projection(r)};var d={equatorial:[0,0,0],ecliptic:[0,0,23.4393],galactic:[93.5949,28.9362,-58.5988],supergalactic:[137.31,59.5283,57.7303]},g={equatorial:[0,90],ecliptic:[-90,66.5607],galactic:[-167.1405,27.1283],supergalactic:[-76.2458,15.7089]};s.eulerAngles=function(){return d},s.poles=function(){return g};var v=2*Math.PI,M=Math.PI/2,m=Math.PI/180;function y(t,n){return function(t,n){var e,r,a,i,o,s,l,u,c;return n?((s=t[0])<0&&(s+=v),l=t[1],s-=n[0],i=n[1],o=n[2],e=Math.sin(l)*Math.sin(i)-Math.cos(l)*Math.cos(i)*Math.cos(s),Math.abs(e)<1e-5&&(e=-Math.cos(l+i)+Math.cos(l)*Math.cos(i)*(1-Math.cos(s))),r=-Math.cos(l)*Math.sin(s),(u=o+(0!==e||0!==r?Math.atan2(r,e):s-Math.PI))>Math.PI&&(u-=v),s%Math.PI==0?((c=l+Math.cos(s)*i)>M&&(c=Math.PI-c),c<-M&&(c=-Math.PI-c)):(a=Math.sin(l)*Math.cos(i)+Math.cos(l)*Math.sin(i)*Math.cos(s),Math.abs(a)>.99?(c=Math.abs(Math.acos(Math.sqrt(e*e+r*r))),a<0&&(c*=-1)):c=Math.asin(a)),[u,c]):t}(t.map(function(t){return t*m}),n).map(function(t){return t/m})}function b(t){if(null===t||t.length<=0)return[0,0,0];var n=d.equatorial;return t[2]||(t[2]=0),[n[0]-t[0],n[1]-t[1],n[2]+t[2]]}var w={ecliptic:[-90,23.4393,90],"inverse ecliptic":[90,23.4393,-90],galactic:[-167.1405,62.8717,122.9319],"inverse galactic":[122.9319,62.8717,-167.1405],supergalactic:[283.7542,74.2911,26.4504],"inverse supergalactic":[26.4504,74.2911,283.7542],init:function(){for(var t in this)this[t].constructor==Array&&(this[t]=this[t].map(function(t){return t*m}))},add:function(t,n){if(n&&t&&3===n.length&&!this.hasOwnProperty(t))return this[t]=n.map(function(t){return t*m}),this[t]}};w.init(),s.euler=function(){return w};var x=function(t,n,e){var r=k(t,e[1])-n[0];r<0&&(r+=360),r*=m;var a=n[1]*m,i=e[0]*m,o=Math.asin(Math.sin(a)*Math.sin(i)+Math.cos(a)*Math.cos(i)*Math.cos(r)),s=Math.acos((Math.sin(a)-Math.sin(o)*Math.sin(i))/(Math.cos(o)*Math.cos(i)));return Math.sin(r)>0&&(s=2*Math.PI-s),[o/m,s/m,0]};function k(t,n){var e=t.getUTCFullYear(),r=t.getUTCMonth()+1,a=t.getUTCDate(),i=t.getUTCHours(),o=t.getUTCMinutes(),s=t.getUTCSeconds();1!=r&&2!=r||(e-=1,r+=12);var l=Math.floor(e/100),u=2-l+Math.floor(l/4)+Math.floor(365.25*e)+Math.floor(30.6001*(r+1))-730550.5+a+(i+o/60+s/3600)/24,c=u/36525,h=280.46061837+360.98564736629*u+387933e-9*c*c-c*c*c/3871e4+n;if(h>0)for(;h>360;)h-=360;else for(;h<0;)h+=360;return h}x.inverse=function(t,n,e){var r=n[0]*m,a=n[1]*m,i=e[0]*m,o=Math.asin(Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos(a)),s=((Math.sin(r)-Math.sin(o)*Math.sin(i))/(Math.cos(o)*Math.cos(i))).toFixed(6);return s=Math.acos(s),s/=m,[k(t,e[1])-s,o/m,0]},s.horizontal=x,s.ha=function(t,n,e){var r=k(t,n)-e;return r<180&&(r+=360),r};var S=!1;function _(t,n){if("equatorial"===n)return t;for(var e=w[n],r=t.features,a=0;a<r.length;a++)r[a].geometry.coordinates=z(r[a],e);return t}function q(t,n){if(n=n||s.date(),s.origin){var e,r=s.origin(n).spherical();return s.container.selectAll(".planet").each(function(a){t===a.id()&&(e=a(n).equatorial(r))}),e}}function T(t){var n={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"MultiPolygon",coordinates:[]}}]},e=t.features[0].geometry.coordinates[0];n.features[0].geometry.coordinates[0]=[];for(var r=0;r<e.length;r++)n.features[0].geometry.coordinates[0][r]=e[r].slice().reverse();return n}function z(t,n){var e=[];switch(t.geometry.type){case"Point":e=y(t.geometry.coordinates,n);break;case"LineString":e.push(N(t.geometry.coordinates,n));break;case"MultiLineString":e=j(t.geometry.coordinates,n);break;case"Polygon":e.push(N(t.geometry.coordinates[0],n));break;case"MultiPolygon":e.push(j(t.geometry.coordinates[0],n))}return e}function E(n,e){var r=[];if(!e)return[];Y(e)||(e=[e]);for(var a=0;a<e.length;a++)switch(e[a]){case"center":r=r.concat("lat"===n?A(n,t.center[0],"N"):A(n,t.center[1],"S"));break;case"outline":r="lon"===n?(r=r.concat(A(n,t.center[1]-89.99,"S"))).concat(A(n,t.center[1]+89.99,"N")):(r=r.concat(A(n,t.center[0]-179.99,"E"))).concat(A(n,t.center[0]+179.99,"W"));break;default:if(G(e[a])){r=r.concat(A(n,e[a],"lat"===n?"N":"S"));break}}return function(t){for(var n=[],e=0;e<t.length;e++){var r={type:"Feature",id:e,properties:{},geometry:{type:"Point"}};r.properties.value=t[e].value,r.properties.orientation=t[e].orientation,r.geometry.coordinates=t[e].coordinates,n.push(r)}return n}(r)}function A(n,e,r){var a,i,o,s,l,u=n,c=[],h=e;"equatorial"===t.transform&&"lon"===u&&(u="ra"),"ra"===u?(a=0,i=23,o=1):"lon"===u?(a=0,i=350,o=10):(a=-80,i=80,o=10);for(var f=a;f<=i;f+=o){var p=r;"lat"===u?(l=[h,f],s=f.toString()+"\xb0",p+=f<0?"S":"N"):"ra"===u?(l=[15*f,h],s=f.toString()+"\u02b0"):(l=[f,h],s=f.toString()+"\xb0"),c.push({coordinates:l,value:s,orientation:p})}return c}function N(t,n){for(var e=[],r=0;r<t.length;r++)e.push(y(t[r],n));return e}function j(t,n){for(var e=[],r=0;r<t.length;r++)e.push(N(t[r],n));return e}s.add=function(t){var n={};return V(t,"type")?"dso"!==t.type&&"json"!==t.type||V(t,"file")&&V(t,"callback")?"line"!==t.type&&"raw"!==t.type||V(t,"callback")?(V(t,"file")&&(n.file=t.file),n.type=t.type,V(t,"callback")&&(n.callback=t.callback),V(t,"redraw")&&(n.redraw=t.redraw),V(t,"save")&&(n.save=t.save),void s.data.push(n)):console.log("Can't add data"):console.log("Can't add data file"):console.log("Missing type")},s.remove=function(t){if(null!==t&&t<s.data.length)return s.data.splice(t,1)},s.clear=function(){s.data=[]},s.addCallback=function(t){s.callback=t,S=null!==t},s.runCallback=function(t){S=!1,s.callback(),S=!0},s.getData=_,s.getPoint=function(t,n){return y(t,w[n])},s.getPlanet=q;var L={},P={width:0,projection:"aitoff",projectionRatio:null,transform:"equatorial",center:null,geopos:null,follow:"zenith",orientationfixed:!0,zoomlevel:null,zoomextend:10,adaptable:!0,interactive:!0,disableAnimations:!1,form:!1,location:!1,formFields:{location:!0,general:!0,stars:!0,dsos:!0,constellations:!0,lines:!0,other:!0,download:!1},advanced:!0,daterange:[],settimezone:!0,timezoneid:"AEFXZPQ3FDPF",controls:!0,lang:"",culture:"",container:"celestial-map",datapath:"data/",stars:{show:!0,limit:6,colors:!0,style:{fill:"#ffffff",opacity:1},designation:!0,designationType:"desig",designationStyle:{fill:"#ddddbb",font:"11px 'Palatino Linotype', Georgia, Times, 'Times Roman', serif",align:"left",baseline:"top"},designationLimit:2.5,propername:!1,propernameType:"name",propernameStyle:{fill:"#ddddbb",font:"13px 'Palatino Linotype', Georgia, Times, 'Times Roman', serif",align:"right",baseline:"bottom"},propernameLimit:1.5,size:7,exponent:-.28,data:"stars.6.json"},dsos:{show:!0,limit:6,colors:!0,style:{fill:"#cccccc",stroke:"#cccccc",width:2,opacity:1},names:!0,namesType:"desig",nameStyle:{fill:"#cccccc",font:"11px 'Lucida Sans Unicode', 'DejaVu Sans', Helvetica, Arial, serif",align:"left",baseline:"bottom"},nameLimit:4,size:null,exponent:1.4,data:"dsos.bright.json",symbols:{gg:{shape:"circle",fill:"#ff0000"},g:{shape:"ellipse",fill:"#ff0000"},s:{shape:"ellipse",fill:"#ff0000"},s0:{shape:"ellipse",fill:"#ff0000"},sd:{shape:"ellipse",fill:"#ff0000"},e:{shape:"ellipse",fill:"#ff0000"},i:{shape:"ellipse",fill:"#ff0000"},oc:{shape:"circle",fill:"#ff9900",stroke:"#ff9900",width:2},gc:{shape:"circle",fill:"#ff9900"},en:{shape:"square",fill:"#ff00cc"},bn:{shape:"square",fill:"#ff00cc"},sfr:{shape:"square",fill:"#cc00ff"},rn:{shape:"square",fill:"#0000ff"},pn:{shape:"diamond",fill:"#00cccc"},snr:{shape:"diamond",fill:"#ff00cc"},dn:{shape:"square",fill:"#999999",stroke:"#999999",width:2},pos:{shape:"marker",fill:"#cccccc",stroke:"#cccccc",width:1.5}}},constellations:{show:!0,names:!0,namesType:"desig",nameStyle:{fill:"#cccc99",align:"center",baseline:"middle",opacity:.8,font:["14px 'Lucida Sans Unicode', 'DejaVu Sans', Helvetica, Arial, sans-serif","12px 'Lucida Sans Unicode', 'DejaVu Sans', Helvetica, Arial, sans-serif","11px 'Lucida Sans Unicode', 'DejaVu Sans', Helvetica, Arial, sans-serif"]},lines:!0,lineStyle:{stroke:"#cccccc",width:1.5,opacity:.6},bounds:!1,boundStyle:{stroke:"#ccff00",width:1,opacity:.8,dash:[4,4]}},mw:{show:!0,style:{fill:"#ffffff",opacity:"0.15"}},lines:{graticule:{show:!0,stroke:"#cccccc",width:.6,opacity:.8,lon:{pos:[],fill:"#eee",font:"10px 'Lucida Sans Unicode', Helvetica, Arial, sans-serif"},lat:{pos:[],fill:"#eee",font:"10px 'Lucida Sans Unicode', Helvetica, Arial, sans-serif"}},equatorial:{show:!0,stroke:"#aaaaaa",width:1.3,opacity:.7},ecliptic:{show:!0,stroke:"#66cc66",width:1.3,opacity:.7},galactic:{show:!1,stroke:"#cc6666",width:1.3,opacity:.7},supergalactic:{show:!1,stroke:"#cc66cc",width:1.3,opacity:.7}},background:{fill:"#000000",opacity:1,stroke:"#000000",width:1.5},horizon:{show:!1,stroke:"#cccccc",width:1,fill:"#000000",opacity:.4},daylight:{show:!1},planets:{show:!1,which:["sol","mer","ven","ter","lun","mar","jup","sat","ura","nep","cer","plu"],symbols:{sol:{symbol:"\u2609",letter:"Su",fill:"#ffff00",size:12},mer:{symbol:"\u263f",letter:"Me",fill:"#cccccc"},ven:{symbol:"\u2640",letter:"V",fill:"#eeeecc"},ter:{symbol:"\u2295",letter:"T",fill:"#00ccff"},lun:{symbol:"\u25cf",letter:"L",fill:"#ffffff",size:12},mar:{symbol:"\u2642",letter:"Ma",fill:"#ff6600"},cer:{symbol:"\u26b3",letter:"C",fill:"#cccccc"},ves:{symbol:"\u26b6",letter:"Ma",fill:"#cccccc"},jup:{symbol:"\u2643",letter:"J",fill:"#ffaa33"},sat:{symbol:"\u2644",letter:"Sa",fill:"#ffdd66"},ura:{symbol:"\u2645",letter:"U",fill:"#66ccff"},nep:{symbol:"\u2646",letter:"N",fill:"#6666ff"},plu:{symbol:"\u2647",letter:"P",fill:"#aaaaaa"},eri:{symbol:"\u26aa",letter:"E",fill:"#eeeeee"}},symbolStyle:{fill:"#cccccc",opacity:1,font:"bold 20px 'DejaVu Sans Mono', 'Arial Unicode MS', sans-serif",align:"center",baseline:"middle"},symbolType:"symbol",names:!1,nameStyle:{fill:"#cccccc",font:"14px 'Lucida Sans Unicode', 'DejaVu Sans', sans-serif",align:"right",baseline:"top"},namesType:"en"},set:function(t){var n,e,r={},a={};if(0===Object.entries(L).length?Object.assign(r,this):Object.assign(r,L),!t)return r;for(n in r)if(V(r,n))if(V(t,n)&&null!==t[n])if(null===r[n]||r[n].constructor!=Object)a[n]=t[n];else for(e in a[n]={},r[n])a[n][e]=V(t[n],e)?t[n][e]:r[n][e];else a[n]=r[n];return a.constellations.nameStyle.font=C(a.constellations.nameStyle.font),a.constellations.nameStyle.opacity=C(a.constellations.nameStyle.opacity),a.constellations.nameStyle.fill=C(a.constellations.nameStyle.fill),a.constellations.lineStyle.width=C(a.constellations.lineStyle.width),a.constellations.lineStyle.opacity=C(a.constellations.lineStyle.opacity),a.constellations.lineStyle.stroke=C(a.constellations.lineStyle.stroke),Object.assign(L,a),a},applyDefaults:function(t){var n={};return Object.assign(n,L),n.stars.size=n.stars.size||7,n.stars.exponent=n.stars.exponent||-.28,(!n.center||n.center.length<=0)&&(n.center=[0,0,0]),n.datapath=n.datapath||"",n.datapath=n.datapath.replace(/([^\/]$)/,"$1/"),n.transform&&""!==n.transform||(n.transform="equatorial"),n.culture&&-1!==n.culture.search(/^cn$/)||(n.culture="iau"),t&&(V(t,"stars")&&(V(t.stars,"names")&&(n.stars.designation=t.stars.names),V(t.stars,"namelimit")&&(n.stars.designationLimit=t.stars.namelimit),V(t.stars,"namestyle")&&Object.assign(n.stars.designationStyle,t.stars.namestyle),V(t.stars,"proper")&&(n.stars.propername=t.stars.proper),V(t.stars,"propernamelimit")&&(n.stars.propernameLimit=t.stars.propernamelimit),V(t.stars,"propernamestyle")&&Object.assign(n.stars.propernameStyle,t.stars.propernamestyle)),V(t,"dsos")&&(V(t.dsos,"desig")&&!0===t.dsos.desig&&(n.dsos.namesType="desig"),V(t.dsos,"namelimit")&&(n.dsos.nameLimit=t.dsos.namelimit),V(t.dsos,"namestyle")&&Object.assign(n.dsos.nameStyle,t.dsos.namestyle)),V(t,"constellations")&&(V(t.constellations,"show")&&!0===t.constellations.show&&(n.constellations.names=!0),V(t.constellations,"desig")&&!0===t.constellations.desig&&(n.constellations.namesType="desig"),"latin"===n.constellations.namesType&&(n.constellations.namesType="la"),"iau"===n.constellations.namesType&&(n.constellations.namesType="name"),V(t.constellations,"namestyle")&&Object.assign(n.constellations.nameStyle,t.constellations.namestyle),V(t.constellations,"linestyle")&&Object.assign(n.constellations.lineStyle,t.constellations.linestyle),V(t.constellations,"boundstyle")&&Object.assign(n.constellations.boundStyle,t.constellations.boundstyle)),V(t,"planets")&&V(t.planets,"style")&&Object.assign(n.planets.style,t.planets.symbolStyle)),n.stars.designationType&&""!==n.stars.designationType||(n.stars.designationType="desig"),V(R.starnames[n.culture].designation,n.stars.designationType)||(n.designationType="desig"),n.stars.propernameType&&""!==n.stars.propernameType||(n.stars.propernameType="name"),V(R.starnames[n.culture].propername,n.stars.propernameType)||(n.propernameType="name"),n.dsos.namesType&&""!==n.dsos.namesType||(n.dsos.namesType="desig"),n.constellations.namesType&&""!==n.constellations.namesType||(n.constellations.namesType="desig"),V(R.constellations[n.culture].names,n.constellations.namesType)||(n.constellations.namesType="name"),n.planets.symbolType&&""!==n.planets.symbolType||(n.planets.symbolType="symbol"),n.planets.namesType&&""!==n.planets.namesType||(n.planets.namesType="desig"),V(R.planets[n.culture].names,n.planets.namesType)||(n.planets.namesType="desig"),n.constellations.nameStyle.font=C(n.constellations.nameStyle.font),n.constellations.nameStyle.opacity=C(n.constellations.nameStyle.opacity),n.constellations.nameStyle.fill=C(n.constellations.nameStyle.fill),n.constellations.lineStyle.width=C(n.constellations.lineStyle.width),n.constellations.lineStyle.opacity=C(n.constellations.lineStyle.opacity),n.constellations.lineStyle.stroke=C(n.constellations.lineStyle.stroke),Object.assign(L,n),n}};function C(t){return Y(t)?t.length>=3?t:1===t.length?[t[0],t[0],t[0]]:2===t.length?[t[0],t[1],t[1]]:void 0:[t,t,t]}s.settings=function(){return P};var D=d3.scale.quantize().domain([3.347,-.335]).range(["#ff4700","#ff4b00","#ff4f00","#ff5300","#ff5600","#ff5900","#ff5b00","#ff5d00","#ff6000","#ff6300","#ff6500","#ff6700","#ff6900","#ff6b00","#ff6d00","#ff7000","#ff7300","#ff7500","#ff7800","#ff7a00","#ff7c00","#ff7e00","#ff8100","#ff8300","#ff8506","#ff870a","#ff8912","#ff8b1a","#ff8e21","#ff9127","#ff932c","#ff9631","#ff9836","#ff9a3c","#ff9d3f","#ffa148","#ffa34b","#ffa54f","#ffa753","#ffa957","#ffab5a","#ffad5e","#ffb165","#ffb269","#ffb46b","#ffb872","#ffb975","#ffbb78","#ffbe7e","#ffc184","#ffc489","#ffc78f","#ffc892","#ffc994","#ffcc99","#ffce9f","#ffd1a3","#ffd3a8","#ffd5ad","#ffd7b1","#ffd9b6","#ffdbba","#ffddbe","#ffdfc2","#ffe1c6","#ffe3ca","#ffe4ce","#ffe8d5","#ffe9d9","#ffebdc","#ffece0","#ffefe6","#fff0e9","#fff2ec","#fff4f2","#fff5f5","#fff6f8","#fff9fd","#fef9ff","#f9f6ff","#f6f4ff","#f3f2ff","#eff0ff","#ebeeff","#e9edff","#e6ebff","#e3e9ff","#e0e7ff","#dee6ff","#dce5ff","#d9e3ff","#d7e2ff","#d3e0ff","#c9d9ff","#bfd3ff","#b7ceff","#afc9ff","#a9c5ff","#a4c2ff","#9fbfff","#9bbcff"]),I={airy:{n:"Airy\u2019s Minimum Error",arg:Math.PI/2,scale:360,ratio:1,clip:!0},aitoff:{n:"Aitoff",arg:null,scale:162},armadillo:{n:"Armadillo",arg:0,scale:250},august:{n:"August",arg:null,scale:94,ratio:1.4},azimuthalEqualArea:{n:"Azimuthal Equal Area",arg:null,scale:340,ratio:1,clip:!0},azimuthalEquidistant:{n:"Azimuthal Equidistant",arg:null,scale:320,ratio:1,clip:!0},baker:{n:"Baker Dinomic",arg:null,scale:160,ratio:1.4},berghaus:{n:"Berghaus Star",arg:0,scale:320,ratio:1,clip:!0},boggs:{n:"Boggs Eumorphic",arg:null,scale:170},bonne:{n:"Bonne",arg:Math.PI/2.5,scale:225,ratio:.88},bromley:{n:"Bromley",arg:null,scale:162},cassini:{n:"Cassini",arg:null,scale:325,ratio:1,clip:!0},collignon:{n:"Collignon",arg:null,scale:100,ratio:2.6},craig:{n:"Craig Retroazimuthal",arg:0,scale:310,ratio:1.5,clip:!0},craster:{n:"Craster Parabolic",arg:null,scale:160},cylindricalEqualArea:{n:"Cylindrical Equal Area",arg:Math.PI/6,scale:190,ratio:2.3},cylindricalStereographic:{n:"Cylindrical Stereographic",arg:Math.PI/4,scale:230,ratio:1.3},eckert1:{n:"Eckert I",arg:null,scale:175},eckert2:{n:"Eckert II",arg:null,scale:175},eckert3:{n:"Eckert III",arg:null,scale:190},eckert4:{n:"Eckert IV",arg:null,scale:190},eckert5:{n:"Eckert V",arg:null,scale:182},eckert6:{n:"Eckert VI",arg:null,scale:182},eisenlohr:{n:"Eisenlohr",arg:null,scale:102},equirectangular:{n:"Equirectangular",arg:null,scale:165},fahey:{n:"Fahey",arg:null,scale:196,ratio:1.4},mtFlatPolarParabolic:{n:"Flat Polar Parabolic",arg:null,scale:175},mtFlatPolarQuartic:{n:"Flat Polar Quartic",arg:null,scale:230,ratio:1.65},mtFlatPolarSinusoidal:{n:"Flat Polar Sinusoidal",arg:null,scale:175,ratio:1.9},foucaut:{n:"Foucaut",arg:null,scale:142},ginzburg4:{n:"Ginzburg IV",arg:null,scale:180,ratio:1.7},ginzburg5:{n:"Ginzburg V",arg:null,scale:196,ratio:1.55},ginzburg6:{n:"Ginzburg VI",arg:null,scale:190,ratio:1.4},ginzburg8:{n:"Ginzburg VIII",arg:null,scale:205,ratio:1.3},ginzburg9:{n:"Ginzburg IX",arg:null,scale:190,ratio:1.4},homolosine:{n:"Goode Homolosine",arg:null,scale:160,ratio:2.2},hammer:{n:"Hammer",arg:2,scale:180},hatano:{n:"Hatano",arg:null,scale:186},healpix:{n:"HEALPix",arg:1,scale:320,ratio:1.2},hill:{n:"Hill Eucyclic",arg:2,scale:190,ratio:1.1},kavrayskiy7:{n:"Kavrayskiy VII",arg:null,scale:185,ratio:1.75},lagrange:{n:"Lagrange",arg:Math.PI/4,scale:88,ratio:1.6,clip:!1},larrivee:{n:"l'Arriv\xe9e",arg:null,scale:160,ratio:1.25},laskowski:{n:"Laskowski Tri-Optimal",arg:null,scale:165,ratio:1.7},loximuthal:{n:"Loximuthal",arg:Math.PI/4,scale:175,ratio:1.8},mercator:{n:"Mercator",arg:null,scale:160,ratio:1.3},miller:{n:"Miller",arg:null,scale:160,ratio:1.5},mollweide:{n:"Mollweide",arg:null,scale:180},naturalEarth:{n:"Natural Earth",arg:null,scale:185,ratio:1.85},nellHammer:{n:"Nell Hammer",arg:null,scale:160,ratio:2.6},orthographic:{n:"Orthographic",arg:null,scale:480,ratio:1,clip:!0},patterson:{n:"Patterson Cylindrical",arg:null,scale:160,ratio:1.75},polyconic:{n:"Polyconic",arg:null,scale:160,ratio:1.3},quincuncial:{n:"Quincuncial",arg:null,scale:160,ratio:1.3},rectangularPolyconic:{n:"Rectangular Polyconic",arg:0,scale:160,ratio:1.65},robinson:{n:"Robinson",arg:null,scale:160},sinusoidal:{n:"Sinusoidal",arg:null,scale:160,ratio:2},stereographic:{n:"Stereographic",arg:null,scale:500,ratio:1,clip:!0},times:{n:"Times",arg:null,scale:210,ratio:1.4},twoPointEquidistant:{n:"Two-Point Equidistant",arg:Math.PI/2,scale:320,ratio:1.15,clip:!0},vanDerGrinten:{n:"van Der Grinten",arg:null,scale:160,ratio:1},vanDerGrinten2:{n:"van Der Grinten II",arg:null,scale:160,ratio:1},vanDerGrinten3:{n:"van Der Grinten III",arg:null,scale:160,ratio:1},vanDerGrinten4:{n:"van Der Grinten IV",arg:null,scale:160,ratio:1.6},wagner4:{n:"Wagner IV",arg:null,scale:185},wagner6:{n:"Wagner VI",arg:null,scale:160},wagner7:{n:"Wagner VII",arg:null,scale:190,ratio:1.8},wiechel:{n:"Wiechel",arg:null,scale:360,ratio:1,clip:!0},winkel3:{n:"Winkel Tripel",arg:null,scale:196,ratio:1.7}};s.projections=function(){return I};var R={starnames:{iau:{designation:{desig:"Designation",bayer:"Bayer",flam:"Flamsteed",var:"Variable",gl:"Gliese",hd:"Draper",hip:"Hipparcos"},propername:{name:"IAU Name",ar:"Arabic",zh:"Chinese",en:"English",fi:"Finnish",fr:"French",de:"German",el:"Greek",he:"Hebrew",hi:"Hindi",it:"Italian",ja:"Japanese",ko:"Korean",la:"Latin",fa:"Persian",ru:"Russian",es:"Spanish",tr:"Turkish"}},cn:{propername:{name:"Proper name",en:"English",pinyin:"Pinyin"},designation:{desig:"IAU Designation"}}},constellations:{iau:{names:{desig:"Designation",name:"IAU Name",ar:"Arabic",zh:"Chinese",cz:"Czech",en:"English",ee:"Estonian",fi:"Finnish",fr:"French",de:"German",el:"Greek",he:"Hebrew",hi:"Hindi",it:"Italian",ja:"Japanese",sw:"Kiswahili",ko:"Korean",la:"Latin",fa:"Persian",ru:"Russian",es:"Spanish",tr:"Turkish"}},cn:{names:{name:"Proper name",en:"English",pinyin:"Pinyin"}}},planets:{iau:{symbol:{symbol:"\u263e Symbol",letter:"\u216c Letter",disk:"\u25cf Disk"},names:{desig:"Designation",ar:"Arabic",zh:"Chinese",en:"English",fr:"French",de:"German",el:"Greek",he:"Hebrew",hi:"Hindi",it:"Italian",ja:"Japanese",ko:"Korean",la:"Latin",fa:"Persian",ru:"Russian",es:"Spanish"}},cn:{symbol:{symbol:"\u263e Symbol",letter:"\u216c Letter",disk:"\u25cf Disk"},names:{desig:"Designation",name:"Chinese",pinyin:"Pinyin",en:"English"}}},dsonames:{iau:{names:{desig:"Designation",name:"English",ar:"Arabic",zh:"Chinese",fi:"Finnish",fr:"French",de:"German",el:"Greek",hi:"Hindi",it:"Italian",ja:"Japanese",ko:"Korean",la:"Latin",fa:"Persian",ru:"Russian",es:"Spanish",tr:"Turkish"}},cn:{names:{desig:"Designation",name:"Chinese",pinyin:"Pinyin",en:"English"}}}},F={iau:Object.keys(R.constellations.iau.names).concat(Object.keys(R.planets.iau.names)).filter(function(t,n,e){return e.indexOf(t)===n}),cn:Object.keys(R.constellations.cn.names).concat(Object.keys(R.starnames.cn.propername)).filter(function(t,n,e){return e.indexOf(t)===n})},O={};function U(t){return document.querySelector(e+" #"+t)}function H(t){return t+"px"}function B(t,n){return Math.round(Math.pow(10,n)*t)/Math.pow(10,n)}function Q(t){return t<10?"0"+t:t}function V(t,n){return null!==t&&hasOwnProperty.call(t,n)}function G(t){return null!==t&&!isNaN(parseFloat(t))&&isFinite(t)}function Y(t){return null!==t&&"[object Array]"===Object.prototype.toString.call(t)}function W(t,n,e){var r=n.valueOf()-t.valueOf();switch(e||"d"){case"y":case"yr":r/=31556926080;break;case"m":case"mo":r/=26298e5;break;case"d":case"dy":r/=864e5;break;case"h":case"hr":r/=36e5;break;case"n":case"mn":r/=6e4;break;case"s":case"sec":r/=1e3}return Math.floor(r)}function $(t){if(t){var n=t.split(".");if(!(n.length<1)&&((n=n[0].split("-"))[0]=n[0].replace(/\D/g,""),n[0]))return n[1]=n[1]?n[1].replace(/\D/g,""):"1",n[2]=n[2]?n[2].replace(/\D/g,""):"1",new Date(Date.UTC(n[0],n[1]-1,n[2]))}}O.symbol=function(){var t,n=d3.functor("circle"),e=d3.functor(64),r=d3.functor(Math.PI),a=(d3.functor("#fff"),d3.functor(""));function i(t){o[n()](t)}d3.functor([2,2]);var o={circle:function(n){var r=Math.sqrt(e())/2;return n.arc(t[0],t[1],r,0,2*Math.PI),n.closePath(),r},square:function(n){var r=Math.sqrt(e())/1.7;return n.moveTo(t[0]-r,t[1]-r),n.lineTo(t[0]+r,t[1]-r),n.lineTo(t[0]+r,t[1]+r),n.lineTo(t[0]-r,t[1]+r),n.closePath(),r},diamond:function(n){var r=Math.sqrt(e())/1.5;return n.moveTo(t[0],t[1]-r),n.lineTo(t[0]+r,t[1]),n.lineTo(t[0],t[1]+r),n.lineTo(t[0]-r,t[1]),n.closePath(),r},triangle:function(n){var r=Math.sqrt(e())/Math.sqrt(3);return n.moveTo(t[0],t[1]-r),n.lineTo(t[0]+r,t[1]+r),n.lineTo(t[0]-r,t[1]+r),n.closePath(),r},ellipse:function(n){var r=Math.sqrt(e())/2;return n.save(),n.translate(t[0],t[1]),n.scale(1.6,.8),n.beginPath(),n.arc(0,0,r,0,2*Math.PI),n.closePath(),n.restore(),r},marker:function(n){var r=Math.sqrt(e())/2;return n.moveTo(t[0],t[1]-r),n.lineTo(t[0],t[1]+r),n.moveTo(t[0]-r,t[1]),n.lineTo(t[0]+r,t[1]),n.closePath(),r},"cross-circle":function(n){var r=Math.sqrt(e()),a=r/2;return n.moveTo(t[0],t[1]-r),n.lineTo(t[0],t[1]+r),n.moveTo(t[0]-r,t[1]),n.lineTo(t[0]+r,t[1]),n.stroke(),n.beginPath(),n.moveTo(t[0],t[1]),n.arc(t[0],t[1],a,0,2*Math.PI),n.closePath(),a},"stroke-circle":function(n){var r=Math.sqrt(e()),a=r/2;return n.moveTo(t[0],t[1]-r),n.lineTo(t[0],t[1]+r),n.stroke(),n.beginPath(),n.moveTo(t[0],t[1]),n.arc(t[0],t[1],a,0,2*Math.PI),n.closePath(),a},crescent:function(n){var a=Math.sqrt(e())/2,i=r(),o=.5*(1-Math.cos(i)),s=1.6*Math.abs(o-.5)+.01,l=i>Math.PI,u=Math.abs(o)>.5?l:!l,c=n.fillStyle,h=o<.157?"#669":"#557";return n.save(),n.fillStyle=h,n.beginPath(),n.moveTo(t[0],t[1]),n.arc(t[0],t[1],a,0,2*Math.PI),n.closePath(),n.fill(),n.fillStyle=c,n.beginPath(),n.moveTo(t[0],t[1]),n.arc(t[0],t[1],a,-Math.PI/2,Math.PI/2,l),n.scale(s,1),n.arc(t[0]/s,t[1],a,Math.PI/2,-Math.PI/2,u),n.closePath(),n.fill(),n.restore(),a}};return i.type=function(t){return arguments.length?(n=d3.functor(t),i):n},i.size=function(t){return arguments.length?(e=d3.functor(t),i):e},i.age=function(t){return arguments.length?(r=d3.functor(t),i):r},i.text=function(t){return arguments.length?(a=d3.functor(t),i):a},i.position=function(n){if(arguments.length)return t=n,i},i},s.Canvas=O;var Z=function(t){return(Math.pow(Math.E,t)-Math.pow(Math.E,-t))/2},X=function(t){return(Math.pow(Math.E,t)+Math.pow(Math.E,-t))/2},J=function(t){return(t+3*Math.PI)%(2*Math.PI)-Math.PI},K=function(t){return(t+2*Math.PI)%(2*Math.PI)};Math,Math,Math;var tt={"stars-show":["stars-limit","stars-colors","stars-style-fill","stars-designation","stars-propername","stars-size","stars-exponent"],"stars-designation":["stars-designationType","stars-designationLimit"],"stars-propername":["stars-propernameLimit","stars-propernameType"],"dsos-show":["dsos-limit","dsos-colors","dsos-style-fill","dsos-names","dsos-size","dsos-exponent"],"dsos-names":["dsos-namesType","dsos-nameLimit"],"mw-show":["mw-style-opacity","mw-style-fill"],"constellations-names":["constellations-namesType"],"planets-show":["planets-symbolType","planets-names"],"planets-names":["planets-namesType"]};function nt(t){var n,e=t.id;switch(e){case"stars-show":n=!ct(e).checked;for(var r=0;r<tt[e].length;r++)et(tt[e][r],n);case"stars-designation":for(n=!ct("stars-designation").checked||!ct("stars-show").checked,r=0;r<tt["stars-designation"].length;r++)et(tt["stars-designation"][r],n);case"stars-propername":for(n=!ct("stars-propername").checked||!ct("stars-show").checked,r=0;r<tt["stars-propername"].length;r++)et(tt["stars-propername"][r],n);break;case"dsos-show":for(n=!ct(e).checked,r=0;r<tt[e].length;r++)et(tt[e][r],n);case"dsos-names":for(n=!ct("dsos-names").checked||!ct("dsos-show").checked,r=0;r<tt["dsos-names"].length;r++)et(tt["dsos-names"][r],n);break;case"planets-show":for(n=!ct(e).checked,r=0;r<tt[e].length;r++)et(tt[e][r],n);case"planets-names":for(n=!ct("planets-names").checked||!ct("planets-show").checked,r=0;r<tt["planets-names"].length;r++)et(tt["planets-names"][r],n);break;case"constellations-names":case"mw-show":for(n=!ct(e).checked,r=0;r<tt[e].length;r++)et(tt[e][r],n)}}function et(t,n){var e=ct(t);e&&(e.disabled=n,e.style.color=n?"#999":"#000",e.previousSibling.style.color=n?"#999":"#000")}function rt(t,n){var e=function(t){var n=0,e=0;if(t.offsetParent)do{n+=t.offsetLeft,e+=t.offsetTop}while(null!==(t=t.offsetParent));return[n,e]}(t);d3.select("#error").html(n).style({top:H(e[1]+t.offsetHeight+1),left:H(e[0]),opacity:1}),t.focus()}function at(t){var n,e="hr"===t.id||"min"===t.id||"sec"===t.id?1:0;if(t.validity){if((n=t.validity).typeMismatch||n.badInput)return rt(t,t.title+": check field value"),!1;if(n.rangeOverflow||n.rangeUnderflow)return rt(t,t.title+" must be between "+(parseInt(t.min)+e)+" and "+(parseInt(t.max)-e)),!1}else{if(!G(n=t.value))return rt(t,t.title+": check field value"),!1;if((n=parseFloat(n))<t.min||n>t.max)return rt(t,t.title+" must be between "+(t.min+e)+" and "+(+t.max-e)),!1}return d3.select("#error").style({top:"-9999px",left:"-9999px",opacity:0}),!0}function it(t){var n;if(t.validity){if((n=t.validity).typeMismatch||n.badInput)return rt(t,t.title+": check field value"),!1;if(-1===t.value.search(/^#[0-9A-F]{6}$/i))return rt(t,t.title+": not a color value"),!1}else{if(""===(n=t.value))return!0;if(-1===n.search(/^#[0-9A-F]{6}$/i))return rt(t,t.title+": not a color value"),!1}return d3.select("#error").style({top:"-9999px",left:"-9999px",opacity:0}),!0}function ot(t,n){var e=ct("centerx");return e?(n&&("equatorial"===t&&"equatorial"!==n?(e.value=(e.value/15).toFixed(1),e.value<0&&(e.value+=24)):"equatorial"!==t&&"equatorial"===n&&(e.value=(15*e.value).toFixed(1),e.value>180&&(e.value-=360))),"equatorial"===t?(e.min="0",e.max="24",ct("cxunit").innerHTML="h"):(e.min="-180",e.max="180",ct("cxunit").innerHTML="\xb0"),e.value):null}function st(t,n){var e=ct("centerx"),r=ct("centery"),a=ct("centerz");e&&r&&((null===t||t.length<1)&&(t=[0,0,0]),(t.length<=2||void 0===t[2])&&(t[2]=0),e.value="equatorial"!==n?t[0].toFixed(1):t[0]<0?(t[0]/15+24).toFixed(1):(t[0]/15).toFixed(1),r.value=t[1].toFixed(1),a.value=null!==t[2]?t[2].toFixed(1):0,P.set({center:t}))}function lt(t){var n=t?"inline-block":"none";d3.select(e+" ~ #celestial-form").selectAll(".advanced").style("display",n),d3.select(e+" ~ #celestial-form").selectAll("#label-propername").style("display",t?"none":"inline-block")}function ut(){var t,n,r=d3.select(e+" ~ #celestial-form").select("#constellation"),a=[],i=0,o=L;s.container.selectAll(".constname").each(function(e,r){(t=e.id)===o.constellation&&(i=r),(n=e.properties[o.constellations.namesType])!==t&&(n+=" ("+t+")"),a.push({o:t,n:n})}),a.length<1||r.length<1?setTimeout(ut,1e3):(a=[{o:"---",n:"(Select constellation)"}].concat(a),r.selectAll("option").remove(),r.selectAll("option").data(a).enter().append("option").attr("value",function(t){return t.o}).text(function(t){return t.n}),r.property("selectedIndex",i))}function ct(t){return document.querySelector(e+" ~ #celestial-form #"+t)}var ht={sol:.0002959122082855911,mer:0x95955473dbc3,ven:0x89d9374048629,ter:0xa923c08a47948,lun:36599199229256,mar:319711652803400,cer:467549107200,ves:129071530155,jup:0xd20883d548bcd80,sat:0x3ee3798098fbac0,ura:0x99ad2c4e2f7f70,nep:0xb54f848fd74430,plu:7327611364884,eri:827117568e4},ft={sol:"\u2609",mer:"\u263f",ven:"\u2640",ter:"\u2295",lun:"\u25cf",mar:"\u2642",cer:"\u26b3",ves:"\u26b6",jup:"\u2643",sat:"\u2644",ura:"\u2645",nep:"\u2646",plu:"\u2647",eri:"\u26aa"},pt=23.43928*m,dt=Math.sin(pt),gt=Math.cos(pt),vt=["a","e","i","w","M","L","W","N","n","ep","ref","lecl","becl","Tilt"],Mt=function(){var t,n,e,r=ht.sol,a="sol",i={},o={};function s(n){return l(n),"sol"===t?(o.ephemeris.x=0,o.ephemeris.y=0,o.ephemeris.z=0,o.ephemeris.mag=-6,s):(u(),s)}var l=function(t){var n,e=o.ephemeris={};t&&(n=t instanceof Date?new Date(t.valueOf()):$(t)),n||(n=new Date),e.jd=f(n),(n=$(i.ep))||(n=$("2000-01-01")),e.jd0=f(n),e.d=e.jd-e.jd0,e.cy=e.d/36525},u=function(){var n,e=o.ephemeris;if("lun"===t){if(!(e=function(t){if(void 0!==mt)return mt.elements(t)}(e)))return}else{for(var a=0;a<vt.length;a++)V(i,n=vt[a])&&(V(i,"d"+n)?e[n]=i[n]+i["d"+n]*e.cy:V(i,n)&&(e[n]=i[n]));V(e,"M")&&!V(e,"dM")&&V(e,"n")&&(e.M+=e.n*e.d)}!function(){var t=o.ephemeris;t.hasOwnProperty("w")||(t.w=t.W-t.N),t.hasOwnProperty("M")||(t.M=t.L-t.W),t.e<1&&(t.M=J(t.M)),t.P=v*Math.sqrt(Math.pow(t.a,3)/r)/365.25,t.T=t.jd0-t.M/M/t.P,1!==t.e?(t.q=t.a*(1-t.e),t.t0=t.a*Math.sqrt(Math.abs(t.a)/r)):(t.w0=3/Math.sqrt(2)/(t.q*Math.sqrt(t.q/r)),t.a=0,t.t0=0),t.am=Math.sqrt(r*t.q*(1+t.e))}(),function(){var t,n,e,r=o.ephemeris;1===r.e?(e=r.w0*(r.jd0-r.T)*.5,n=Math.pow(e+Math.sqrt(e*e+1),1/3),r.v=2*Math.atan(n-1/n)):(r.E=function(){var t,n,e,r,a,i=o.ephemeris,s=i.e,l=i.M,u=1e-8,h=0,f=1.9,p=!1,d=0;if(!l)return 0;if(s<1&&((l<-Math.PI||l>Math.PI)&&(h=l-(r=J(l)),l=r),s<.9)){t=Math.atan2(Math.sin(l),Math.cos(l)-s);do{t-=n=(t-s*Math.sin(t)-l)/(1-s*Math.cos(t))}while(Math.abs(n)>u);return t}if(l<0&&(l=-l,p=!0),t=l,(u*=Math.abs(1-s))<1e-15&&(u=1e-15),(s>.8&&l<Math.PI/3||s>1)&&((e=l/Math.abs(1-s))*e>6*Math.abs(1-s)&&(e=l<Math.PI?Math.pow(6*l,1/3):(a=l/s,Math.log(a+Math.sqrt(a*a+1)))),t=e),s>1&&l>4&&(t=Math.log(l)),s<1)for(;Math.abs(f)>u;)t+=f=-(n=d++>8?c(t,s)-l:t-s*Math.sin(t)-l)/(1-s*Math.cos(t));else for(;Math.abs(f)>u;)t+=f=-(n=d++>7?-c(t,s)-l:s*Z(t)-t-l)/(s*X(t)-1);return p?h-t:h+t}(),r.e>1?(t=r.e-X(r.E),n=Z(r.E)):(t=Math.cos(r.E)-r.e,n=Math.sin(r.E)),n*=Math.sqrt(Math.abs(1-r.e*r.e)),r.v=Math.atan2(n,t)),r.r=r.q*(1+r.e)/(1+r.e*Math.cos(r.v))}(),function(){var t=o.ephemeris,n=t.v+t.w;t.x=t.r*(Math.cos(t.N)*Math.cos(n)-Math.sin(t.N)*Math.sin(n)*Math.cos(t.i)),t.y=t.r*(Math.sin(t.N)*Math.cos(n)+Math.cos(t.N)*Math.sin(n)*Math.cos(t.i)),t.z=t.r*(Math.sin(n)*Math.sin(t.i))}()};function c(t,n){for(var e=n>1?t*t:-t*t,r=n*e*t/6,a=(1-n)*t-r,i=4;Math.abs(r)>1e-15;)a-=r*=e/(i*(i+1)),i+=2;return a}function h(){var t=o.ephemeris,n=Math.atan2(t.y,t.x),e=Math.atan2(t.z,Math.sqrt(t.x*t.x+t.y*t.y));return t.l=K(n),t.b=e,o}function f(t){var n=t.getUTCFullYear(),e=t.getUTCMonth()+1,r=t.getUTCDate(),a=(t.getUTCHours()-12+t.getUTCMinutes()/60+t.getUTCSeconds()/3600)/24;if(n<-4799)return-1;var i=Math.floor((14-e)/12),o=n+4800-i;return r+Math.floor((153*(e+12*i-3)+2)/5)+365*o+Math.floor(o/4)-Math.floor(o/100)+Math.floor(o/400)-32045+a}return s.cartesian=function(){return o},s.spherical=function(){return h(),o},s.equatorial=function(n){return function(n){var e=o.ephemeris,r=n.ephemeris;pt=(23.439292-.0130042*e.cy-1.667e-7*e.cy*e.cy+5.028e-7*e.cy*e.cy*e.cy)*m,dt=Math.sin(pt),gt=Math.cos(pt);var a="lun"===t?{x:0,y:0,z:0}:{x:r.x,y:r.y,z:r.z};e.xeq=e.x-a.x,e.yeq=(e.y-a.y)*gt-(e.z-a.z)*dt,e.zeq=(e.y-a.y)*dt+(e.z-a.z)*gt,e.ra=K(Math.atan2(e.yeq,e.xeq)),e.dec=Math.atan2(e.zeq,Math.sqrt(e.xeq*e.xeq+e.yeq*e.yeq)),"lun"===t&&(e=function(t,n){if(h(),void 0!==mt)return mt.corr(t,n)}(e,r)),e.pos=[e.ra/m,e.dec/m],e.rt=Math.sqrt(e.xeq*e.xeq+e.yeq*e.yeq+e.zeq*e.zeq),"sol"!==t&&(e.mag=function(){var t=o.ephemeris,n=t.r,e=t.rt,r=Math.acos((n*n+e*e-1)/(2*n*e)),a=.666*((1-r/Math.PI)*Math.cos(r)+1/Math.PI*Math.sin(r));return 1*o.H+5*Math.log(n*e)*Math.LOG10E-2.5*Math.log(a)*Math.LOG10E}())}(n),o},s.transpose=function(){return function(){var t=o.ephemeris;if(!t.ref||"ecl"===t.ref)return t.tx=t.x,t.ty=t.y,void(t.tz=t.z);Math;var n,e,r,a,i=(e=(n=[t.tl,t.tb,t.r])[0],r=M-n[1],{x:(a=n[2])*Math.sin(r)*Math.cos(e),y:a*Math.sin(r)*Math.sin(e),z:a*Math.cos(r)});t.tx=i.x,t.ty=i.y,t.tz=i.z}(),o},s.elements=function(t){var n;if(!arguments.length||void 0===arguments[0])return s;for(var e=0;e<vt.length;e++)V(t,n=vt[e])&&(i[n]=t[n],"a"===n||"e"===n?i[n]*=1:"ref"!==n&&"ep"!==n&&(i[n]*=m),V(t,"d"+n)&&(i[n="d"+n]=t[n],i[n]*="da"===n||"de"===n?1:m));return s},s.params=function(t){if(!arguments.length)return s;for(var n in t)V(t,n)&&"elements"!==t[n]&&(o[n]=t[n]);return s},s.parentBody=function(t){return arguments.length?(r=ht[a=t],s):a},s.id=function(n){return arguments.length?(t=n,e=ft[n],s):t},s.Name=function(t){return arguments.length?(n=t,s):n},s.symbol=function(t){return arguments.length?(e=ft[t],s):e},s},mt={elements:function(t){var n=(t.jd-2451545)/36525,e=n*n,r=n*e,a=1e-4*e,i=1e-6*r,o=n*r*1e-8,s=3400.4*Math.cos(m*(235.7004+890534.223*n-32.601*a+3.664*i-1.769*o))-635.6*Math.cos(m*(100.737+413335.3554*n-122.571*a-10.684*i+5.028*o))-235.6*Math.cos(m*(134.9634+477198.8676*n+89.97*a+14.348*i-6.797*o))+218.1*Math.cos(m*(238.1713+854535.1727*n-31.065*a+3.623*i-1.769*o))+181*Math.cos(m*(10.6638+1367733.0907*n+57.37*a+18.011*i-8.566*o))-39.9*Math.cos(m*(103.2079+377336.3051*n-121.035*a-10.724*i+5.028*o))-38.4*Math.cos(m*(233.2295+926533.2733*n-34.136*a+3.705*i-1.769*o))+33.8*Math.cos(m*(336.4374+1303869.5784*n-155.171*a-7.02*i+3.259*o))+28.8*Math.cos(m*(111.4008+1781068.4461*n-65.201*a+7.328*i-3.538*o))+12.6*Math.cos(m*(13.1347+1331734.0404*n+58.906*a+17.971*i-8.566*o))+11.4*Math.cos(m*(186.5442+966404.0351*n-68.058*a-.567*i+.232*o))-11.1*Math.cos(m*(222.5657-441199.8173*n-91.506*a-14.307*i+6.797*o))-10.2*Math.cos(m*(269.9268+954397.7353*n+179.941*a+28.695*i-13.594*o))+9.7*Math.cos(m*(145.6272+1844931.9583*n+147.34*a+32.359*i-15.363*o))+9.6*Math.cos(m*(240.6422+818536.1225*n-29.529*a+3.582*i-1.769*o))+8*Math.cos(m*(297.8502+445267.1115*n-16.3*a+1.832*i-.884*o))-6.2*Math.cos(m*(132.4925+513197.9179*n+88.434*a+14.388*i-6.797*o))+6*Math.cos(m*(173.5506+1335801.3346*n-48.901*a+5.496*i-2.653*o))+3.7*Math.cos(m*(113.8717+1745069.3958*n-63.665*a+7.287*i-3.538*o))+3.6*Math.cos(m*(338.9083+1267870.5281*n-153.636*a-7.061*i+3.259*o))+3.2*Math.cos(m*(246.3642+2258267.3137*n+24.769*a+21.675*i-10.335*o))-3*Math.cos(m*(8.1929+1403732.141*n+55.834*a+18.052*i-8.566*o))+2.3*Math.cos(m*(98.2661+449334.4057*n-124.107*a-10.643*i+5.028*o))-2.2*Math.cos(m*(357.5291+35999.0503*n-1.536*a+.041*i+0*o))-2*Math.cos(m*(38.5872+858602.4669*n-138.871*a-8.852*i+4.144*o))-1.8*Math.cos(m*(105.6788+341337.2548*n-119.499*a-10.765*i+5.028*o))-1.7*Math.cos(m*(201.474+826670.7108*n-245.142*a-21.367*i+10.057*o))+1.6*Math.cos(m*(184.1196+401329.0556*n+125.428*a+18.579*i-8.798*o))-1.4*Math.cos(m*(308.4192-489205.1674*n+158.029*a+14.915*i-7.029*o))+1.3*Math.cos(m*(325.7736-63863.5122*n-212.541*a-25.031*i+11.826*o))+383397.6+(-.55*Math.cos(m*(238.2+854535.2*n))+.1*Math.cos(m*(103.2+377336.3*n))+.1*Math.cos(m*(233.2+926533.3*n)))*n,l=.014217*Math.cos(m*(100.737+413335.3554*n-122.571*a-10.684*i+5.028*o))+.008551*Math.cos(m*(325.7736-63863.5122*n-212.541*a-25.031*i+11.826*o))-.001383*Math.cos(m*(134.9634+477198.8676*n+89.97*a+14.348*i-6.797*o))+.001353*Math.cos(m*(10.6638+1367733.0907*n+57.37*a+18.011*i-8.566*o))-.001146*Math.cos(m*(66.5106+349471.8432*n-335.112*a-35.715*i+16.854*o))-915e-6*Math.cos(m*(201.474+826670.7108*n-245.142*a-21.367*i+10.057*o))+869e-6*Math.cos(m*(103.2079+377336.3051*n-121.035*a-10.724*i+5.028*o))-628e-6*Math.cos(m*(235.7004+890534.223*n-32.601*a+3.664*i-1.769*o))-393e-6*Math.cos(m*(291.5472-127727.0245*n-425.082*a-50.062*i+23.651*o))+284e-6*Math.cos(m*(328.2445-99862.5625*n-211.005*a-25.072*i+11.826*o))-278e-6*Math.cos(m*(162.8868-31931.7561*n-106.271*a-12.516*i+5.913*o))-24e-5*Math.cos(m*(269.9268+954397.7353*n+179.941*a+28.695*i-13.594*o))+23e-5*Math.cos(m*(111.4008+1781068.4461*n-65.201*a+7.328*i-3.538*o))+229e-6*Math.cos(m*(167.2476+762807.1986*n-457.683*a-46.398*i+21.882*o))-202e-6*Math.cos(m*(83.3826-12006.2998*n+247.999*a+29.262*i-13.826*o))+19e-5*Math.cos(m*(190.8102-541062.3799*n-302.511*a-39.379*i+18.623*o))+177e-6*Math.cos(m*(357.5291+35999.0503*n-1.536*a+.041*i+0*o))+153e-6*Math.cos(m*(32.2842+285608.3309*n-547.653*a-60.746*i+28.679*o))-137e-6*Math.cos(m*(44.8902+1431596.6029*n+269.911*a+43.043*i-20.392*o))+122e-6*Math.cos(m*(145.6272+1844931.9583*n+147.34*a+32.359*i-15.363*o))+116e-6*Math.cos(m*(302.211+1240006.0662*n-367.713*a-32.051*i+15.085*o))-111e-6*Math.cos(m*(203.9449+790671.6605*n-243.606*a-21.408*i+10.057*o))-108e-6*Math.cos(m*(68.9815+313472.7929*n-333.576*a-35.756*i+16.854*o))+96e-6*Math.cos(m*(336.4374+1303869.5784*n-155.171*a-7.02*i+3.259*o))-9e-5*Math.cos(m*(98.2661+449334.4057*n-124.107*a-10.643*i+5.028*o))+9e-5*Math.cos(m*(13.1347+1331734.0404*n+58.906*a+17.971*i-8.566*o))+56e-6*Math.cos(m*(55.8468-1018261.2475*n-392.482*a-53.726*i+25.42*o))-56e-6*Math.cos(m*(238.1713+854535.1727*n-31.065*a+3.623*i-1.769*o))+52e-6*Math.cos(m*(308.4192-489205.1674*n+158.029*a+14.915*i-7.029*o))-5e-5*Math.cos(m*(133.0212+698943.6863*n-670.224*a-71.429*i+33.708*o))-49e-6*Math.cos(m*(267.9846+1176142.554*n-580.254*a-57.082*i+26.911*o))-49e-6*Math.cos(m*(184.1196+401329.0556*n+125.428*a+18.579*i-8.798*o))-45e-6*Math.cos(m*(49.1562-75869.812*n+35.458*a+4.231*i-2.001*o))+44e-6*Math.cos(m*(257.3208-191590.5367*n-637.623*a-75.093*i+35.477*o))+42e-6*Math.cos(m*(105.6788+341337.2548*n-119.499*a-10.765*i+5.028*o))+42e-6*Math.cos(m*(160.4159+4067.2942*n-107.806*a-12.475*i+5.913*o))+4e-5*Math.cos(m*(246.3642+2258267.3137*n+24.769*a+21.675*i-10.335*o))-4e-5*Math.cos(m*(156.5838-604925.8921*n-515.053*a-64.41*i+30.448*o))+36e-6*Math.cos(m*(169.7185+726808.1483*n-456.147*a-46.439*i+21.882*o))+29e-6*Math.cos(m*(113.8717+1745069.3958*n-63.665*a+7.287*i-3.538*o))-29e-6*Math.cos(m*(297.8502+445267.1115*n-16.3*a+1.832*i-.884*o))-28e-6*Math.cos(m*(294.0181-163726.0747*n-423.546*a-50.103*i+23.651*o))+27e-6*Math.cos(m*(263.6238+381403.5993*n-228.841*a-23.199*i+10.941*o))-26e-6*Math.cos(m*(358.0578+221744.8187*n-760.194*a-85.777*i+40.505*o))-26e-6*Math.cos(m*(8.1929+1403732.141*n+55.834*a+18.052*i-8.566*o))+.055544+.001*n*(-.0022*Math.cos(m*(103.2+377336.3*n))),u=.0011776*Math.cos(m*(49.1562-75869.812*n+35.458*a+4.231*i-2.001*o))-971e-7*Math.cos(m*(235.7004+890534.223*n-32.601*a+3.664*i-1.769*o))+908e-7*Math.cos(m*(186.5442+966404.0351*n-68.058*a-.567*i+.232*o))+623e-7*Math.cos(m*(83.3826-12006.2998*n+247.999*a+29.262*i-13.826*o))+483e-7*Math.cos(m*(51.6271-111868.8623*n+36.994*a+4.19*i-2.001*o))+348e-7*Math.cos(m*(100.737+413335.3554*n-122.571*a-10.684*i+5.028*o))-316e-7*Math.cos(m*(308.4192-489205.1674*n+158.029*a+14.915*i-7.029*o))-253e-7*Math.cos(m*(46.6853-39870.7617*n+33.922*a+4.272*i-2.001*o))-141e-7*Math.cos(m*(274.1928-553068.6797*n-54.513*a-10.116*i+4.797*o))+127e-7*Math.cos(m*(325.7736-63863.5122*n-212.541*a-25.031*i+11.826*o))+117e-7*Math.cos(m*(184.1196+401329.0556*n+125.428*a+18.579*i-8.798*o))-78e-7*Math.cos(m*(98.3124-151739.624*n+70.916*a+8.462*i-4.001*o))-63e-7*Math.cos(m*(238.1713+854535.1727*n-31.065*a+3.623*i-1.769*o))+63e-7*Math.cos(m*(134.9634+477198.8676*n+89.97*a+14.348*i-6.797*o))+36e-7*Math.cos(m*(321.5076+1443602.9027*n+21.912*a+13.78*i-6.566*o))-35e-7*Math.cos(m*(10.6638+1367733.0907*n+57.37*a+18.011*i-8.566*o))+24e-7*Math.cos(m*(149.8932+337465.5434*n-87.113*a-6.453*i+3.028*o))+24e-7*Math.cos(m*(170.9849-930404.9848*n+66.523*a+.608*i-.232*o))+.0449858+.001*(-.0203*Math.cos(m*(125-1934.1*n))+.0034*Math.cos(m*(220.2-1935.5*n))),c=83.353+4069.0137*n-103.238*a-12.492*i+5.263*o+(-15.448*Math.sin(m*(100.737+413335.3554*n-122.571*a-10.684*i+5.028*o))-9.642*Math.sin(m*(325.7736-63863.5122*n-212.541*a-25.031*i+11.826*o))-2.721*Math.sin(m*(134.9634+477198.8676*n+89.97*a+14.348*i-6.797*o))+2.607*Math.sin(m*(66.5106+349471.8432*n-335.112*a-35.715*i+16.854*o))+2.085*Math.sin(m*(201.474+826670.7108*n-245.142*a-21.367*i+10.057*o))+1.477*Math.sin(m*(10.6638+1367733.0907*n+57.37*a+18.011*i-8.566*o))+.968*Math.sin(m*(291.5472-127727.0245*n-425.082*a-50.062*i+23.651*o))-.949*Math.sin(m*(103.2079+377336.3051*n-121.035*a-10.724*i+5.028*o))-.703*Math.sin(m*(167.2476+762807.1986*n-457.683*a-46.398*i+21.882*o))-.66*Math.sin(m*(235.7004+890534.223*n-32.601*a+3.664*i-1.769*o))-.577*Math.sin(m*(190.8102-541062.3799*n-302.511*a-39.379*i+18.623*o))-.524*Math.sin(m*(269.9268+954397.7353*n+179.941*a+28.695*i-13.594*o))-.482*Math.sin(m*(32.2842+285608.3309*n-547.653*a-60.746*i+28.679*o))+.452*Math.sin(m*(357.5291+35999.0503*n-1.536*a+.041*i+0*o))-.381*Math.sin(m*(302.211+1240006.0662*n-367.713*a-32.051*i+15.085*o))-.342*Math.sin(m*(328.2445-99862.5625*n-211.005*a-25.072*i+11.826*o))-.312*Math.sin(m*(44.8902+1431596.6029*n+269.911*a+43.043*i-20.392*o))+.282*Math.sin(m*(162.8868-31931.7561*n-106.271*a-12.516*i+5.913*o))+.255*Math.sin(m*(203.9449+790671.6605*n-243.606*a-21.408*i+10.057*o))+.252*Math.sin(m*(68.9815+313472.7929*n-333.576*a-35.756*i+16.854*o))-.211*Math.sin(m*(83.3826-12006.2998*n+247.999*a+29.262*i-13.826*o))+.193*Math.sin(m*(267.9846+1176142.554*n-580.254*a-57.082*i+26.911*o))+.191*Math.sin(m*(133.0212+698943.6863*n-670.224*a-71.429*i+33.708*o))-.184*Math.sin(m*(55.8468-1018261.2475*n-392.482*a-53.726*i+25.42*o))+.182*Math.sin(m*(145.6272+1844931.9583*n+147.34*a+32.359*i-15.363*o))-.158*Math.sin(m*(257.3208-191590.5367*n-637.623*a-75.093*i+35.477*o))+.148*Math.sin(m*(156.5838-604925.8921*n-515.053*a-64.41*i+30.448*o))-.111*Math.sin(m*(169.7185+726808.1483*n-456.147*a-46.439*i+21.882*o))+.101*Math.sin(m*(13.1347+1331734.0404*n+58.906*a+17.971*i-8.566*o))+.1*Math.sin(m*(358.0578+221744.8187*n-760.194*a-85.777*i+40.505*o))+.087*Math.sin(m*(98.2661+449334.4057*n-124.107*a-10.643*i+5.028*o))+.08*Math.sin(m*(42.948+1653341.4216*n-490.283*a-42.734*i+20.113*o))+.08*Math.sin(m*(222.5657-441199.8173*n-91.506*a-14.307*i+6.797*o))+.077*Math.sin(m*(294.0181-163726.0747*n-423.546*a-50.103*i+23.651*o))-.073*Math.sin(m*(280.8834-1495460.1151*n-482.452*a-68.074*i+32.217*o))-.071*Math.sin(m*(304.6819+1204007.0159*n-366.177*a-32.092*i+15.085*o))-.069*Math.sin(m*(233.7582+1112279.0417*n-792.795*a-82.113*i+38.736*o))-.067*Math.sin(m*(34.7551+249609.2807*n-546.117*a-60.787*i+28.679*o))-.067*Math.sin(m*(263.6238+381403.5993*n-228.841*a-23.199*i+10.941*o))+.055*Math.sin(m*(21.6203-1082124.7597*n-605.023*a-78.757*i+37.246*o))+.055*Math.sin(m*(308.4192-489205.1674*n+158.029*a+14.915*i-7.029*o))-.054*Math.sin(m*(8.7216+1589477.9094*n-702.824*a-67.766*i+31.939*o))-.052*Math.sin(m*(179.8536+1908795.4705*n+359.881*a+57.39*i-27.189*o))-.05*Math.sin(m*(98.7948+635080.1741*n-882.765*a-96.461*i+45.533*o))-.049*Math.sin(m*(128.6604-95795.2683*n-318.812*a-37.547*i+17.738*o))-.047*Math.sin(m*(17.3544+425341.6552*n-370.57*a-39.946*i+18.854*o))-.044*Math.sin(m*(160.4159+4067.2942*n-107.806*a-12.475*i+5.913*o))-.043*Math.sin(m*(238.1713+854535.1727*n-31.065*a+3.623*i-1.769*o))+.042*Math.sin(m*(270.4555+1140143.5037*n-578.718*a-57.123*i+26.911*o))-.042*Math.sin(m*(132.4925+513197.9179*n+88.434*a+14.388*i-6.797*o))-.041*Math.sin(m*(122.3573-668789.4043*n-727.594*a-89.441*i+42.274*o))-.04*Math.sin(m*(105.6788+341337.2548*n-119.499*a-10.765*i+5.028*o))+.038*Math.sin(m*(135.4921+662944.6361*n-668.688*a-71.47*i+33.708*o))-.037*Math.sin(m*(242.391-51857.2124*n-460.54*a-54.293*i+25.652*o))+.036*Math.sin(m*(336.4374+1303869.5784*n-155.171*a-7.02*i+3.259*o))+.035*Math.sin(m*(223.0943-255454.0489*n-850.164*a-100.124*i+47.302*o))-.034*Math.sin(m*(193.2811-577061.4302*n-300.976*a-39.419*i+18.623*o))+.031*Math.sin(m*(87.6023-918398.685*n-181.476*a-28.654*i+13.594*o)))+.001*n*(2.4*Math.sin(m*(103.2+377336.3*n))),h=125.0446-1934.13618*n+20.762*a+2.139*i-1.65*o+(-1.4979*Math.sin(m*(49.1562-75869.812*n+35.458*a+4.231*i-2.001*o))-.15*Math.sin(m*(357.5291+35999.0503*n-1.536*a+.041*i+0*o))-.1226*Math.sin(m*(235.7004+890534.223*n-32.601*a+3.664*i-1.769*o))+.1176*Math.sin(m*(186.5442+966404.0351*n-68.058*a-.567*i+.232*o))-.0801*Math.sin(m*(83.3826-12006.2998*n+247.999*a+29.262*i-13.826*o))-.0616*Math.sin(m*(51.6271-111868.8623*n+36.994*a+4.19*i-2.001*o))+.049*Math.sin(m*(100.737+413335.3554*n-122.571*a-10.684*i+5.028*o))+.0409*Math.sin(m*(308.4192-489205.1674*n+158.029*a+14.915*i-7.029*o))+.0327*Math.sin(m*(134.9634+477198.8676*n+89.97*a+14.348*i-6.797*o))+.0324*Math.sin(m*(46.6853-39870.7617*n+33.922*a+4.272*i-2.001*o))+.0196*Math.sin(m*(98.3124-151739.624*n+70.916*a+8.462*i-4.001*o))+.018*Math.sin(m*(274.1928-553068.6797*n-54.513*a-10.116*i+4.797*o))+.015*Math.sin(m*(325.7736-63863.5122*n-212.541*a-25.031*i+11.826*o))-.015*Math.sin(m*(184.1196+401329.0556*n+125.428*a+18.579*i-8.798*o))-.0078*Math.sin(m*(238.1713+854535.1727*n-31.065*a+3.623*i-1.769*o))-.0045*Math.sin(m*(10.6638+1367733.0907*n+57.37*a+18.011*i-8.566*o))+.0044*Math.sin(m*(321.5076+1443602.9027*n+21.912*a+13.78*i-6.566*o))-.0042*Math.sin(m*(162.8868-31931.7561*n-106.271*a-12.516*i+5.913*o))-.0031*Math.sin(m*(170.9849-930404.9848*n+66.523*a+.608*i-.232*o))+.0031*Math.sin(m*(103.2079+377336.3051*n-121.035*a-10.724*i+5.028*o))+.0029*Math.sin(m*(222.612-1042273.8471*n+103.516*a+4.798*i-2.232*o))+.0028*Math.sin(m*(184.0733+1002403.0853*n-69.594*a-.526*i+.232*o)))+.001*(25.9*Math.sin(m*(125-1934.1*n))-4.3*Math.sin(m*(220.2-1935.5*n))+.38*Math.sin(m*(357.5+35999.1*n))*n),f=218.31665+481267.88134*n-13.268*a+1.856*i-1.534*o+(-.92581*Math.sin(m*(235.7004+890534.223*n-32.601*a+3.664*i-1.769*o))+.33262*Math.sin(m*(100.737+413335.3554*n-122.571*a-10.684*i+5.028*o))-.18402*Math.sin(m*(357.5291+35999.0503*n-1.536*a+.041*i+0*o))+.11007*Math.sin(m*(134.9634+477198.8676*n+89.97*a+14.348*i-6.797*o))-.06055*Math.sin(m*(238.1713+854535.1727*n-31.065*a+3.623*i-1.769*o))+.04741*Math.sin(m*(325.7736-63863.5122*n-212.541*a-25.031*i+11.826*o))-.03086*Math.sin(m*(10.6638+1367733.0907*n+57.37*a+18.011*i-8.566*o))+.02184*Math.sin(m*(103.2079+377336.3051*n-121.035*a-10.724*i+5.028*o))+.01645*Math.sin(m*(49.1562-75869.812*n+35.458*a+4.231*i-2.001*o))+.01022*Math.sin(m*(233.2295+926533.2733*n-34.136*a+3.705*i-1.769*o))-.00756*Math.sin(m*(336.4374+1303869.5784*n-155.171*a-7.02*i+3.259*o))-.0053*Math.sin(m*(222.5657-441199.8173*n-91.506*a-14.307*i+6.797*o))-.00496*Math.sin(m*(162.8868-31931.7561*n-106.271*a-12.516*i+5.913*o))-.00472*Math.sin(m*(297.8502+445267.1115*n-16.3*a+1.832*i-.884*o))-.00271*Math.sin(m*(240.6422+818536.1225*n-29.529*a+3.582*i-1.769*o))+.00264*Math.sin(m*(132.4925+513197.9179*n+88.434*a+14.388*i-6.797*o))-.00254*Math.sin(m*(186.5442+966404.0351*n-68.058*a-.567*i+.232*o))+.00234*Math.sin(m*(269.9268+954397.7353*n+179.941*a+28.695*i-13.594*o))-.0022*Math.sin(m*(13.1347+1331734.0404*n+58.906*a+17.971*i-8.566*o))-.00202*Math.sin(m*(355.0582+71998.1006*n-3.072*a+.082*i+0*o))+.00167*Math.sin(m*(328.2445-99862.5625*n-211.005*a-25.072*i+11.826*o))-.00143*Math.sin(m*(173.5506+1335801.3346*n-48.901*a+5.496*i-2.653*o))-.00121*Math.sin(m*(98.2661+449334.4057*n-124.107*a-10.643*i+5.028*o))-.00116*Math.sin(m*(145.6272+1844931.9583*n+147.34*a+32.359*i-15.363*o))+.00102*Math.sin(m*(105.6788+341337.2548*n-119.499*a-10.765*i+5.028*o))-9e-4*Math.sin(m*(184.1196+401329.0556*n+125.428*a+18.579*i-8.798*o))-86e-5*Math.sin(m*(338.9083+1267870.5281*n-153.636*a-7.061*i+3.259*o))-78e-5*Math.sin(m*(111.4008+1781068.4461*n-65.201*a+7.328*i-3.538*o))+69e-5*Math.sin(m*(323.3027-27864.4619*n-214.077*a-24.99*i+11.826*o))+66e-5*Math.sin(m*(51.6271-111868.8623*n+36.994*a+4.19*i-2.001*o))+65e-5*Math.sin(m*(38.5872+858602.4669*n-138.871*a-8.852*i+4.144*o))-6e-4*Math.sin(m*(83.3826-12006.2998*n+247.999*a+29.262*i-13.826*o))+54e-5*Math.sin(m*(201.474+826670.7108*n-245.142*a-21.367*i+10.057*o))-52e-5*Math.sin(m*(308.4192-489205.1674*n+158.029*a+14.915*i-7.029*o))+48e-5*Math.sin(m*(8.1929+1403732.141*n+55.834*a+18.052*i-8.566*o))-41e-5*Math.sin(m*(46.6853-39870.7617*n+33.922*a+4.272*i-2.001*o))-33e-5*Math.sin(m*(274.1928-553068.6797*n-54.513*a-10.116*i+4.797*o))+3e-4*Math.sin(m*(160.4159+4067.2942*n-107.806*a-12.475*i+5.913*o)))+.001*(3.96*Math.sin(m*(119.7+131.8*n))+1.96*Math.sin(m*(125-1934.1*n))+(.463*Math.sin(m*(357.5+35999.1*n))+.152*Math.sin(m*(238.2+854535.2*n))-.071*Math.sin(m*(27.8+131.8*n))-.055*Math.sin(m*(103.2+377336.3*n))-.026*Math.sin(m*(233.2+926533.3*n)))*n+(14*Math.sin(m*(357.5+35999.1*n))+5*Math.sin(m*(238.2+854535.2*n)))*a);return t.a=s,t.e=l,t.i=2*Math.asin(u),t.w=K(m*(c-h)),t.N=K(m*h),t.M=K(m*(f-c)),t},corr:function(t,n){var e=K(n.M+Math.PI),r=K(n.w+Math.PI),a=t.M+t.w,i=a+t.N-e-r,o=-.022234*Math.sin(t.M-2*i)+.011494*Math.sin(2*i)+-.003246*Math.sin(e)+-.001029*Math.sin(2*t.M-2*i)+-994838e-9*Math.sin(t.M-2*i+e)+925025e-9*Math.sin(t.M+2*i)+802851e-9*Math.sin(2*i-e)+715585e-9*Math.sin(t.M-e)+-610865e-9*Math.sin(i)+-541052e-9*Math.sin(t.M+e)+-261799e-9*Math.sin(2*a-2*i)+191986e-9*Math.sin(t.M-4*i);t.ra+=o;var s=-.003019*Math.sin(a-2*i)+-959931e-9*Math.sin(t.M-a-2*i)+-802851e-9*Math.sin(t.M+a-2*i)+575958e-9*Math.sin(a+2*i)+296706e-9*Math.sin(2*t.M+a);return t.dec+=s,t.age=K(t.l-n.l+Math.PI),t.phase=.5*(1-Math.cos(t.age)),t}};function yt(t){d3.select("body").append("div").attr("id","d3-celestial-svg").attr("style","display: none");var n,e,r=d3.select("#d3-celestial-svg").append("svg"),a=s.metrics(),i=P.set(),o=i.datapath,l=I[i.projection],u=b(i.center),f=[-u[0],-u[1]],p=l.scale*a.width/1024,d=s.projection(i.projection).rotate(u).translate([a.width/2,a.height/2]).scale([a.scale]),v=i.adaptable?Math.sqrt(a.scale/p):1,m=""!==i.culture&&"iau"!==i.culture?i.culture:"";r.selectAll("*").remove();var x=r.append("defs");l.clip&&d.clipAngle(90),n=d3.geo.circle().angle([179.95]).origin(f),r.attr("width",a.width).attr("height",a.height);for(var k=["background","milkyWay","milkyWayBg","gridLines","constBoundaries","planesequatorial","planesecliptic","planesgalactic","planessupergalactic","constLines","mapBorder","stars","dsos","planets","gridvaluesLon","gridvaluesLat","constNames","starDesignations","starNames","dsoNames","planetNames","horizon","daylight"],S={},z={},A=0;A<k.length;A++)S[k[A]]=r.append("g").attr({id:k[A],":inkscape:groupmode":"layer",":inkscape:label":k[A]}),z[k[A]]={};var N=d3.geo.graticule().minorStep([15,10]),j=d3.geo.path().projection(d),L=d3.queue(2);if(S.background.append("path").datum(n).attr("class","background").attr("d",j),z.background.fill=i.background.fill,i.lines.graticule.show){if("equatorial"===i.transform?(S.gridLines.append("path").datum(N).attr("class","gridLines").attr("d",j),z.gridLines=G(i.lines.graticule)):(s.graticule(S.gridLines,j,i.transform),z.gridLines=G(i.lines.graticule)),V(i.lines.graticule,"lon")&&i.lines.graticule.lon.pos.length>0){var C={type:"FeatureCollection",features:E("lon",i.lines.graticule.lon.pos)};S.gridvaluesLon.selectAll(".gridvalues_lon").data(C.features).enter().append("text").attr("transform",function(t,n){return H(t.geometry.coordinates)}).text(function(t){return t.properties.value}).attr({dy:".5em",dx:"-.75em",class:"gridvaluesLon"}),z.gridvaluesLon=Y(i.lines.graticule.lon)}if(V(i.lines.graticule,"lat")&&i.lines.graticule.lat.pos.length>0){var F={type:"FeatureCollection",features:E("lat",i.lines.graticule.lat.pos)};S.gridvaluesLat.selectAll(".gridvalues_lat").data(F.features).enter().append("text").attr("transform",function(t,n){return H(t.geometry.coordinates)}).text(function(t){return t.properties.value}).attr({dy:"-.5em",dx:"-.75em",class:"gridvaluesLat"}),z.gridvaluesLat=Y(i.lines.graticule.lat)}}for(var O in i.lines)V(i.lines,O)&&"graticule"!=O&&!1!==i.lines[O].show&&(S[e="planes"+O].append("path").datum(d3.geo.circle().angle([90]).origin(g[O])).attr("class",e).attr("d",j),z[e]=G(i.lines[O]));function U(t){return l.clip&&d3.geo.distance(f,t)>M?0:1}function H(t){return"translate("+d(t)+")"}function Q(t,n,e){return t+(n=n?"."+n:"")+(V(R[t],m)?"."+m:"")+(e?"."+e:".json")}function G(t){var n={};return n.fill=t.fill||"none",n["fill-opacity"]=null!==t.opacity?t.opacity:1,n.stroke=t.stroke||"none",n["stroke-width"]=null!==t.width?t.width:0,n["stroke-opacity"]=null!==t.opacity?t.opacity:1,n["stroke-dasharray"]=V(t,"dash")?t.dash.join(" "):"none",n.font=t.font||null,n}function Y(t){var n={stroke:"none"};return n.fill=t.fill||"none",n["fill-opacity"]=null!==t.opacity?t.opacity:1,n["text-anchor"]=W(t.align),n.font=t.font||null,n}function W(t){return t?"center"===t?"middle":"right"===t?"end":"start":"start"}function $(t){var n={type:"Feature",id:t.id,properties:{},geometry:{}};return n.properties.name=t[i.planets.namesType],"symbol"!==i.planets.symbolType&&"letter"!==i.planets.symbolType||(n.properties.symbol=i.planets.symbols[n.id][i.planets.symbolType]),n.properties.mag=t.ephemeris.mag||10,"lun"===n.id&&(n.properties.age=t.ephemeris.age,n.properties.phase=t.ephemeris.phase),n.geometry.type="Point",n.geometry.coordinates=t.ephemeris.pos,n}function Z(t){var n=" {";for(var e in t)V(t,e)&&(n+=e+":"+t[e]+"; ");return n+"} "}i.mw.show&&L.defer(function(t){d3.json(o+"mw.json",function(n,e){n&&t(n);var r=_(e,i.transform),a=T(r);S.milkyWay.selectAll(".mway").data(r.features).enter().append("path").attr("class","milkyWay").attr("d",j),z.milkyWay=G(i.mw.style),(!V(i.background,"opacity")||i.background.opacity>.95)&&(S.milkyWayBg.selectAll(".mwaybg").data(a.features).enter().append("path").attr("class","milkyWayBg").attr("d",j),z.milkyWayBg={fill:i.background.fill,"fill-opacity":i.background.opacity}),t(null)})}),i.constellations.bounds&&L.defer(function(t){d3.json(o+Q("constellations","borders"),function(n,e){n&&t(n);var r=_(e,i.transform);if(s.constellation)var a=new RegExp("\\b"+s.constellation+"\\b");S.constBoundaries.selectAll(".bounds").data(r.features).enter().append("path").attr("class",function(t){return s.constellation&&-1!==t.ids.search(a)?"constBoundariesSel":"constBoundaries"}).attr("d",j),z.constBoundaries=G(i.constellations.boundStyle),z.constBoundariesSel={fill:"none",stroke:i.constellations.boundStyle.stroke,"stroke-width":1.5*i.constellations.boundStyle.width,"stroke-opacity":1,"stroke-dasharray":"none"},t(null)})}),i.constellations.lines&&L.defer(function(t){d3.json(o+Q("constellations","lines"),function(n,e){n&&t(n);var r=_(e,i.transform);S.constLines.selectAll(".lines").data(r.features).enter().append("path").attr("class",function(t){return"constLines"+t.properties.rank}).attr("d",j);var a=V(i.constellations.lineStyle,"dash")?i.constellations.lineStyle.dash.join(" "):"none";z.constLines1={fill:"none",stroke:i.constellations.lineStyle.stroke[0],"stroke-width":i.constellations.lineStyle.width[0],"stroke-opacity":i.constellations.lineStyle.opacity[0],"stroke-dasharray":a},z.constLines2={fill:"none",stroke:i.constellations.lineStyle.stroke[1],"stroke-width":i.constellations.lineStyle.width[1],"stroke-opacity":i.constellations.lineStyle.opacity[1],"stroke-dasharray":a},z.constLines3={fill:"none",stroke:i.constellations.lineStyle.stroke[2],"stroke-width":i.constellations.lineStyle.width[2],"stroke-opacity":i.constellations.lineStyle.opacity[2],"stroke-dasharray":a},t(null)})}),L.defer(function(t){var n=d.rotate();d.rotate([0,0,0]),S.mapBorder.append("path").datum(N.outline).attr("class","mapBorder").attr("d",j),z.mapBorder={fill:"none",stroke:i.background.stroke,"stroke-width":i.background.width,"stroke-opacity":1,"stroke-dasharray":"none"},d.rotate(n),t(null)}),i.constellations.names&&L.defer(function(t){d3.json(o+Q("constellations"),function(n,e){n&&t(n);var r=_(e,i.transform);S.constNames.selectAll(".constnames").data(r.features.filter(function(t){return 1===U(t.geometry.coordinates)})).enter().append("text").attr("class",function(t){return"constNames"+t.properties.rank}).attr("transform",function(t,n){return H(t.geometry.coordinates)}).text(function(t){return function(t){return t.properties[i.constellations.namesType]}(t)}),z.constNames1={fill:i.constellations.nameStyle.fill[0],"fill-opacity":i.constellations.nameStyle.opacity[0],font:i.constellations.nameStyle.font[0],"text-anchor":W(i.constellations.nameStyle.align)},z.constNames2={fill:i.constellations.nameStyle.fill[1],"fill-opacity":i.constellations.nameStyle.opacity[1],font:i.constellations.nameStyle.font[1],"text-anchor":W(i.constellations.nameStyle.align)},z.constNames3={fill:i.constellations.nameStyle.fill[2],"fill-opacity":i.constellations.nameStyle.opacity[2],font:i.constellations.nameStyle.font[2],"text-anchor":W(i.constellations.nameStyle.align)},t(null)})}),i.stars.show&&L.defer(function(t){d3.json(o+i.stars.data,function(n,e){n&&t(n);var r=_(e,i.transform);S.stars.selectAll(".stars").data(r.features.filter(function(t){return t.properties.mag<=i.stars.limit})).enter().append("path").attr("class",function(t){return"stars"+(n=t.properties.bv,!i.stars.colors||isNaN(n)?"":Math.round(10*n).toString());var n}).attr("d",j.pointRadius(function(t){return t.properties?function(t){if(null===t)return.1;var n=i.stars.size*v*Math.exp(i.stars.exponent*(t+2));return Math.max(n,.1)}(t.properties.mag):1})),z.stars=G(i.stars.style);var a=D.domain();for(A=B(a[1],1);A<=B(a[0],1);A+=.1)z["stars"+Math.round(10*A).toString()]={fill:D(A)};i.stars.designation&&(S.starDesignations.selectAll(".stardesigs").data(r.features.filter(function(t){return t.properties.mag<=i.stars.designationLimit*v&&1===U(t.geometry.coordinates)})).enter().append("text").attr("transform",function(t){return H(t.geometry.coordinates)}).text(function(t){return function(t){return V(c,t)?c[t][i.stars.designationType]:""}(t.id)}).attr({dy:".85em",dx:".35em",class:"starDesignations"}),z.starDesignations=Y(i.stars.designationStyle)),i.stars.propername&&(S.starNames.selectAll(".starnames").data(r.features.filter(function(t){return t.properties.mag<=i.stars.propernameLimit*v&&1===U(t.geometry.coordinates)})).enter().append("text").attr("transform",function(t){return H(t.geometry.coordinates)}).text(function(t){return function(t){var n=i.stars.propernameType;return V(c,t)?V(c[t],n)?c[t][n]:c[t].name:""}(t.id)}).attr({dy:"-.5em",dx:"-.35em",class:"starNames"}),z.starNames=Y(i.stars.propernameStyle)),t(null)})}),i.dsos.show&&L.defer(function(t){d3.json(o+i.dsos.data,function(n,r){n&&t(n);var a=_(r,i.transform);for(O in S.dsos.selectAll(".dsos").data(a.features.filter(function(t){return 1===U(t.geometry.coordinates)&&(999===t.properties.mag&&Math.sqrt(parseInt(t.properties.dim))>i.dsos.limit*v||999!==t.properties.mag&&t.properties.mag<=i.dsos.limit)})).enter().append("path").attr("class",function(t){return"dsos"+t.properties.type}).attr("transform",function(t){return H(t.geometry.coordinates)}).attr("d",function(t){return o=(n=t.properties).dim,e=((a=n.mag)&&999!==a?Math.pow(2*i.dsos.size*v-a,i.dsos.exponent):Math.pow(parseInt(o)*i.dsos.size*v/7,.5))||9,r=function(t){return t&&V(i.dsos.symbols,t)?i.dsos.symbols[t].shape:"circle"}(n.type),-1!==d3.svg.symbolTypes.indexOf(r)?d3.svg.symbol().type(r).size(e)():d3.svg.customSymbol().type(r).size(e)();var n,e,r,a,o}),z.dsos=G(i.dsos.style),i.dsos.symbols)V(i.dsos.symbols,O)&&(z[e="dsos"+O]={"fill-opacity":i.dsos.style.opacity,"stroke-opacity":i.dsos.style.opacity},V(i.dsos.symbols[O],"stroke")?(z[e].fill="none",z[e].stroke=i.dsos.colors?i.dsos.symbols[O].stroke:i.dsos.style.stroke,z[e]["stroke-width"]=i.dsos.colors?i.dsos.symbols[O].width:i.dsos.style.width):(z[e].stroke="none",z[e].fill=i.dsos.colors?i.dsos.symbols[O].fill:i.dsos.style.fill));if(i.dsos.names)for(O in S.dsoNames.selectAll(".dsonames").data(a.features.filter(function(t){return 1===U(t.geometry.coordinates)&&(999==t.properties.mag&&Math.sqrt(parseInt(t.properties.dim))>i.dsos.nameLimit||999!=t.properties.mag&&t.properties.mag<=i.dsos.nameLimit)})).enter().append("text").attr("class",function(t){return"dsoNames "+t.properties.type}).attr("transform",function(t){return H(t.geometry.coordinates)}).text(function(t){return function(t){var n=i.dsos.namesType,e=t.id;return"desig"!==n&&V(h,e)&&V(h[e],n)?h[e][n]:t.properties.desig}(t)}).attr({dy:"-.5em",dx:".35em"}),z.dsoNames={"fill-opacity":i.dsos.style.opacity,font:i.dsos.nameStyle.font,"text-anchor":W(i.dsos.nameStyle.align)},i.dsos.symbols)V(i.dsos.symbols,O)&&(z[O]={fill:i.dsos.colors?i.dsos.symbols[O].fill:i.dsos.style.fill});t(null)})}),(i.location||i.formFields.location)&&i.planets.show&&s.origin&&L.defer(function(t){var n,e,r=s.date(),a=s.origin(r).spherical(),o={type:"FeatureCollection",features:[]},l={type:"FeatureCollection",features:[]};if(s.container.selectAll(".planet").each(function(t){var n=t.id(),e=t(r).equatorial(a);e.ephemeris.pos=y(e.ephemeris.pos,w[i.transform]),1===U(e.ephemeris.pos)&&("lun"===n?l.features.push($(e)):o.features.push($(e)))}),"disk"===i.planets.symbolType?S.planets.selectAll(".planets").data(o.features).enter().append("path").attr("transform",function(t){return H(t.geometry.coordinates)}).attr("d",function(t){var n=V(i.planets.symbols[t.id],"size")?(i.planets.symbols[t.id].size-1)*v:null;return function(t,n){var e=n?n*n:function(t){var n=4*v*Math.exp(-.05*((t||2)+2));return Math.max(n,2)}(t.mag);return d3.svg.symbol().type("circle").size(e)()}(t.properties,n)}).attr("class",function(t){return"planets "+t.id}):S.planets.selectAll(".planets").data(o.features).enter().append("text").attr("transform",function(t){return H(t.geometry.coordinates)}).text(function(t){return t.properties.symbol}).attr("class",function(t){return"planets "+t.id}).attr({dy:".35em"}),l.features.length>0)if("letter"===i.planets.symbolType)S.planets.selectAll(".moon").data(l.features).enter().append("text").attr("transform",function(t){return H(t.geometry.coordinates)}).text(function(t){return t.properties.symbol}).attr("class",function(t){return"planets "+t.id}).attr({dy:".35em"});else{var u=V(i.planets.symbols.lun,"size")?(i.planets.symbols.lun.size-1)*v:11*v;S.planets.selectAll(".dmoon").data(l.features).enter().append("path").attr("class","darkluna").attr("transform",function(t){return H(t.geometry.coordinates)}).attr("d",function(t){return d3.svg.symbol().type("circle").size(u*u)()}),S.planets.selectAll(".moon").data(l.features).enter().append("path").attr("class",function(t){return"planets "+t.id}).attr("transform",function(t){return H(t.geometry.coordinates)}).attr("d",function(t){return n=t.properties,r=(e=u)?e*e:121,d3.svg.customSymbol().type("crescent").size(r).ratio(n.age)();var n,e,r})}for(O in z.planets=Y(i.planets.symbolStyle),z.planets.font=(e=(n=i.planets.symbolStyle.font).replace(/(^\D*)(\d+)(\D.+$)/i,"$2"),e=Math.round(v*e),n.replace(/(^\D*)(\d+)(\D.+$)/i,"$1"+e+"$3")),z.darkluna={fill:"#557"},i.planets.symbols)V(i.planets.symbols,O)&&(z[O]={fill:i.planets.symbols[O].fill});i.planets.names&&(S.planetNames.selectAll(".planetnames").data(o.features).enter().append("text").attr("transform",function(t){return H(t.geometry.coordinates)}).text(function(t){return t.properties.name}).attr({dy:".85em",dx:"-.35em"}).attr("class",function(t){return"planetNames "+t.id}),l.features.length>0&&S.planetNames.selectAll(".moonname").data(l.features).enter().append("text").attr("transform",function(t){return H(t.geometry.coordinates)}).text(function(t){return t.properties.name}).attr({dy:".85em",dx:"-.35em"}).attr("class",function(t){return"planetNames "+t.id})),z.planetNames=Y(i.planets.nameStyle),t(null)}),(i.location||i.formFields.location)&&i.daylight.show&&l.clip&&L.defer(function(t){var n=q("sol");if(n){var e=s.zenith(),r=n.ephemeris.pos,a=d3.geo.distance(e,r),i=d(r),o=d3.geo.circle().angle([179.95]).origin(r);S.daylight.append("path").datum(o).attr("class","daylight").attr("d",j),z.daylight=function(t,n){var e,r,a,i,o=1.36;if(t>1.885)return{fill:"transparent"};t<=o?(r="#daf1fa",a="#93d7f0",i="#57c0e8",e=-(o-t)/10):(e=(t-o)/(1.885-o),r=d3.interpolateLab("#daf1fa","#e8c866")(e),a=d3.interpolateLab("#93c7d0","#ff854a")(e),i=d3.interpolateLab("#57b0c8","#6caae2")(e));var s,l=S.daylight.append("radialGradient").attr("cx",n[0]).attr("cy",n[1]).attr("fr","0").attr("r","300").attr("id","skygradient").attr("gradientUnits","userSpaceOnUse");return l.append("stop").attr("offset","0").attr("stop-color",r),l.append("stop").attr("offset",.2+.4*e).attr("stop-color",a),l.append("stop").attr("offset","1").attr("stop-color",i),{fill:"url(#skygradient)","fill-opacity":(s=e,1.4,.9*(1-(Math.pow(Math.E,1.4*s)-1)/(Math.pow(Math.E,1.4)-1)))}}(a,i),1===U(r)&&a<M&&S.daylight.append("circle").attr("cx",i[0]).attr("cy",i[1]).attr("r",5).style("fill","#fff")}t(null)}),(i.location||i.formFields.location)&&i.horizon.show&&!l.clip&&L.defer(function(t){var n=d3.geo.circle().angle([90]).origin(s.nadir());S.horizon.append("path").datum(n).attr("class","horizon").attr("d",j),z.horizon=G(i.horizon),t(null)}),s.data.length>0&&s.data.forEach(function(t){V(t,"save")&&L.defer(function(n){t.save(),n(null)})}),L.await(function(n){if(n)throw n;var e=d3.select("#d3-celestial-svg svg").attr("title","D3-Celestial").attr("version",1.1).attr("encoding","UTF-8").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("xmlns:sodipodi","http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd").attr("xmlns:inkscape","http://www.inkscape.org/namespaces/inkscape").attr("viewBox"," 0 0 "+a.width+" "+a.height);if(x.append("style").attr("type","text/css").text(function(){var t="";for(var n in z)V(z,n)&&(t+=" ."+n+Z(z[n]));return"/*<![CDATA[*/\n"+t+"\n/*]]>*/"}()),t){var r=new Blob([e.node().outerHTML],{type:"image/svg+xml;charset=utf-8"}),i=d3.select("body").append("a").node();i.download=t||"d3-celestial.svg",i.rel="noopener",i.href=URL.createObjectURL(r),i.click(),d3.select(i).remove()}else null!==wt&&wt(e.node().outerHTML);d3.select("#d3-celestial-svg").remove()})}var bt=d3.map({ellipse:function(t,n){var e=Math.sqrt(t),r=.666*e,a=e/3;return"M"+-r+","+-a+" m"+-r+",0 a"+r+","+a+" 0 1,0"+2*r+",0 a"+r+","+a+" 0 1,0"+-2*r+",0"},marker:function(t,n){var e=(t>48?t/4:12)/2,r=e-3;return"M "+-e+" 0 h "+r+" M 0 "+-e+" v "+r+" M "+e+" 0 h "+-r+" M 0 "+e+" v "+-r},"cross-circle":function(t,n){var e=Math.sqrt(t),r=e/2;return"M"+-r+","+-r+" m"+-r+",0 a"+r+","+r+" 0 1,0"+2*r+",0 a"+r+","+r+" 0 1,0"+-2*r+",0 M"+-r+" 0 h "+e+" M 0 "+-r+" v "+e},"stroke-circle":function(t,n){var e=Math.sqrt(t),r=e/2;return"M"+-r+","+-r+" m"+-r+",0 a"+r+","+r+" 0 1,0"+2*r+",0 a"+r+","+r+" 0 1,0"+-2*r+",0 M"+(-e-2)+","+(-e-2)+" l"+(e+4)+","+(e+4)},crescent:function(t,n){var e=Math.sqrt(t)/2,r=.5*(1-Math.cos(n)),a=1.6*Math.abs(r-.5)+.01,i=n>Math.PI?0:1;return"M -1,-1 m 1,"+(1-e)+" a"+e+","+e+" 0 1 "+i+" 0,"+2*e+" a"+e*a+","+e+" 0 1 "+(Math.abs(r)>.5?i:Math.abs(i-1))+" 0,"+-2*e+"z"}});d3.svg.customSymbol=function(){var t,n=64,e=d3.functor(1);function r(r,a){return bt.get(t.call(this,r,a))(n.call(this,r,a),e.call(this,r,a))}return r.type=function(n){return arguments.length?(t=d3.functor(n),r):t},r.size=function(t){return arguments.length?(n=d3.functor(t),r):n},r.ratio=function(t){return arguments.length?(e=d3.functor(t),r):e},r};var wt=null;s.exportSVG=function(t){t&&(wt=t,yt())};var xt,kt=function(t,n){var r,a,i,o=new Date,s=(d3.time.format("%Z"),[{"\u221212:00":-720},{"\u221211:00":-660},{"\u221210:00":-600},{"\u221209:30":-570},{"\u221209:00":-540},{"\u221208:00":-480},{"\u221207:00":-420},{"\u221206:00":-360},{"\u221205:00":-300},{"\u221204:30":-270},{"\u221204:00":-240},{"\u221203:30":-210},{"\u221203:00":-180},{"\u221202:30":-150},{"\u221202:00":-120},{"\u221201:00":-60},{"\xb100:00":0},{"+01:00":60},{"+02:00":120},{"+03:00":180},{"+03:30":210},{"+04:00":240},{"+04:30":270},{"+05:00":300},{"+05:30":330},{"+05:45":345},{"+06:00":360},{"+06:30":390},{"+07:00":420},{"+08:00":480},{"+08:30":510},{"+08:45":525},{"+09:00":540},{"+09:30":570},{"+10:00":600},{"+10:30":630},{"+11:00":660},{"+12:00":720},{"+12:45":765},{"+13:00":780},{"+14:00":840}]),l=["Su","M","Tu","W","Th","F","Sa"],u=(g(o),d3.time.format("%Y-%m-%d")),c=t.daterange||[],h=d3.select(e+" ~ #celestial-form").append("div").attr("id","celestial-date");function f(){var t=ct("mon").value,n=ct("yr").value,r=new Date(n,t,1),a=d3.select(e+" ~ #celestial-form").select("#cal"),i=new Date;n=parseInt(n),t=parseInt(t),r.setDate(r.getDate()-r.getDay());for(var s=a.node();s.firstChild;)s.removeChild(s.firstChild);for(var c=0;c<7;c++)a.append("div").classed({date:!0,weekday:!0}).html(l[c]);for(c=0;c<42;c++){var h=r.getMonth(),f=r.getDay(),p=u(r);a.append("div").classed({date:!0,grey:h!==t,weekend:h===t&&(0===f||6===f),today:0===W(r,i),selected:0===W(r,o)}).attr("id",p).on("click",y).html(r.getDate().toString()),r.setDate(r.getDate()+1)}}function p(){var t=d3.select(e+" ~ #celestial-form").select("select#yr"),n=o.getFullYear(),r=0,a=g(o);t.selectAll("*").remove(),t.selectAll("option").data(a).enter().append("option").text(function(t,e){return t===n&&(r=e),t.toString()}),t.property("selectedIndex",r)}function d(t){h.append("div").attr("id",t).on("click",function(){var n=ct("mon"),e=ct("yr");"left"===t?0===n.selectedIndex?(n.selectedIndex=11,e.selectedIndex--):n.selectedIndex--:11===n.selectedIndex?(n.selectedIndex=0,e.selectedIndex++):n.selectedIndex++,f()})}function g(t){for(var n=(a=t.getFullYear(),!c||c.length<1?[a-10,a+10]:1===c.length&&G(c[0])?c[0]>=100?[c[0]-10,c[0]+10]:[a-c[0],a+c[0]]:2===c.length&&G(c[0])&&G(c[1])?c[1]>=100?[c[0],c[1]]:[c[0]-c[1],c[0]+c[1]]:[a-10,a+10]),e=[],r=n[0];r<=n[1];r++)e.push(r);var a;return e}function v(t,n){for(var e=ct(t),r=0;r<e.childNodes.length;r++)if(e.childNodes[r].value==n){e.selectedIndex=r;break}}function M(t){t&&o.setTime(t.valueOf()),v("yr",o.getFullYear()),v("mon",o.getMonth()),f(),ct("hr").value=o.getHours(),ct("min").value=o.getMinutes(),ct("sec").value=o.getSeconds()}function m(){d3.select(e+" ~ #celestial-form").select("#celestial-date").style("opacity",0),d3.select("#error").style({top:"-9999px",left:"-9999px",opacity:0}),d3.select(e+" ~ #celestial-form").select("#datepick").classed("active",!1),setTimeout(function(){ct("celestial-date").style.top=H(-9999)},600)}function y(){var t=ct("hr").value,e=ct("min").value,r=ct("sec").value,a=ct("tz").value;this.id&&-1!==this.id.search(/^\d/)&&(o=u.parse(this.id)),p(),o.setHours(t,e,r),M(),n(o,a)}d("left"),r=h.append("select").attr("title","Month").attr("id","mon").on("change",f),a=0,i=o.getMonth(),r.selectAll("option").data(["January","February","March","April","May","June","July","August","September","October","November","December"]).enter().append("option").attr("value",function(t,n){return n===i&&(a=n),n}).text(function(t){return t}),r.property("selectedIndex",a),h.append("select").attr("title","Year").attr("id","yr").on("change",f),p(),d("right"),h.append("div").attr("id","cal"),f(),h.append("input").attr("type","number").attr("id","hr").attr("title","Hours").attr("max","24").attr("min","-1").attr("step","1").attr("value",o.getHours()).on("change",function(){!0===at(this)&&y()}),h.append("input").attr("type","number").attr("id","min").attr("title","Minutes").attr("max","60").attr("min","-1").attr("step","1").attr("value",o.getMinutes()).on("change",function(){!0===at(this)&&y()}),h.append("input").attr("type","number").attr("id","sec").attr("title","Seconds").attr("max","60").attr("min","-1").attr("step","1").attr("value",o.getSeconds()).on("change",function(){!0===at(this)&&y()}),function(){var t=h.append("select").attr("title","Time zone offset from UTC").attr("id","tz").on("change",y),n=15,e=-o.getTimezoneOffset();t.selectAll("option").data(s).enter().append("option").attr("value",function(t,r){var a=Object.keys(t)[0];return t[a]===e&&(n=r),t[a]}).text(function(t){return Object.keys(t)[0]}),t.property("selectedIndex",n)}(),this.show=function(t,n){var r=ct("celestial-date"),a=ct("datepick"),i=a.offsetLeft+a.offsetWidth-r.offsetWidth,s=a.offsetTop-r.offsetHeight-1;-9999===r.offsetTop?(o.setTime(t.valueOf()),v("tz",n),M(),d3.select(e+" ~ #celestial-form").select("#celestial-date").style({top:H(s),left:H(i),opacity:1}),d3.select(e+" ~ #celestial-form").select("#datepick").classed("active",!0)):m()},this.isVisible=function(){return!!document.getElementById("datepick")&&!0===d3.select(e+" ~ #celestial-form").select("#datepick").classed("active")},this.hide=function(){m()}};!function(){var t=Math.PI/180,n=180/Math.PI;function e(t,n,e){var r=t.translate(),a=Math.atan2(n[1]-r[1],n[0]-r[0])-Math.atan2(e[1]-r[1],e[0]-r[0]);return[Math.cos(a/2),0,0,Math.sin(a/2)]}function r(t,n){var e=t.invert(n);return e&&isFinite(e[0])&&isFinite(e[1])&&u(e)}function a(n){var e=.5*n[0]*t,r=.5*n[1]*t,a=.5*n[2]*t,i=Math.sin(e),o=Math.cos(e),s=Math.sin(r),l=Math.cos(r),u=Math.sin(a),c=Math.cos(a);return[o*l*c+i*s*u,i*l*c-o*s*u,o*s*c+i*l*u,o*l*u-i*s*c]}function i(t,n){var e=t[0],r=t[1],a=t[2],i=t[3],o=n[0],s=n[1],l=n[2],u=n[3];return[e*o-r*s-a*l-i*u,e*s+r*o+a*u-i*l,e*l-r*u+a*o+i*s,e*u+r*l-a*s+i*o]}function o(t,n){if(t&&n){var e=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}(t,n),r=Math.sqrt(c(e,e)),a=.5*Math.acos(Math.max(-1,Math.min(1,c(t,n)))),i=Math.sin(a)/r;return r&&[Math.cos(a),e[2]*i,-e[1]*i,e[0]*i]}}function s(t,n){var e=Math.max(-1,Math.min(1,c(t,n))),r=e<0?-1:1,a=Math.acos(r*e),i=Math.sin(a);return i?function(e){var o=r*Math.sin((1-e)*a)/i,s=Math.sin(e*a)/i;return[t[0]*o+n[0]*s,t[1]*o+n[1]*s,t[2]*o+n[2]*s,t[3]*o+n[3]*s]}:function(){return t}}function l(t){return[Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),1-2*(t[1]*t[1]+t[2]*t[2]))*n,Math.asin(Math.max(-1,Math.min(1,2*(t[0]*t[2]-t[3]*t[1]))))*n,Math.atan2(2*(t[0]*t[3]+t[1]*t[2]),1-2*(t[2]*t[2]+t[3]*t[3]))*n]}function u(n){var e=n[0]*t,r=n[1]*t,a=Math.cos(r);return[a*Math.cos(e),a*Math.sin(e),Math.sin(r)]}function c(t,n){for(var e=0,r=t.length,a=0;e<r;++e)a+=t[e]*n[e];return a}d3.geo.zoom=function(){var t,n,c,h=0,f=function(t){for(var n=0,e=arguments.length,r=[];++n<e;)r.push(arguments[n]);var a=d3.dispatch.apply(null,r);return a.of=function(n,e){return function(r){try{var i=r.sourceEvent=d3.event;r.target=t,d3.event=r,a[r.type].apply(n,e)}finally{d3.event=i}}},a}(p,"zoomstart","zoom","zoomend"),p=d3.behavior.zoom().on("zoomstart",function(){var n=d3.mouse(this),s=a(t.rotate()),u=r(t,n);u&&(c=u),d.call(p,"zoom",function(){t.scale(g.k=d3.event.scale);var a=d3.mouse(this),u=o(c,r(t,a));t.rotate(g.r=l(s=u?i(s,u):i(e(t,n,a),s))),n=a,M(f.of(this,arguments))}),v(f.of(this,arguments))}).on("zoomend",function(){d.call(p,"zoom",null),m(f.of(this,arguments))}),d=p.on,g={r:[0,0,0],k:1};function v(t){h++||t({type:"zoomstart"})}function M(t){t({type:"zoom"})}function m(t){--h||t({type:"zoomend"})}return p.rotateTo=function(t){var n=o(u(t),u([-g.r[0],-g.r[1]]));return l(i(a(g.r),n))},p.projection=function(n){return arguments.length?(g={r:(t=n).rotate(),k:t.scale()},p.scale(g.k)):t},p.duration=function(t){return arguments.length?(n=t,p):n},p.event=function(e){e.each(function(){var e=d3.select(this),r=f.of(this,arguments),i=g,o=d3.transition(e);if(o!==e){o.each("start.zoom",function(){this.__chart__&&((g=this.__chart__).hasOwnProperty("r")||(g.r=t.rotate())),t.rotate(g.r).scale(g.k),v(r)}).tween("zoom:zoom",function(){var e=p.size()[0],u=s(a(g.r),a(i.r)),c=d3.geo.distance(g.r,i.r),h=d3.interpolateZoom([0,0,e/g.k],[c,0,e/i.k]);return n&&o.duration(n(.001*h.duration)),function(n){var a=h(n);this.__chart__=g={r:l(u(a[0]/c)),k:e/a[2]},t.rotate(g.r).scale(g.k),p.scale(g.k),M(r)}}).each("end.zoom",function(){m(r)});try{o.each("interrupt.zoom",function(){m(r)})}catch(u){console.log(u)}}else this.__chart__=g,v(r),M(r),m(r)})},d3.rebind(p,f,"on")}}(),xt=function(t){"use strict";var n=[].slice,e={};function r(t){this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function a(t){if(!t._start)try{!function(t){for(;t._start=t._waiting&&t._active<t._size;){var n=t._ended+t._active,r=t._tasks[n],a=r.length-1,o=r[a];r[a]=i(t,n),--t._waiting,++t._active,r=o.apply(null,r),t._tasks[n]&&(t._tasks[n]=r||e)}}(t)}catch(n){if(t._tasks[t._ended+t._active-1])o(t,n);else if(!t._data)throw n}}function i(t,n){return function(e,r){t._tasks[n]&&(--t._active,++t._ended,t._tasks[n]=null,null==t._error&&(null!=e?o(t,e):(t._data[n]=r,t._waiting?a(t):s(t))))}}function o(t,n){var e,r=t._tasks.length;for(t._error=n,t._data=void 0,t._waiting=NaN;--r>=0;)if((e=t._tasks[r])&&(t._tasks[r]=null,e.abort))try{e.abort()}catch(n){}t._active=NaN,s(t)}function s(t){if(!t._active&&t._call){var n=t._data;t._data=void 0,t._call(t._error,n)}}function l(t){if(null==t)t=1/0;else if(!((t=+t)>=1))throw new Error("invalid concurrency");return new r(t)}r.prototype=l.prototype={constructor:r,defer:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var e=n.call(arguments,1);return e.push(t),++this._waiting,this._tasks.push(e),a(this),this},abort:function(){return null==this._error&&o(this,new Error("abort")),this},await:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(n,e){t.apply(null,[n].concat(e))},s(this),this},awaitAll:function(t){if("function"!=typeof t)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=t,s(this),this}},t.queue=l,d3.queue=l,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?xt(exports):"function"==typeof define&&define.amd?define(["exports"],xt):xt(this.d3=this.d3||{}),this.Celestial=s}(),function(){var t={version:"3.5.17"},n=[].slice,e=function(t){return n.call(t)},r=this.document;function a(t){return t&&(t.ownerDocument||t.document||t).documentElement}function i(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(r)try{e(r.documentElement.childNodes)}catch(sl){e=function(t){for(var n=t.length,e=new Array(n);n--;)e[n]=t[n];return e}}if(Date.now||(Date.now=function(){return+new Date}),r)try{r.createElement("DIV").style.setProperty("opacity",0,"")}catch(ll){var o=this.Element.prototype,s=o.setAttribute,l=o.setAttributeNS,u=this.CSSStyleDeclaration.prototype,c=u.setProperty;o.setAttribute=function(t,n){s.call(this,t,n+"")},o.setAttributeNS=function(t,n,e){l.call(this,t,n,e+"")},u.setProperty=function(t,n,e){c.call(this,t,n+"",e)}}function h(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function f(t){return null===t?NaN:+t}function p(t){return!isNaN(t)}function d(t){return{left:function(n,e,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=n.length);r<a;){var i=r+a>>>1;t(n[i],e)<0?r=i+1:a=i}return r},right:function(n,e,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=n.length);r<a;){var i=r+a>>>1;t(n[i],e)>0?a=i:r=i+1}return r}}}t.ascending=h,t.descending=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},t.min=function(t,n){var e,r,a=-1,i=t.length;if(1===arguments.length){for(;++a<i;)if(null!=(r=t[a])&&r>=r){e=r;break}for(;++a<i;)null!=(r=t[a])&&e>r&&(e=r)}else{for(;++a<i;)if(null!=(r=n.call(t,t[a],a))&&r>=r){e=r;break}for(;++a<i;)null!=(r=n.call(t,t[a],a))&&e>r&&(e=r)}return e},t.max=function(t,n){var e,r,a=-1,i=t.length;if(1===arguments.length){for(;++a<i;)if(null!=(r=t[a])&&r>=r){e=r;break}for(;++a<i;)null!=(r=t[a])&&r>e&&(e=r)}else{for(;++a<i;)if(null!=(r=n.call(t,t[a],a))&&r>=r){e=r;break}for(;++a<i;)null!=(r=n.call(t,t[a],a))&&r>e&&(e=r)}return e},t.extent=function(t,n){var e,r,a,i=-1,o=t.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=t[i])&&r>=r){e=a=r;break}for(;++i<o;)null!=(r=t[i])&&(e>r&&(e=r),a<r&&(a=r))}else{for(;++i<o;)if(null!=(r=n.call(t,t[i],i))&&r>=r){e=a=r;break}for(;++i<o;)null!=(r=n.call(t,t[i],i))&&(e>r&&(e=r),a<r&&(a=r))}return[e,a]},t.sum=function(t,n){var e,r=0,a=t.length,i=-1;if(1===arguments.length)for(;++i<a;)p(e=+t[i])&&(r+=e);else for(;++i<a;)p(e=+n.call(t,t[i],i))&&(r+=e);return r},t.mean=function(t,n){var e,r=0,a=t.length,i=-1,o=a;if(1===arguments.length)for(;++i<a;)p(e=f(t[i]))?r+=e:--o;else for(;++i<a;)p(e=f(n.call(t,t[i],i)))?r+=e:--o;if(o)return r/o},t.quantile=function(t,n){var e=(t.length-1)*n+1,r=Math.floor(e),a=+t[r-1],i=e-r;return i?a+i*(t[r]-a):a},t.median=function(n,e){var r,a=[],i=n.length,o=-1;if(1===arguments.length)for(;++o<i;)p(r=f(n[o]))&&a.push(r);else for(;++o<i;)p(r=f(e.call(n,n[o],o)))&&a.push(r);if(a.length)return t.quantile(a.sort(h),.5)},t.variance=function(t,n){var e,r,a=t.length,i=0,o=0,s=-1,l=0;if(1===arguments.length)for(;++s<a;)p(e=f(t[s]))&&(o+=(r=e-i)*(e-(i+=r/++l)));else for(;++s<a;)p(e=f(n.call(t,t[s],s)))&&(o+=(r=e-i)*(e-(i+=r/++l)));if(l>1)return o/(l-1)},t.deviation=function(){var n=t.variance.apply(this,arguments);return n?Math.sqrt(n):n};var g=d(h);function v(t){return t.length}t.bisectLeft=g.left,t.bisect=t.bisectRight=g.right,t.bisector=function(t){return d(1===t.length?function(n,e){return h(t(n),e)}:t)},t.shuffle=function(t,n,e){(i=arguments.length)<3&&(e=t.length,i<2&&(n=0));for(var r,a,i=e-n;i;)a=Math.random()*i--|0,r=t[i+n],t[i+n]=t[a+n],t[a+n]=r;return t},t.permute=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},t.pairs=function(t){for(var n=0,e=t.length-1,r=t[0],a=new Array(e<0?0:e);n<e;)a[n]=[r,r=t[++n]];return a},t.transpose=function(n){if(!(i=n.length))return[];for(var e=-1,r=t.min(n,v),a=new Array(r);++e<r;)for(var i,o=-1,s=a[e]=new Array(i);++o<i;)s[o]=n[o][e];return a},t.zip=function(){return t.transpose(arguments)},t.keys=function(t){var n=[];for(var e in t)n.push(e);return n},t.values=function(t){var n=[];for(var e in t)n.push(t[e]);return n},t.entries=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n},t.merge=function(t){for(var n,e,r,a=t.length,i=-1,o=0;++i<a;)o+=t[i].length;for(e=new Array(o);--a>=0;)for(n=(r=t[a]).length;--n>=0;)e[--o]=r[n];return e};var M=Math.abs;function m(t){for(var n=1;t*n%1;)n*=10;return n}function y(t,n){for(var e in n)Object.defineProperty(t.prototype,e,{value:n[e],enumerable:!1})}function b(){this._=Object.create(null)}function w(t){return"__proto__"==(t+="")||"\0"===t[0]?"\0"+t:t}function x(t){return"\0"===(t+="")[0]?t.slice(1):t}function k(t){return w(t)in this._}function S(t){return(t=w(t))in this._&&delete this._[t]}function _(){var t=[];for(var n in this._)t.push(x(n));return t}function q(){var t=0;for(var n in this._)++t;return t}function T(){for(var t in this._)return!1;return!0}function z(){this._=Object.create(null)}function E(t){return t}function A(t,n,e){return function(){var r=e.apply(n,arguments);return r===n?t:r}}function N(t,n){if(n in t)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(var e=0,r=j.length;e<r;++e){var a=j[e]+n;if(a in t)return a}}t.range=function(t,n,e){if(arguments.length<3&&(e=1,arguments.length<2&&(n=t,t=0)),(n-t)/e==1/0)throw new Error("infinite range");var r,a=[],i=m(M(e)),o=-1;if(t*=i,n*=i,(e*=i)<0)for(;(r=t+e*++o)>n;)a.push(r/i);else for(;(r=t+e*++o)<n;)a.push(r/i);return a},t.map=function(t,n){var e=new b;if(t instanceof b)t.forEach(function(t,n){e.set(t,n)});else if(Array.isArray(t)){var r,a=-1,i=t.length;if(1===arguments.length)for(;++a<i;)e.set(a,t[a]);else for(;++a<i;)e.set(n.call(t,r=t[a],a),r)}else for(var o in t)e.set(o,t[o]);return e},y(b,{has:k,get:function(t){return this._[w(t)]},set:function(t,n){return this._[w(t)]=n},remove:S,keys:_,values:function(){var t=[];for(var n in this._)t.push(this._[n]);return t},entries:function(){var t=[];for(var n in this._)t.push({key:x(n),value:this._[n]});return t},size:q,empty:T,forEach:function(t){for(var n in this._)t.call(this,x(n),this._[n])}}),t.nest=function(){var n,e,r={},a=[],i=[];function o(t,i,s){if(s>=a.length)return e?e.call(r,i):n?i.sort(n):i;for(var l,u,c,h,f=-1,p=i.length,d=a[s++],g=new b;++f<p;)(h=g.get(l=d(u=i[f])))?h.push(u):g.set(l,[u]);return t?(u=t(),c=function(n,e){u.set(n,o(t,e,s))}):(u={},c=function(n,e){u[n]=o(t,e,s)}),g.forEach(c),u}function s(t,n){if(n>=a.length)return t;var e=[],r=i[n++];return t.forEach(function(t,r){e.push({key:t,values:s(r,n)})}),r?e.sort(function(t,n){return r(t.key,n.key)}):e}return r.map=function(t,n){return o(n,t,0)},r.entries=function(n){return s(o(t.map,n,0),0)},r.key=function(t){return a.push(t),r},r.sortKeys=function(t){return i[a.length-1]=t,r},r.sortValues=function(t){return n=t,r},r.rollup=function(t){return e=t,r},r},t.set=function(t){var n=new z;if(t)for(var e=0,r=t.length;e<r;++e)n.add(t[e]);return n},y(z,{has:k,add:function(t){return this._[w(t+="")]=!0,t},remove:S,values:_,size:q,empty:T,forEach:function(t){for(var n in this._)t.call(this,x(n))}}),t.behavior={},t.rebind=function(t,n){for(var e,r=1,a=arguments.length;++r<a;)t[e=arguments[r]]=A(t,n,n[e]);return t};var j=["webkit","ms","moz","Moz","o","O"];function L(){}function P(){}function C(t){var n=[],e=new b;function r(){for(var e,r=n,a=-1,i=r.length;++a<i;)(e=r[a].on)&&e.apply(this,arguments);return t}return r.on=function(r,a){var i,o=e.get(r);return arguments.length<2?o&&o.on:(o&&(o.on=null,n=n.slice(0,i=n.indexOf(o)).concat(n.slice(i+1)),e.remove(r)),a&&n.push(e.set(r,{on:a})),t)},r}function D(){t.event.preventDefault()}function I(){for(var n,e=t.event;n=e.sourceEvent;)e=n;return e}function R(n){for(var e=new P,r=0,a=arguments.length;++r<a;)e[arguments[r]]=C(e);return e.of=function(r,a){return function(i){try{var o=i.sourceEvent=t.event;i.target=n,t.event=i,e[i.type].apply(r,a)}finally{t.event=o}}},e}t.dispatch=function(){for(var t=new P,n=-1,e=arguments.length;++n<e;)t[arguments[n]]=C(t);return t},P.prototype.on=function(t,n){var e=t.indexOf("."),r="";if(e>=0&&(r=t.slice(e+1),t=t.slice(0,e)),t)return arguments.length<2?this[t].on(r):this[t].on(r,n);if(2===arguments.length){if(null==n)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},t.event=null,t.requote=function(t){return t.replace(F,"\\$&")};var F=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,O={}.__proto__?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)t[e]=n[e]};function U(t){return O(t,V),t}var H=function(t,n){return n.querySelector(t)},B=function(t,n){return n.querySelectorAll(t)},Q=function(t,n){var e=t.matches||t[N(t,"matchesSelector")];return(Q=function(t,n){return e.call(t,n)})(t,n)};"function"==typeof Sizzle&&(H=function(t,n){return Sizzle(t,n)[0]||null},B=Sizzle,Q=Sizzle.matchesSelector),t.selection=function(){return t.select(r.documentElement)};var V=t.selection.prototype=[];function G(t){return"function"==typeof t?t:function(){return H(t,this)}}function Y(t){return"function"==typeof t?t:function(){return B(t,this)}}V.select=function(t){var n,e,r,a,i=[];t=G(t);for(var o=-1,s=this.length;++o<s;){i.push(n=[]),n.parentNode=(r=this[o]).parentNode;for(var l=-1,u=r.length;++l<u;)(a=r[l])?(n.push(e=t.call(a,a.__data__,l,o)),e&&"__data__"in a&&(e.__data__=a.__data__)):n.push(null)}return U(i)},V.selectAll=function(t){var n,r,a=[];t=Y(t);for(var i=-1,o=this.length;++i<o;)for(var s=this[i],l=-1,u=s.length;++l<u;)(r=s[l])&&(a.push(n=e(t.call(r,r.__data__,l,i))),n.parentNode=r);return U(a)};var W="http://www.w3.org/1999/xhtml",$={svg:"http://www.w3.org/2000/svg",xhtml:W,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Z(n,e){return n=t.ns.qualify(n),null==e?n.local?function(){this.removeAttributeNS(n.space,n.local)}:function(){this.removeAttribute(n)}:"function"==typeof e?n.local?function(){var t=e.apply(this,arguments);null==t?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}:function(){var t=e.apply(this,arguments);null==t?this.removeAttribute(n):this.setAttribute(n,t)}:n.local?function(){this.setAttributeNS(n.space,n.local,e)}:function(){this.setAttribute(n,e)}}function X(t){return t.trim().replace(/\s+/g," ")}function J(n){return new RegExp("(?:^|\\s+)"+t.requote(n)+"(?:\\s+|$)","g")}function K(t){return(t+"").trim().split(/^|\s+/)}function tt(t,n){var e=(t=K(t).map(nt)).length;return"function"==typeof n?function(){for(var r=-1,a=n.apply(this,arguments);++r<e;)t[r](this,a)}:function(){for(var r=-1;++r<e;)t[r](this,n)}}function nt(t){var n=J(t);return function(e,r){if(a=e.classList)return r?a.add(t):a.remove(t);var a=e.getAttribute("class")||"";r?(n.lastIndex=0,n.test(a)||e.setAttribute("class",X(a+" "+t))):e.setAttribute("class",X(a.replace(n," ")))}}function et(t,n,e){return null==n?function(){this.style.removeProperty(t)}:"function"==typeof n?function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}:function(){this.style.setProperty(t,n,e)}}function rt(t,n){return null==n?function(){delete this[t]}:"function"==typeof n?function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}:function(){this[t]=n}}function at(n){return"function"==typeof n?n:(n=t.ns.qualify(n)).local?function(){return this.ownerDocument.createElementNS(n.space,n.local)}:function(){var t=this.ownerDocument,e=this.namespaceURI;return e===W&&t.documentElement.namespaceURI===W?t.createElement(n):t.createElementNS(e,n)}}function it(){var t=this.parentNode;t&&t.removeChild(this)}function ot(t){return{__data__:t}}function st(t){return function(){return Q(this,t)}}function lt(t){return arguments.length||(t=h),function(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}}function ut(t,n){for(var e=0,r=t.length;e<r;e++)for(var a,i=t[e],o=0,s=i.length;o<s;o++)(a=i[o])&&n(a,o,e);return t}function ct(t){return O(t,ht),t}t.ns={prefix:$,qualify:function(t){var n=t.indexOf(":"),e=t;return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),$.hasOwnProperty(e)?{space:$[e],local:t}:t}},V.attr=function(n,e){if(arguments.length<2){if("string"==typeof n){var r=this.node();return(n=t.ns.qualify(n)).local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}for(e in n)this.each(Z(e,n[e]));return this}return this.each(Z(n,e))},V.classed=function(t,n){if(arguments.length<2){if("string"==typeof t){var e=this.node(),r=(t=K(t)).length,a=-1;if(n=e.classList){for(;++a<r;)if(!n.contains(t[a]))return!1}else for(n=e.getAttribute("class");++a<r;)if(!J(t[a]).test(n))return!1;return!0}for(n in t)this.each(tt(n,t[n]));return this}return this.each(tt(t,n))},V.style=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=""),t)this.each(et(e,t[e],n));return this}if(r<2){var a=this.node();return i(a).getComputedStyle(a,null).getPropertyValue(t)}e=""}return this.each(et(t,n,e))},V.property=function(t,n){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(n in t)this.each(rt(n,t[n]));return this}return this.each(rt(t,n))},V.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},V.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},V.append=function(t){return t=at(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},V.insert=function(t,n){return t=at(t),n=G(n),this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})},V.remove=function(){return this.each(it)},V.data=function(t,n){var e,r,a=-1,i=this.length;if(!arguments.length){for(t=new Array(i=(e=this[0]).length);++a<i;)(r=e[a])&&(t[a]=r.__data__);return t}function o(t,e){var r,a,i,o=t.length,c=e.length,h=Math.min(o,c),f=new Array(c),p=new Array(c),d=new Array(o);if(n){var g,v=new b,M=new Array(o);for(r=-1;++r<o;)(a=t[r])&&(v.has(g=n.call(a,a.__data__,r))?d[r]=a:v.set(g,a),M[r]=g);for(r=-1;++r<c;)(a=v.get(g=n.call(e,i=e[r],r)))?!0!==a&&(f[r]=a,a.__data__=i):p[r]=ot(i),v.set(g,!0);for(r=-1;++r<o;)r in M&&!0!==v.get(M[r])&&(d[r]=t[r])}else{for(r=-1;++r<h;)i=e[r],(a=t[r])?(a.__data__=i,f[r]=a):p[r]=ot(i);for(;r<c;++r)p[r]=ot(e[r]);for(;r<o;++r)d[r]=t[r]}p.update=f,p.parentNode=f.parentNode=d.parentNode=t.parentNode,s.push(p),l.push(f),u.push(d)}var s=ct([]),l=U([]),u=U([]);if("function"==typeof t)for(;++a<i;)o(e=this[a],t.call(e,e.parentNode.__data__,a));else for(;++a<i;)o(e=this[a],t);return l.enter=function(){return s},l.exit=function(){return u},l},V.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},V.filter=function(t){var n,e,r,a=[];"function"!=typeof t&&(t=st(t));for(var i=0,o=this.length;i<o;i++){a.push(n=[]),n.parentNode=(e=this[i]).parentNode;for(var s=0,l=e.length;s<l;s++)(r=e[s])&&t.call(r,r.__data__,s,i)&&n.push(r)}return U(a)},V.order=function(){for(var t=-1,n=this.length;++t<n;)for(var e,r=this[t],a=r.length-1,i=r[a];--a>=0;)(e=r[a])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e);return this},V.sort=function(t){t=lt.apply(this,arguments);for(var n=-1,e=this.length;++n<e;)this[n].sort(t);return this.order()},V.each=function(t){return ut(this,function(n,e,r){t.call(n,n.__data__,e,r)})},V.call=function(t){var n=e(arguments);return t.apply(n[0]=this,n),this},V.empty=function(){return!this.node()},V.node=function(){for(var t=0,n=this.length;t<n;t++)for(var e=this[t],r=0,a=e.length;r<a;r++){var i=e[r];if(i)return i}return null},V.size=function(){var t=0;return ut(this,function(){++t}),t};var ht=[];function ft(t){var n,e;return function(r,a,i){var o,s=t[i].update,l=s.length;for(i!=e&&(e=i,n=0),a>=n&&(n=a+1);!(o=s[n])&&++n<l;);return o}}function pt(n,r,a){var i="__on"+n,o=n.indexOf("."),s=gt;o>0&&(n=n.slice(0,o));var l=dt.get(n);function u(){var t=this[i];t&&(this.removeEventListener(n,t,t.$),delete this[i])}return l&&(n=l,s=vt),o?r?function(){var t=s(r,e(arguments));u.call(this),this.addEventListener(n,this[i]=t,t.$=a),t._=r}:u:r?L:function(){var e,r=new RegExp("^__on([^.]+)"+t.requote(n)+"$");for(var a in this)if(e=a.match(r)){var i=this[a];this.removeEventListener(e[1],i,i.$),delete this[a]}}}t.selection.enter=ct,t.selection.enter.prototype=ht,ht.append=V.append,ht.empty=V.empty,ht.node=V.node,ht.call=V.call,ht.size=V.size,ht.select=function(t){for(var n,e,r,a,i,o=[],s=-1,l=this.length;++s<l;){r=(a=this[s]).update,o.push(n=[]),n.parentNode=a.parentNode;for(var u=-1,c=a.length;++u<c;)(i=a[u])?(n.push(r[u]=e=t.call(a.parentNode,i.__data__,u,s)),e.__data__=i.__data__):n.push(null)}return U(o)},ht.insert=function(t,n){return arguments.length<2&&(n=ft(this)),V.insert.call(this,t,n)},t.select=function(t){var n;return"string"==typeof t?(n=[H(t,r)]).parentNode=r.documentElement:(n=[t]).parentNode=a(t),U([n])},t.selectAll=function(t){var n;return"string"==typeof t?(n=e(B(t,r))).parentNode=r.documentElement:(n=e(t)).parentNode=null,U([n])},V.on=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=!1),t)this.each(pt(e,t[e],n));return this}if(r<2)return(r=this.node()["__on"+t])&&r._;e=!1}return this.each(pt(t,n,e))};var dt=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});function gt(n,e){return function(r){var a=t.event;t.event=r,e[0]=this.__data__;try{n.apply(this,e)}finally{t.event=a}}}function vt(t,n){var e=gt(t,n);return function(t){var n=this,r=t.relatedTarget;r&&(r===n||8&r.compareDocumentPosition(n))||e.call(n,t)}}r&&dt.forEach(function(t){"on"+t in r&&dt.remove(t)});var Mt,mt=0;function yt(n){var e=".dragsuppress-"+ ++mt,r="click"+e,o=t.select(i(n)).on("touchmove"+e,D).on("dragstart"+e,D).on("selectstart"+e,D);if(null==Mt&&(Mt=!("onselectstart"in n)&&N(n.style,"userSelect")),Mt){var s=a(n).style,l=s[Mt];s[Mt]="none"}return function(t){if(o.on(e,null),Mt&&(s[Mt]=l),t){var n=function(){o.on(r,null)};o.on(r,function(){D(),n()},!0),setTimeout(n,0)}}}t.mouse=function(t){return wt(t,I())};var bt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function wt(n,e){e.changedTouches&&(e=e.changedTouches[0]);var r=n.ownerSVGElement||n;if(r.createSVGPoint){var a=r.createSVGPoint();if(bt<0){var o=i(n);if(o.scrollX||o.scrollY){var s=(r=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();bt=!(s.f||s.e),r.remove()}}return bt?(a.x=e.pageX,a.y=e.pageY):(a.x=e.clientX,a.y=e.clientY),[(a=a.matrixTransform(n.getScreenCTM().inverse())).x,a.y]}var l=n.getBoundingClientRect();return[e.clientX-l.left-n.clientLeft,e.clientY-l.top-n.clientTop]}function xt(){return t.event.changedTouches[0].identifier}t.touch=function(t,n,e){if(arguments.length<3&&(e=n,n=I().changedTouches),n)for(var r,a=0,i=n.length;a<i;++a)if((r=n[a]).identifier===e)return wt(t,r)},t.behavior.drag=function(){var n=R(o,"drag","dragstart","dragend"),e=null,r=s(L,t.mouse,i,"mousemove","mouseup"),a=s(xt,t.touch,E,"touchmove","touchend");function o(){this.on("mousedown.drag",r).on("touchstart.drag",a)}function s(r,a,i,o,s){return function(){var l,u=this,c=t.event.target.correspondingElement||t.event.target,h=u.parentNode,f=n.of(u,arguments),p=0,d=r(),g=".drag"+(null==d?"":"-"+d),v=t.select(i(c)).on(o+g,y).on(s+g,b),M=yt(c),m=a(h,d);function y(){var t,n,e=a(h,d);e&&(p|=(t=e[0]-m[0])|(n=e[1]-m[1]),m=e,f({type:"drag",x:e[0]+l[0],y:e[1]+l[1],dx:t,dy:n}))}function b(){a(h,d)&&(v.on(o+g,null).on(s+g,null),M(p),f({type:"dragend"}))}l=e?[(l=e.apply(u,arguments)).x-m[0],l.y-m[1]]:[0,0],f({type:"dragstart"})}}return o.origin=function(t){return arguments.length?(e=t,o):e},t.rebind(o,n,"on")},t.touches=function(t,n){return arguments.length<2&&(n=I().touches),n?e(n).map(function(n){var e=wt(t,n);return e.identifier=n.identifier,e}):[]};var kt=1e-6,St=kt*kt,_t=Math.PI,qt=2*_t,Tt=qt-kt,zt=_t/2,Et=_t/180,At=180/_t;function Nt(t){return t>0?1:t<0?-1:0}function jt(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])}function Lt(t){return t>1?0:t<-1?_t:Math.acos(t)}function Pt(t){return t>1?zt:t<-1?-zt:Math.asin(t)}function Ct(t){return((t=Math.exp(t))+1/t)/2}function Dt(t){return(t=Math.sin(t/2))*t}var It=Math.SQRT2;t.interpolateZoom=function(t,n){var e,r,a=t[0],i=t[1],o=t[2],s=n[2],l=n[0]-a,u=n[1]-i,c=l*l+u*u;if(c<St)r=Math.log(s/o)/It,e=function(t){return[a+t*l,i+t*u,o*Math.exp(It*t*r)]};else{var h=Math.sqrt(c),f=(s*s-o*o+4*c)/(2*o*2*h),p=(s*s-o*o-4*c)/(2*s*2*h),d=Math.log(Math.sqrt(f*f+1)-f),g=Math.log(Math.sqrt(p*p+1)-p);r=(g-d)/It,e=function(t){var n,e=t*r,s=Ct(d),c=o/(2*h)*(s*(n=It*e+d,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(d));return[a+c*l,i+c*u,o*s/Ct(It*e+d)]}}return e.duration=1e3*r,e},t.behavior.zoom=function(){var n,e,a,o,s,l,u,c,h,f={x:0,y:0,k:1},p=[960,500],d=Ot,g=250,v=0,M="mousedown.zoom",m="mousemove.zoom",y="mouseup.zoom",b="touchstart.zoom",w=R(x,"zoomstart","zoom","zoomend");function x(t){t.on(M,N).on(Ft+".zoom",L).on("dblclick.zoom",P).on(b,j)}function k(t){return[(t[0]-f.x)/f.k,(t[1]-f.y)/f.k]}function S(t){f.k=Math.max(d[0],Math.min(d[1],t))}function _(t,n){n=function(t){return[t[0]*f.k+f.x,t[1]*f.k+f.y]}(n),f.x+=t[0]-n[0],f.y+=t[1]-n[1]}function q(n,r,a,i){n.__chart__={x:f.x,y:f.y,k:f.k},S(Math.pow(2,i)),_(e=r,a),n=t.select(n),g>0&&(n=n.transition().duration(g)),n.call(x.event)}function T(){u&&u.domain(l.range().map(function(t){return(t-f.x)/f.k}).map(l.invert)),h&&h.domain(c.range().map(function(t){return(t-f.y)/f.k}).map(c.invert))}function z(t){v++||t({type:"zoomstart"})}function E(t){T(),t({type:"zoom",scale:f.k,translate:[f.x,f.y]})}function A(t){--v||(t({type:"zoomend"}),e=null)}function N(){var n=this,e=w.of(n,arguments),r=0,a=t.select(i(n)).on(m,l).on(y,u),o=k(t.mouse(n)),s=yt(n);function l(){r=1,_(t.mouse(n),o),E(e)}function u(){a.on(m,null).on(y,null),s(r),A(e)}As.call(n),z(e)}function j(){var n,e=this,r=w.of(e,arguments),a={},i=0,o=".zoom-"+t.event.changedTouches[0].identifier,l="touchmove"+o,u="touchend"+o,c=[],h=t.select(e),p=yt(e);function d(){var r=t.touches(e);return n=f.k,r.forEach(function(t){t.identifier in a&&(a[t.identifier]=k(t))}),r}function g(){var n=t.event.target;t.select(n).on(l,v).on(u,m),c.push(n);for(var r=t.event.changedTouches,o=0,h=r.length;o<h;++o)a[r[o].identifier]=null;var p=d(),g=Date.now();if(1===p.length)g-s<500&&(q(e,M=p[0],a[M.identifier],Math.floor(Math.log(f.k)/Math.LN2)+1),D()),s=g;else if(p.length>1){var M,y=p[1],b=(M=p[0])[0]-y[0],w=M[1]-y[1];i=b*b+w*w}}function v(){var o,l,u,c,h=t.touches(e);As.call(e);for(var f=0,p=h.length;f<p;++f,c=null)if(c=a[(u=h[f]).identifier]){if(l)break;o=u,l=c}if(c){var d=(d=u[0]-o[0])*d+(d=u[1]-o[1])*d,g=i&&Math.sqrt(d/i);o=[(o[0]+u[0])/2,(o[1]+u[1])/2],l=[(l[0]+c[0])/2,(l[1]+c[1])/2],S(g*n)}s=null,_(o,l),E(r)}function m(){if(t.event.touches.length){for(var n=t.event.changedTouches,e=0,i=n.length;e<i;++e)delete a[n[e].identifier];for(var s in a)return void d()}t.selectAll(c).on(o,null),h.on(M,N).on(b,j),p(),A(r)}g(),z(r),h.on(M,null).on(b,g)}function L(){var r=w.of(this,arguments);o?clearTimeout(o):(As.call(this),n=k(e=a||t.mouse(this)),z(r)),o=setTimeout(function(){o=null,A(r)},50),D(),S(Math.pow(2,.002*Rt())*f.k),_(e,n),E(r)}function P(){}return Ft||(Ft="onwheel"in r?(Rt=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in r?(Rt=function(){return t.event.wheelDelta},"mousewheel"):(Rt=function(){return-t.event.detail},"MozMousePixelScroll")),x.event=function(n){n.each(function(){var n=w.of(this,arguments),r=f;Ls?t.select(this).transition().each("start.zoom",function(){f=this.__chart__||{x:0,y:0,k:1},z(n)}).tween("zoom:zoom",function(){var a=p[0],i=e?e[0]:a/2,o=e?e[1]:p[1]/2,s=t.interpolateZoom([(i-f.x)/f.k,(o-f.y)/f.k,a/f.k],[(i-r.x)/r.k,(o-r.y)/r.k,a/r.k]);return function(t){var e=s(t),r=a/e[2];this.__chart__=f={x:i-e[0]*r,y:o-e[1]*r,k:r},E(n)}}).each("interrupt.zoom",function(){A(n)}).each("end.zoom",function(){A(n)}):(this.__chart__=f,z(n),E(n),A(n))})},x.translate=function(t){return arguments.length?(f={x:+t[0],y:+t[1],k:f.k},T(),x):[f.x,f.y]},x.scale=function(t){return arguments.length?(f={x:f.x,y:f.y,k:null},S(+t),T(),x):f.k},x.scaleExtent=function(t){return arguments.length?(d=null==t?Ot:[+t[0],+t[1]],x):d},x.center=function(t){return arguments.length?(a=t&&[+t[0],+t[1]],x):a},x.size=function(t){return arguments.length?(p=t&&[+t[0],+t[1]],x):p},x.duration=function(t){return arguments.length?(g=+t,x):g},x.x=function(t){return arguments.length?(u=t,l=t.copy(),f={x:0,y:0,k:1},x):u},x.y=function(t){return arguments.length?(h=t,c=t.copy(),f={x:0,y:0,k:1},x):h},t.rebind(x,w,"on")};var Rt,Ft,Ot=[0,1/0];function Ut(){}function Ht(t,n,e){return this instanceof Ht?(this.h=+t,this.s=+n,void(this.l=+e)):arguments.length<2?t instanceof Ht?new Ht(t.h,t.s,t.l):cn(""+t,hn,Ht):new Ht(t,n,e)}t.color=Ut,Ut.prototype.toString=function(){return this.rgb()+""},t.hsl=Ht;var Bt=Ht.prototype=new Ut;function Qt(t,n,e){var r,a;function i(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?r+(a-r)*t/60:t<180?a:t<240?r+(a-r)*(240-t)/60:r}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,n=isNaN(n)||n<0?0:n>1?1:n,r=2*(e=e<0?0:e>1?1:e)-(a=e<=.5?e*(1+n):e+n-e*n),new an(i(t+120),i(t),i(t-120))}function Vt(n,e,r){return this instanceof Vt?(this.h=+n,this.c=+e,void(this.l=+r)):arguments.length<2?n instanceof Vt?new Vt(n.h,n.c,n.l):tn(n instanceof Wt?n.l:(n=fn((n=t.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new Vt(n,e,r)}Bt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Ht(this.h,this.s,this.l/t)},Bt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Ht(this.h,this.s,t*this.l)},Bt.rgb=function(){return Qt(this.h,this.s,this.l)},t.hcl=Vt;var Gt=Vt.prototype=new Ut;function Yt(t,n,e){return isNaN(t)&&(t=0),isNaN(n)&&(n=0),new Wt(e,Math.cos(t*=Et)*n,Math.sin(t)*n)}function Wt(t,n,e){return this instanceof Wt?(this.l=+t,this.a=+n,void(this.b=+e)):arguments.length<2?t instanceof Wt?new Wt(t.l,t.a,t.b):t instanceof Vt?Yt(t.h,t.c,t.l):fn((t=an(t)).r,t.g,t.b):new Wt(t,n,e)}Gt.brighter=function(t){return new Vt(this.h,this.c,Math.min(100,this.l+$t*(arguments.length?t:1)))},Gt.darker=function(t){return new Vt(this.h,this.c,Math.max(0,this.l-$t*(arguments.length?t:1)))},Gt.rgb=function(){return Yt(this.h,this.c,this.l).rgb()},t.lab=Wt;var $t=18,Zt=.95047,Xt=1.08883,Jt=Wt.prototype=new Ut;function Kt(t,n,e){var r=(t+16)/116,a=r+n/500,i=r-e/200;return new an(rn(3.2404542*(a=nn(a)*Zt)-1.5371385*(r=1*nn(r))-.4985314*(i=nn(i)*Xt)),rn(-.969266*a+1.8760108*r+.041556*i),rn(.0556434*a-.2040259*r+1.0572252*i))}function tn(t,n,e){return t>0?new Vt(Math.atan2(e,n)*At,Math.sqrt(n*n+e*e),t):new Vt(NaN,NaN,t)}function nn(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function en(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function rn(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function an(t,n,e){return this instanceof an?(this.r=~~t,this.g=~~n,void(this.b=~~e)):arguments.length<2?t instanceof an?new an(t.r,t.g,t.b):cn(""+t,an,Qt):new an(t,n,e)}function on(t){return new an(t>>16,t>>8&255,255&t)}function sn(t){return on(t)+""}Jt.brighter=function(t){return new Wt(Math.min(100,this.l+$t*(arguments.length?t:1)),this.a,this.b)},Jt.darker=function(t){return new Wt(Math.max(0,this.l-$t*(arguments.length?t:1)),this.a,this.b)},Jt.rgb=function(){return Kt(this.l,this.a,this.b)},t.rgb=an;var ln=an.prototype=new Ut;function un(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function cn(t,n,e){var r,a,i,o=0,s=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(a=r[2].split(","),r[1]){case"hsl":return e(parseFloat(a[0]),parseFloat(a[1])/100,parseFloat(a[2])/100);case"rgb":return n(dn(a[0]),dn(a[1]),dn(a[2]))}return(i=gn.get(t))?n(i.r,i.g,i.b):(null==t||"#"!==t.charAt(0)||isNaN(i=parseInt(t.slice(1),16))||(4===t.length?(o=(3840&i)>>4,o|=o>>4,s=240&i,s|=s>>4,l=15&i,l|=l<<4):7===t.length&&(o=(16711680&i)>>16,s=(65280&i)>>8,l=255&i)),n(o,s,l))}function hn(t,n,e){var r,a,i=Math.min(t/=255,n/=255,e/=255),o=Math.max(t,n,e),s=o-i,l=(o+i)/2;return s?(a=l<.5?s/(o+i):s/(2-o-i),r=t==o?(n-e)/s+(n<e?6:0):n==o?(e-t)/s+2:(t-n)/s+4,r*=60):(r=NaN,a=l>0&&l<1?0:r),new Ht(r,a,l)}function fn(t,n,e){var r=en((.4124564*(t=pn(t))+.3575761*(n=pn(n))+.1804375*(e=pn(e)))/Zt),a=en((.2126729*t+.7151522*n+.072175*e)/1);return Wt(116*a-16,500*(r-a),200*(a-en((.0193339*t+.119192*n+.9503041*e)/Xt)))}function pn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function dn(t){var n=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*n):n}ln.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var n=this.r,e=this.g,r=this.b,a=30;return n||e||r?(n&&n<a&&(n=a),e&&e<a&&(e=a),r&&r<a&&(r=a),new an(Math.min(255,n/t),Math.min(255,e/t),Math.min(255,r/t))):new an(a,a,a)},ln.darker=function(t){return new an((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},ln.hsl=function(){return hn(this.r,this.g,this.b)},ln.toString=function(){return"#"+un(this.r)+un(this.g)+un(this.b)};var gn=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function vn(t){return"function"==typeof t?t:function(){return t}}function Mn(t){return function(n,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),mn(n,e,t,r)}}function mn(n,r,a,i){var o={},s=t.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;function h(){var t,n=u.status;if(!n&&function(t){var n=t.responseType;return n&&"text"!==n?t.response:t.responseText}(u)||n>=200&&n<300||304===n){try{t=a.call(o,u)}catch(sl){return void s.error.call(o,sl)}s.load.call(o,t)}else s.error.call(o,u)}return this.XDomainRequest&&!("withCredentials"in u)&&/^(http(s)?:)?\/\//.test(n)&&(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=h:u.onreadystatechange=function(){u.readyState>3&&h()},u.onprogress=function(n){var e=t.event;t.event=n;try{s.progress.call(o,u)}finally{t.event=e}},o.header=function(t,n){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==n?delete l[t]:l[t]=n+"",o)},o.mimeType=function(t){return arguments.length?(r=null==t?null:t+"",o):r},o.responseType=function(t){return arguments.length?(c=t,o):c},o.response=function(t){return a=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(e(arguments)))}}),o.send=function(t,e,a){if(2===arguments.length&&"function"==typeof e&&(a=e,e=null),u.open(t,n,!0),null==r||"accept"in l||(l.accept=r+",*/*"),u.setRequestHeader)for(var i in l)u.setRequestHeader(i,l[i]);return null!=r&&u.overrideMimeType&&u.overrideMimeType(r),null!=c&&(u.responseType=c),null!=a&&o.on("error",a).on("load",function(t){a(null,t)}),s.beforesend.call(o,u),u.send(null==e?null:e),o},o.abort=function(){return u.abort(),o},t.rebind(o,s,"on"),null==i?o:o.get(function(t){return 1===t.length?function(n,e){t(null==n?e:null)}:t}(i))}gn.forEach(function(t,n){gn.set(t,on(n))}),t.functor=vn,t.xhr=Mn(E),t.dsv=function(t,n){var e=new RegExp('["'+t+"\n]"),r=t.charCodeAt(0);function a(t,e,r){arguments.length<3&&(r=e,e=null);var a=mn(t,n,null==e?i:o(e),r);return a.row=function(t){return arguments.length?a.response(null==(e=t)?i:o(t)):e},a}function i(t){return a.parse(t.responseText)}function o(t){return function(n){return a.parse(n.responseText,t)}}function s(n){return n.map(l).join(t)}function l(t){return e.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return a.parse=function(t,n){var e;return a.parseRows(t,function(t,r){if(e)return e(t,r-1);var a=new Function("d","return {"+t.map(function(t,n){return JSON.stringify(t)+": d["+n+"]"}).join(",")+"}");e=n?function(t,e){return n(a(t),e)}:a})},a.parseRows=function(t,n){var e,a,i={},o={},s=[],l=t.length,u=0,c=0;function h(){if(u>=l)return o;if(a)return a=!1,i;var n=u;if(34===t.charCodeAt(n)){for(var e=n;e++<l;)if(34===t.charCodeAt(e)){if(34!==t.charCodeAt(e+1))break;++e}return u=e+2,13===(s=t.charCodeAt(e+1))?(a=!0,10===t.charCodeAt(e+2)&&++u):10===s&&(a=!0),t.slice(n+1,e).replace(/""/g,'"')}for(;u<l;){var s,c=1;if(10===(s=t.charCodeAt(u++)))a=!0;else if(13===s)a=!0,10===t.charCodeAt(u)&&(++u,++c);else if(s!==r)continue;return t.slice(n,u-c)}return t.slice(n)}for(;(e=h())!==o;){for(var f=[];e!==i&&e!==o;)f.push(e),e=h();n&&null==(f=n(f,c++))||s.push(f)}return s},a.format=function(n){if(Array.isArray(n[0]))return a.formatRows(n);var e=new z,r=[];return n.forEach(function(t){for(var n in t)e.has(n)||r.push(e.add(n))}),[r.map(l).join(t)].concat(n.map(function(n){return r.map(function(t){return l(n[t])}).join(t)})).join("\n")},a.formatRows=function(t){return t.map(s).join("\n")},a},t.csv=t.dsv(",","text/csv"),t.tsv=t.dsv("\t","text/tab-separated-values");var yn,bn,wn,xn,kn=this[N(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function Sn(t,n,e){var r=arguments.length;r<2&&(n=0),r<3&&(e=Date.now());var a=e+n,i={c:t,t:a,n:null};return bn?bn.n=i:yn=i,bn=i,wn||(xn=clearTimeout(xn),wn=1,kn(_n)),i}function _n(){var t=qn(),n=Tn()-t;n>24?(isFinite(n)&&(clearTimeout(xn),xn=setTimeout(_n,n)),wn=0):(wn=1,kn(_n))}function qn(){for(var t=Date.now(),n=yn;n;)t>=n.t&&n.c(t-n.t)&&(n.c=null),n=n.n;return t}function Tn(){for(var t,n=yn,e=1/0;n;)n.c?(n.t<e&&(e=n.t),n=(t=n).n):n=t?t.n=n.n:yn=n.n;return bn=t,e}function zn(t,n){return n-(t?Math.ceil(Math.log(t)/Math.LN10):1)}t.timer=function(){Sn.apply(this,arguments)},t.timer.flush=function(){qn(),Tn()},t.round=function(t,n){return n?Math.round(t*(n=Math.pow(10,n)))/n:Math.round(t)};var En=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(function(t,n){var e=Math.pow(10,3*M(8-n));return{scale:n>8?function(t){return t/e}:function(t){return t*e},symbol:t}});function An(n){var e=n.decimal,r=n.thousands,a=n.grouping,i=n.currency,o=a&&r?function(t,n){for(var e=t.length,i=[],o=0,s=a[0],l=0;e>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),i.push(t.substring(e-=s,e+s)),!((l+=s+1)>n));)s=a[o=(o+1)%a.length];return i.reverse().join(r)}:E;return function(n){var r=Nn.exec(n),a=r[1]||" ",s=r[2]||">",l=r[3]||"-",u=r[4]||"",c=r[5],h=+r[6],f=r[7],p=r[8],d=r[9],g=1,v="",M="",m=!1,y=!0;switch(p&&(p=+p.substring(1)),(c||"0"===a&&"="===s)&&(c=a="0",s="="),d){case"n":f=!0,d="g";break;case"%":g=100,M="%",d="f";break;case"p":g=100,M="%",d="r";break;case"b":case"o":case"x":case"X":"#"===u&&(v="0"+d.toLowerCase());case"c":y=!1;case"d":m=!0,p=0;break;case"s":g=-1,d="r"}"$"===u&&(v=i[0],M=i[1]),"r"!=d||p||(d="g"),null!=p&&("g"==d?p=Math.max(1,Math.min(21,p)):"e"!=d&&"f"!=d||(p=Math.max(0,Math.min(20,p)))),d=jn.get(d)||Ln;var b=c&&f;return function(n){var r=M;if(m&&n%1)return"";var i=n<0||0===n&&1/n<0?(n=-n,"-"):"-"===l?"":l;if(g<0){var u=t.formatPrefix(n,p);n=u.scale(n),r=u.symbol+M}else n*=g;var w,x,k=(n=d(n,p)).lastIndexOf(".");if(k<0){var S=y?n.lastIndexOf("e"):-1;S<0?(w=n,x=""):(w=n.substring(0,S),x=n.substring(S))}else w=n.substring(0,k),x=e+n.substring(k+1);!c&&f&&(w=o(w,1/0));var _=v.length+w.length+x.length+(b?0:i.length),q=_<h?new Array(_=h-_+1).join(a):"";return b&&(w=o(q+w,q.length?h-x.length:1/0)),i+=v,n=w+x,("<"===s?i+n+q:">"===s?q+i+n:"^"===s?q.substring(0,_>>=1)+i+n+q.substring(_):i+(b?n:q+n))+r}}}t.formatPrefix=function(n,e){var r=0;return(n=+n)&&(n<0&&(n*=-1),e&&(n=t.round(n,zn(n,e))),r=1+Math.floor(1e-12+Math.log(n)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((r-1)/3)))),En[8+r/3]};var Nn=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,jn=t.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,n){return t.toPrecision(n)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},r:function(n,e){return(n=t.round(n,zn(n,e))).toFixed(Math.max(0,Math.min(20,zn(n*(1+1e-15),e))))}});function Ln(t){return t+""}var Pn=t.time={},Cn=Date;function Dn(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Dn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){In.setUTCDate.apply(this._,arguments)},setDay:function(){In.setUTCDay.apply(this._,arguments)},setFullYear:function(){In.setUTCFullYear.apply(this._,arguments)},setHours:function(){In.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){In.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){In.setUTCMinutes.apply(this._,arguments)},setMonth:function(){In.setUTCMonth.apply(this._,arguments)},setSeconds:function(){In.setUTCSeconds.apply(this._,arguments)},setTime:function(){In.setTime.apply(this._,arguments)}};var In=Date.prototype;function Rn(t,n,e){function r(n){var e=t(n),r=i(e,1);return n-e<r-n?e:r}function a(e){return n(e=t(new Cn(e-1)),1),e}function i(t,e){return n(t=new Cn(+t),e),t}function o(t,r,i){var o=a(t),s=[];if(i>1)for(;o<r;)e(o)%i||s.push(new Date(+o)),n(o,1);else for(;o<r;)s.push(new Date(+o)),n(o,1);return s}t.floor=t,t.round=r,t.ceil=a,t.offset=i,t.range=o;var s=t.utc=Fn(t);return s.floor=s,s.round=Fn(r),s.ceil=Fn(a),s.offset=Fn(i),s.range=function(t,n,e){try{Cn=Dn;var r=new Dn;return r._=t,o(r,n,e)}finally{Cn=Date}},t}function Fn(t){return function(n,e){try{Cn=Dn;var r=new Dn;return r._=n,t(r,e)._}finally{Cn=Date}}}function On(n){var e=n.dateTime,r=n.date,a=n.time,i=n.periods,o=n.days,s=n.shortDays,l=n.months,u=n.shortMonths;function c(t){var n=t.length;function e(e){for(var r,a,i,o=[],s=-1,l=0;++s<n;)37===t.charCodeAt(s)&&(o.push(t.slice(l,s)),null!=(a=Un[r=t.charAt(++s)])&&(r=t.charAt(++s)),(i=w[r])&&(r=i(e,null==a?"e"===r?" ":"0":a)),o.push(r),l=s+1);return o.push(t.slice(l,s)),o.join("")}return e.parse=function(n){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(h(e,t,n,0)!=n.length)return null;"p"in e&&(e.H=e.H%12+12*e.p);var r=null!=e.Z&&Cn!==Dn,a=new(r?Dn:Cn);return"j"in e?a.setFullYear(e.y,0,e.j):"W"in e||"U"in e?("w"in e||(e.w="W"in e?1:0),a.setFullYear(e.y,0,1),a.setFullYear(e.y,0,"W"in e?(e.w+6)%7+7*e.W-(a.getDay()+5)%7:e.w+7*e.U-(a.getDay()+6)%7)):a.setFullYear(e.y,e.m,e.d),a.setHours(e.H+(e.Z/100|0),e.M+e.Z%100,e.S,e.L),r?a._:a},e.toString=function(){return t},e}function h(t,n,e,r){for(var a,i,o,s=0,l=n.length,u=e.length;s<l;){if(r>=u)return-1;if(37===(a=n.charCodeAt(s++))){if(o=n.charAt(s++),!(i=x[o in Un?n.charAt(s++):o])||(r=i(t,e,r))<0)return-1}else if(a!=e.charCodeAt(r++))return-1}return r}c.utc=function(t){var n=c(t);function e(t){try{var e=new(Cn=Dn);return e._=t,n(e)}finally{Cn=Date}}return e.parse=function(t){try{Cn=Dn;var e=n.parse(t);return e&&e._}finally{Cn=Date}},e.toString=n.toString,e},c.multi=c.utc.multi=le;var f=t.map(),p=Vn(o),d=Gn(o),g=Vn(s),v=Gn(s),M=Vn(l),m=Gn(l),y=Vn(u),b=Gn(u);i.forEach(function(t,n){f.set(t.toLowerCase(),n)});var w={a:function(t){return s[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:c(e),d:function(t,n){return Qn(t.getDate(),n,2)},e:function(t,n){return Qn(t.getDate(),n,2)},H:function(t,n){return Qn(t.getHours(),n,2)},I:function(t,n){return Qn(t.getHours()%12||12,n,2)},j:function(t,n){return Qn(1+Pn.dayOfYear(t),n,3)},L:function(t,n){return Qn(t.getMilliseconds(),n,3)},m:function(t,n){return Qn(t.getMonth()+1,n,2)},M:function(t,n){return Qn(t.getMinutes(),n,2)},p:function(t){return i[+(t.getHours()>=12)]},S:function(t,n){return Qn(t.getSeconds(),n,2)},U:function(t,n){return Qn(Pn.sundayOfYear(t),n,2)},w:function(t){return t.getDay()},W:function(t,n){return Qn(Pn.mondayOfYear(t),n,2)},x:c(r),X:c(a),y:function(t,n){return Qn(t.getFullYear()%100,n,2)},Y:function(t,n){return Qn(t.getFullYear()%1e4,n,4)},Z:oe,"%":function(){return"%"}},x={a:function(t,n,e){g.lastIndex=0;var r=g.exec(n.slice(e));return r?(t.w=v.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(t,n,e){p.lastIndex=0;var r=p.exec(n.slice(e));return r?(t.w=d.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(t,n,e){y.lastIndex=0;var r=y.exec(n.slice(e));return r?(t.m=b.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(t,n,e){M.lastIndex=0;var r=M.exec(n.slice(e));return r?(t.m=m.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(t,n,e){return h(t,w.c.toString(),n,e)},d:te,e:te,H:ee,I:ee,j:ne,L:ie,m:Kn,M:re,p:function(t,n,e){var r=f.get(n.slice(e,e+=2).toLowerCase());return null==r?-1:(t.p=r,e)},S:ae,U:Wn,w:Yn,W:$n,x:function(t,n,e){return h(t,w.x.toString(),n,e)},X:function(t,n,e){return h(t,w.X.toString(),n,e)},y:Xn,Y:Zn,Z:Jn,"%":se};return c}Pn.year=Rn(function(t){return(t=Pn.day(t)).setMonth(0,1),t},function(t,n){t.setFullYear(t.getFullYear()+n)},function(t){return t.getFullYear()}),Pn.years=Pn.year.range,Pn.years.utc=Pn.year.utc.range,Pn.day=Rn(function(t){var n=new Cn(2e3,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n},function(t,n){t.setDate(t.getDate()+n)},function(t){return t.getDate()-1}),Pn.days=Pn.day.range,Pn.days.utc=Pn.day.utc.range,Pn.dayOfYear=function(t){var n=Pn.year(t);return Math.floor((t-n-6e4*(t.getTimezoneOffset()-n.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,n){n=7-n;var e=Pn[t]=Rn(function(t){return(t=Pn.day(t)).setDate(t.getDate()-(t.getDay()+n)%7),t},function(t,n){t.setDate(t.getDate()+7*Math.floor(n))},function(t){var e=Pn.year(t).getDay();return Math.floor((Pn.dayOfYear(t)+(e+n)%7)/7)-(e!==n)});Pn[t+"s"]=e.range,Pn[t+"s"].utc=e.utc.range,Pn[t+"OfYear"]=function(t){var e=Pn.year(t).getDay();return Math.floor((Pn.dayOfYear(t)+(e+n)%7)/7)}}),Pn.week=Pn.sunday,Pn.weeks=Pn.sunday.range,Pn.weeks.utc=Pn.sunday.utc.range,Pn.weekOfYear=Pn.sundayOfYear;var Un={"-":"",_:" ",0:"0"},Hn=/^\s*\d+/,Bn=/^%/;function Qn(t,n,e){var r=t<0?"-":"",a=(r?-t:t)+"",i=a.length;return r+(i<e?new Array(e-i+1).join(n)+a:a)}function Vn(n){return new RegExp("^(?:"+n.map(t.requote).join("|")+")","i")}function Gn(t){for(var n=new b,e=-1,r=t.length;++e<r;)n.set(t[e].toLowerCase(),e);return n}function Yn(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function Wn(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e));return r?(t.U=+r[0],e+r[0].length):-1}function $n(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e));return r?(t.W=+r[0],e+r[0].length):-1}function Zn(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function Xn(t,n,e){Hn.lastIndex=0;var r,a=Hn.exec(n.slice(e,e+2));return a?(t.y=(r=+a[0])+(r>68?1900:2e3),e+a[0].length):-1}function Jn(t,n,e){return/^[+-]\d{4}$/.test(n=n.slice(e,e+5))?(t.Z=-n,e+5):-1}function Kn(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function te(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function ne(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+3));return r?(t.j=+r[0],e+r[0].length):-1}function ee(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function re(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function ae(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function ie(t,n,e){Hn.lastIndex=0;var r=Hn.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function oe(t){var n=t.getTimezoneOffset(),e=n>0?"-":"+",r=M(n)/60|0,a=M(n)%60;return e+Qn(r,"0",2)+Qn(a,"0",2)}function se(t,n,e){Bn.lastIndex=0;var r=Bn.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function le(t){for(var n=t.length,e=-1;++e<n;)t[e][0]=this(t[e][0]);return function(n){for(var e=0,r=t[e];!r[1](n);)r=t[++e];return r[0](n)}}t.locale=function(t){return{numberFormat:An(t),timeFormat:On(t)}};var ue=t.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ce(){}t.format=ue.numberFormat,t.geo={},ce.prototype={s:0,t:0,add:function(t){fe(t,this.t,he),fe(he.s,this.s,this),this.s?this.t+=he.t:this.s=he.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var he=new ce;function fe(t,n,e){var r=e.s=t+n,a=r-t;e.t=t-(r-a)+(n-a)}function pe(t,n){t&&ge.hasOwnProperty(t.type)&&ge[t.type](t,n)}t.geo.stream=function(t,n){t&&de.hasOwnProperty(t.type)?de[t.type](t,n):pe(t,n)};var de={Feature:function(t,n){pe(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,a=e.length;++r<a;)pe(e[r].geometry,n)}},ge={Sphere:function(t,n){n.sphere()},Point:function(t,n){n.point((t=t.coordinates)[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,a=e.length;++r<a;)n.point((t=e[r])[0],t[1],t[2])},LineString:function(t,n){ve(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,a=e.length;++r<a;)ve(e[r],n,0)},Polygon:function(t,n){Me(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,a=e.length;++r<a;)Me(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,a=e.length;++r<a;)pe(e[r],n)}};function ve(t,n,e){var r,a=-1,i=t.length-e;for(n.lineStart();++a<i;)n.point((r=t[a])[0],r[1],r[2]);n.lineEnd()}function Me(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)ve(t[e],n,1);n.polygonEnd()}t.geo.area=function(n){return me=0,t.geo.stream(n,Ne),me};var me,ye,be,we,xe,ke,Se,_e,qe,Te,ze,Ee,Ae=new ce,Ne={sphere:function(){me+=4*_t},point:L,lineStart:L,lineEnd:L,polygonStart:function(){Ae.reset(),Ne.lineStart=je},polygonEnd:function(){var t=2*Ae;me+=t<0?4*_t+t:t,Ne.lineStart=Ne.lineEnd=Ne.point=L}};function je(){var t,n,e,r,a;function i(t,n){n=n*Et/2+_t/4;var i=(t*=Et)-e,o=i>=0?1:-1,s=o*i,l=Math.cos(n),u=Math.sin(n),c=a*u,h=r*l+c*Math.cos(s),f=c*o*Math.sin(s);Ae.add(Math.atan2(f,h)),e=t,r=l,a=u}Ne.point=function(o,s){Ne.point=i,e=(t=o)*Et,r=Math.cos(s=(n=s)*Et/2+_t/4),a=Math.sin(s)},Ne.lineEnd=function(){i(t,n)}}function Le(t){var n=t[0],e=t[1],r=Math.cos(e);return[r*Math.cos(n),r*Math.sin(n),Math.sin(e)]}function Pe(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Ce(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function De(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Ie(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function Re(t){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function Fe(t){return[Math.atan2(t[1],t[0]),Pt(t[2])]}function Oe(t,n){return M(t[0]-n[0])<kt&&M(t[1]-n[1])<kt}t.geo.bounds=function(){var n,e,r,a,i,o,s,l,u,c,h,f={point:p,lineStart:g,lineEnd:v,polygonStart:function(){f.point=m,f.lineStart=y,f.lineEnd=b,u=0,Ne.polygonStart()},polygonEnd:function(){Ne.polygonEnd(),f.point=p,f.lineStart=g,f.lineEnd=v,Ae<0?(n=-(r=180),e=-(a=90)):u>kt?a=90:u<-kt&&(e=-90),h[0]=n,h[1]=r}};function p(t,i){c.push(h=[n=t,r=t]),i<e&&(e=i),i>a&&(a=i)}function d(t,o){var s=Le([t*Et,o*Et]);if(l){var u=Ce(l,s),c=Ce([u[1],-u[0],0],u);Re(c),c=Fe(c);var h=t-i,f=h>0?1:-1,d=c[0]*At*f,g=M(h)>180;if(g^(f*i<d&&d<f*t))(v=c[1]*At)>a&&(a=v);else if(g^(f*i<(d=(d+360)%360-180)&&d<f*t)){var v;(v=-c[1]*At)<e&&(e=v)}else o<e&&(e=o),o>a&&(a=o);g?t<i?w(n,t)>w(n,r)&&(r=t):w(t,r)>w(n,r)&&(n=t):r>=n?(t<n&&(n=t),t>r&&(r=t)):t>i?w(n,t)>w(n,r)&&(r=t):w(t,r)>w(n,r)&&(n=t)}else p(t,o);l=s,i=t}function g(){f.point=d}function v(){h[0]=n,h[1]=r,f.point=p,l=null}function m(t,n){if(l){var e=t-i;u+=M(e)>180?e+(e>0?360:-360):e}else o=t,s=n;Ne.point(t,n),d(t,n)}function y(){Ne.lineStart()}function b(){m(o,s),Ne.lineEnd(),M(u)>kt&&(n=-(r=180)),h[0]=n,h[1]=r,l=null}function w(t,n){return(n-=t)<0?n+360:n}function x(t,n){return t[0]-n[0]}function k(t,n){return n[0]<=n[1]?n[0]<=t&&t<=n[1]:t<n[0]||n[1]<t}return function(i){if(a=r=-(n=e=1/0),c=[],t.geo.stream(i,f),u=c.length){c.sort(x);for(var o=1,s=[g=c[0]];o<u;++o)k((p=c[o])[0],g)||k(p[1],g)?(w(g[0],p[1])>w(g[0],g[1])&&(g[1]=p[1]),w(p[0],g[1])>w(g[0],g[1])&&(g[0]=p[0])):s.push(g=p);for(var l,u,p,d=-1/0,g=(o=0,s[u=s.length-1]);o<=u;g=p,++o)(l=w(g[1],(p=s[o])[0]))>d&&(d=l,n=p[0],r=g[1])}return c=h=null,n===1/0||e===1/0?[[NaN,NaN],[NaN,NaN]]:[[n,e],[r,a]]}}(),t.geo.centroid=function(n){ye=be=we=xe=ke=Se=_e=qe=Te=ze=Ee=0,t.geo.stream(n,Ue);var e=Te,r=ze,a=Ee,i=e*e+r*r+a*a;return i<St&&(e=Se,r=_e,a=qe,be<kt&&(e=we,r=xe,a=ke),(i=e*e+r*r+a*a)<St)?[NaN,NaN]:[Math.atan2(r,e)*At,Pt(a/Math.sqrt(i))*At]};var Ue={sphere:L,point:He,lineStart:Qe,lineEnd:Ve,polygonStart:function(){Ue.lineStart=Ge},polygonEnd:function(){Ue.lineStart=Qe}};function He(t,n){t*=Et;var e=Math.cos(n*=Et);Be(e*Math.cos(t),e*Math.sin(t),Math.sin(n))}function Be(t,n,e){++ye,we+=(t-we)/ye,xe+=(n-xe)/ye,ke+=(e-ke)/ye}function Qe(){var t,n,e;function r(r,a){r*=Et;var i=Math.cos(a*=Et),o=i*Math.cos(r),s=i*Math.sin(r),l=Math.sin(a),u=Math.atan2(Math.sqrt((u=n*l-e*s)*u+(u=e*o-t*l)*u+(u=t*s-n*o)*u),t*o+n*s+e*l);be+=u,Se+=u*(t+(t=o)),_e+=u*(n+(n=s)),qe+=u*(e+(e=l)),Be(t,n,e)}Ue.point=function(a,i){a*=Et;var o=Math.cos(i*=Et);t=o*Math.cos(a),n=o*Math.sin(a),e=Math.sin(i),Ue.point=r,Be(t,n,e)}}function Ve(){Ue.point=He}function Ge(){var t,n,e,r,a;function i(t,n){t*=Et;var i=Math.cos(n*=Et),o=i*Math.cos(t),s=i*Math.sin(t),l=Math.sin(n),u=r*l-a*s,c=a*o-e*l,h=e*s-r*o,f=Math.sqrt(u*u+c*c+h*h),p=e*o+r*s+a*l,d=f&&-Lt(p)/f,g=Math.atan2(f,p);Te+=d*u,ze+=d*c,Ee+=d*h,be+=g,Se+=g*(e+(e=o)),_e+=g*(r+(r=s)),qe+=g*(a+(a=l)),Be(e,r,a)}Ue.point=function(o,s){t=o,n=s,Ue.point=i,o*=Et;var l=Math.cos(s*=Et);e=l*Math.cos(o),r=l*Math.sin(o),a=Math.sin(s),Be(e,r,a)},Ue.lineEnd=function(){i(t,n),Ue.lineEnd=Ve,Ue.point=He}}function Ye(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function We(){return!0}function $e(t,n,e,r,a){var i=[],o=[];if(t.forEach(function(t){if(!((n=t.length-1)<=0)){var n,e=t[0],r=t[n];if(Oe(e,r)){a.lineStart();for(var s=0;s<n;++s)a.point((e=t[s])[0],e[1]);a.lineEnd()}else{var l=new Xe(e,t,null,!0),u=new Xe(e,null,l,!1);l.o=u,i.push(l),o.push(u),l=new Xe(r,t,null,!1),u=new Xe(r,null,l,!0),l.o=u,i.push(l),o.push(u)}}}),o.sort(n),Ze(i),Ze(o),i.length){for(var s=0,l=e,u=o.length;s<u;++s)o[s].e=l=!l;for(var c,h,f=i[0];;){for(var p=f,d=!0;p.v;)if((p=p.n)===f)return;c=p.z,a.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(s=0,u=c.length;s<u;++s)a.point((h=c[s])[0],h[1]);else r(p.x,p.n.x,1,a);p=p.n}else{if(d)for(s=(c=p.p.z).length-1;s>=0;--s)a.point((h=c[s])[0],h[1]);else r(p.x,p.p.x,-1,a);p=p.p}c=(p=p.o).z,d=!d}while(!p.v);a.lineEnd()}}}function Ze(t){if(n=t.length){for(var n,e,r=0,a=t[0];++r<n;)a.n=e=t[r],e.p=a,a=e;a.n=e=t[0],e.p=a}}function Xe(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Je(n,e,r,a){return function(i,o){var s,l=e(o),u=i.invert(a[0],a[1]),c={point:h,lineStart:p,lineEnd:d,polygonStart:function(){c.point=b,c.lineStart=w,c.lineEnd=x,s=[],g=[]},polygonEnd:function(){c.point=h,c.lineStart=p,c.lineEnd=d,s=t.merge(s);var n=function(t,n){var e=t[0],r=t[1],a=[Math.sin(e),-Math.cos(e),0],i=0,o=0;Ae.reset();for(var s=0,l=n.length;s<l;++s){var u=n[s],c=u.length;if(c)for(var h=u[0],f=h[0],p=h[1]/2+_t/4,d=Math.sin(p),g=Math.cos(p),v=1;;){v===c&&(v=0);var M=(t=u[v])[0],m=t[1]/2+_t/4,y=Math.sin(m),b=Math.cos(m),w=M-f,x=w>=0?1:-1,k=x*w,S=k>_t,_=d*y;if(Ae.add(Math.atan2(_*x*Math.sin(k),g*b+_*Math.cos(k))),i+=S?w+x*qt:w,S^f>=e^M>=e){var q=Ce(Le(h),Le(t));Re(q);var T=Ce(a,q);Re(T);var z=(S^w>=0?-1:1)*Pt(T[2]);(r>z||r===z&&(q[0]||q[1]))&&(o+=S^w>=0?1:-1)}if(!v++)break;f=M,d=y,g=b,h=t}}return(i<-kt||i<kt&&Ae<-kt)^1&o}(u,g);s.length?(y||(o.polygonStart(),y=!0),$e(s,nr,n,r,o)):n&&(y||(o.polygonStart(),y=!0),o.lineStart(),r(null,null,1,o),o.lineEnd()),y&&(o.polygonEnd(),y=!1),s=g=null},sphere:function(){o.polygonStart(),o.lineStart(),r(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function h(t,e){var r=i(t,e);n(t=r[0],e=r[1])&&o.point(t,e)}function f(t,n){var e=i(t,n);l.point(e[0],e[1])}function p(){c.point=f,l.lineStart()}function d(){c.point=h,l.lineEnd()}var g,v,M=tr(),m=e(M),y=!1;function b(t,n){v.push([t,n]);var e=i(t,n);m.point(e[0],e[1])}function w(){m.lineStart(),v=[]}function x(){b(v[0][0],v[0][1]),m.lineEnd();var t,n=m.clean(),e=M.buffer(),r=e.length;if(v.pop(),g.push(v),v=null,r)if(1&n){var a,i=-1;if((r=(t=e[0]).length-1)>0){for(y||(o.polygonStart(),y=!0),o.lineStart();++i<r;)o.point((a=t[i])[0],a[1]);o.lineEnd()}}else r>1&&2&n&&e.push(e.pop().concat(e.shift())),s.push(e.filter(Ke))}return c}}function Ke(t){return t.length>1}function tr(){var t,n=[];return{lineStart:function(){n.push(t=[])},point:function(n,e){t.push([n,e])},lineEnd:L,buffer:function(){var e=n;return n=[],t=null,e},rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))}}}function nr(t,n){return((t=t.x)[0]<0?t[1]-zt-kt:zt-t[1])-((n=n.x)[0]<0?n[1]-zt-kt:zt-n[1])}var er=Je(We,function(t){var n,e=NaN,r=NaN,a=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(i,o){var s=i>0?_t:-_t,l=M(i-e);M(l-_t)<kt?(t.point(e,r=(r+o)/2>0?zt:-zt),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(i,r),n=0):a!==s&&l>=_t&&(M(e-a)<kt&&(e-=a*kt),M(i-s)<kt&&(i-=s*kt),r=function(t,n,e,r){var a,i,o=Math.sin(t-e);return M(o)>kt?Math.atan((Math.sin(n)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(a=Math.cos(n))*Math.sin(t))/(a*i*o)):(n+r)/2}(e,r,i,o),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(s,r),n=0),t.point(e=i,r=o),a=s},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}},function(t,n,e,r){var a;if(null==t)r.point(-_t,a=e*zt),r.point(0,a),r.point(_t,a),r.point(_t,0),r.point(_t,-a),r.point(0,-a),r.point(-_t,-a),r.point(-_t,0),r.point(-_t,a);else if(M(t[0]-n[0])>kt){var i=t[0]<n[0]?_t:-_t;r.point(-i,a=e*i/2),r.point(0,a),r.point(i,a)}else r.point(n[0],n[1])},[-_t,-_t/2]);function rr(t){var n=Math.cos(t),e=n>0,r=M(n)>kt;return Je(a,function(t){var n,s,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,f){var p,d=[h,f],g=a(h,f),v=e?g?0:o(h,f):g?o(h+(h<0?_t:-_t),f):0;if(!n&&(u=l=g)&&t.lineStart(),g!==l&&(p=i(n,d),(Oe(n,p)||Oe(d,p))&&(d[0]+=kt,d[1]+=kt,g=a(d[0],d[1]))),g!==l)c=0,g?(t.lineStart(),p=i(d,n),t.point(p[0],p[1])):(p=i(n,d),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(r&&n&&e^g){var M;v&s||!(M=i(d,n,!0))||(c=0,e?(t.lineStart(),t.point(M[0][0],M[0][1]),t.point(M[1][0],M[1][1]),t.lineEnd()):(t.point(M[1][0],M[1][1]),t.lineEnd(),t.lineStart(),t.point(M[0][0],M[0][1])))}!g||n&&Oe(n,d)||t.point(d[0],d[1]),n=d,l=g,s=v},lineEnd:function(){l&&t.lineEnd(),n=null},clean:function(){return c|(u&&l)<<1}}},Or(t,6*Et),e?[0,-t]:[-_t,t-_t]);function a(t,e){return Math.cos(t)*Math.cos(e)>n}function i(t,e,r){var a=[1,0,0],i=Ce(Le(t),Le(e)),o=Pe(i,i),s=i[0],l=o-s*s;if(!l)return!r&&t;var u=n*o/l,c=-n*s/l,h=Ce(a,i),f=Ie(a,u);De(f,Ie(i,c));var p=h,d=Pe(f,p),g=Pe(p,p),v=d*d-g*(Pe(f,f)-1);if(!(v<0)){var m=Math.sqrt(v),y=Ie(p,(-d-m)/g);if(De(y,f),y=Fe(y),!r)return y;var b,w=t[0],x=e[0],k=t[1],S=e[1];x<w&&(b=w,w=x,x=b);var _=x-w,q=M(_-_t)<kt;if(!q&&S<k&&(b=k,k=S,S=b),q||_<kt?q?k+S>0^y[1]<(M(y[0]-w)<kt?k:S):k<=y[1]&&y[1]<=S:_>_t^(w<=y[0]&&y[0]<=x)){var T=Ie(p,(-d+m)/g);return De(T,f),[y,Fe(T)]}}}function o(n,r){var a=e?t:_t-t,i=0;return n<-a?i|=1:n>a&&(i|=2),r<-a?i|=4:r>a&&(i|=8),i}}function ar(t,n,e,r){return function(a){var i,o=a.a,s=a.b,l=o.x,u=o.y,c=0,h=1,f=s.x-l,p=s.y-u;if(i=t-l,f||!(i>0)){if(i/=f,f<0){if(i<c)return;i<h&&(h=i)}else if(f>0){if(i>h)return;i>c&&(c=i)}if(i=e-l,f||!(i<0)){if(i/=f,f<0){if(i>h)return;i>c&&(c=i)}else if(f>0){if(i<c)return;i<h&&(h=i)}if(i=n-u,p||!(i>0)){if(i/=p,p<0){if(i<c)return;i<h&&(h=i)}else if(p>0){if(i>h)return;i>c&&(c=i)}if(i=r-u,p||!(i<0)){if(i/=p,p<0){if(i>h)return;i>c&&(c=i)}else if(p>0){if(i<c)return;i<h&&(h=i)}return c>0&&(a.a={x:l+c*f,y:u+c*p}),h<1&&(a.b={x:l+h*f,y:u+h*p}),a}}}}}}var ir=1e9;function or(n,e,r,a){return function(l){var u,c,h,f,p,d,g,v,M,m,y,b=l,w=tr(),x=ar(n,e,r,a),k={point:q,lineStart:function(){k.point=T,c&&c.push(h=[]),m=!0,M=!1,g=v=NaN},lineEnd:function(){u&&(T(f,p),d&&M&&w.rejoin(),u.push(w.buffer())),k.point=q,M&&l.lineEnd()},polygonStart:function(){l=w,u=[],c=[],y=!0},polygonEnd:function(){l=b,u=t.merge(u);var e=function(t){for(var n=0,e=c.length,r=t[1],a=0;a<e;++a)for(var i,o=1,s=c[a],l=s.length,u=s[0];o<l;++o)i=s[o],u[1]<=r?i[1]>r&&jt(u,i,t)>0&&++n:i[1]<=r&&jt(u,i,t)<0&&--n,u=i;return 0!==n}([n,a]),r=y&&e,i=u.length;(r||i)&&(l.polygonStart(),r&&(l.lineStart(),S(null,null,1,l),l.lineEnd()),i&&$e(u,o,e,S,l),l.polygonEnd()),u=c=h=null}};function S(t,o,l,u){var c=0,h=0;if(null==t||(c=i(t,l))!==(h=i(o,l))||s(t,o)<0^l>0)do{u.point(0===c||3===c?n:r,c>1?a:e)}while((c=(c+l+4)%4)!==h);else u.point(o[0],o[1])}function _(t,i){return n<=t&&t<=r&&e<=i&&i<=a}function q(t,n){_(t,n)&&l.point(t,n)}function T(t,n){var e=_(t=Math.max(-1e9,Math.min(ir,t)),n=Math.max(-1e9,Math.min(ir,n)));if(c&&h.push([t,n]),m)f=t,p=n,d=e,m=!1,e&&(l.lineStart(),l.point(t,n));else if(e&&M)l.point(t,n);else{var r={a:{x:g,y:v},b:{x:t,y:n}};x(r)?(M||(l.lineStart(),l.point(r.a.x,r.a.y)),l.point(r.b.x,r.b.y),e||l.lineEnd(),y=!1):e&&(l.lineStart(),l.point(t,n),y=!1)}g=t,v=n,M=e}return k};function i(t,a){return M(t[0]-n)<kt?a>0?0:3:M(t[0]-r)<kt?a>0?2:1:M(t[1]-e)<kt?a>0?1:0:a>0?3:2}function o(t,n){return s(t.x,n.x)}function s(t,n){var e=i(t,1),r=i(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}}function sr(t){var n=0,e=_t/3,r=jr(t),a=r(n,e);return a.parallels=function(t){return arguments.length?r(n=t[0]*_t/180,e=t[1]*_t/180):[n/_t*180,e/_t*180]},a}function lr(t,n){var e=Math.sin(t),r=(e+Math.sin(n))/2,a=1+e*(2*r-e),i=Math.sqrt(a)/r;function o(t,n){var e=Math.sqrt(a-2*r*Math.sin(n))/r;return[e*Math.sin(t*=r),i-e*Math.cos(t)]}return o.invert=function(t,n){var e=i-n;return[Math.atan2(t,e)/r,Pt((a-(t*t+e*e)*r*r)/(2*r))]},o}t.geo.clipExtent=function(){var t,n,e,r,a,i,o={stream:function(t){return a&&(a.valid=!1),(a=i(t)).valid=!0,a},extent:function(s){return arguments.length?(i=or(t=+s[0][0],n=+s[0][1],e=+s[1][0],r=+s[1][1]),a&&(a.valid=!1,a=null),o):[[t,n],[e,r]]}};return o.extent([[0,0],[960,500]])},(t.geo.conicEqualArea=function(){return sr(lr)}).raw=lr,t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},t.geo.albersUsa=function(){var n,e,r,a,i=t.geo.albers(),o=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){n=[t,e]}};function u(t){var i=t[0],o=t[1];return n=null,e(i,o),n||(r(i,o),n)||a(i,o),n}return u.invert=function(t){var n=i.scale(),e=i.translate(),r=(t[0]-e[0])/n,a=(t[1]-e[1])/n;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?o:a>=.166&&a<.234&&r>=-.214&&r<-.115?s:i).invert(t)},u.stream=function(t){var n=i.stream(t),e=o.stream(t),r=s.stream(t);return{point:function(t,a){n.point(t,a),e.point(t,a),r.point(t,a)},sphere:function(){n.sphere(),e.sphere(),r.sphere()},lineStart:function(){n.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){n.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){n.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){n.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},u.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),s.precision(t),u):i.precision()},u.scale=function(t){return arguments.length?(i.scale(t),o.scale(.35*t),s.scale(t),u.translate(i.translate())):i.scale()},u.translate=function(t){if(!arguments.length)return i.translate();var n=i.scale(),c=+t[0],h=+t[1];return e=i.translate(t).clipExtent([[c-.455*n,h-.238*n],[c+.455*n,h+.238*n]]).stream(l).point,r=o.translate([c-.307*n,h+.201*n]).clipExtent([[c-.425*n+kt,h+.12*n+kt],[c-.214*n-kt,h+.234*n-kt]]).stream(l).point,a=s.translate([c-.205*n,h+.212*n]).clipExtent([[c-.214*n+kt,h+.166*n+kt],[c-.115*n-kt,h+.234*n-kt]]).stream(l).point,u},u.scale(1070)};var ur,cr,hr,fr,pr,dr,gr={point:L,lineStart:L,lineEnd:L,polygonStart:function(){cr=0,gr.lineStart=vr},polygonEnd:function(){gr.lineStart=gr.lineEnd=gr.point=L,ur+=M(cr/2)}};function vr(){var t,n,e,r;function a(t,n){cr+=r*t-e*n,e=t,r=n}gr.point=function(i,o){gr.point=a,t=e=i,n=r=o},gr.lineEnd=function(){a(t,n)}}var Mr={point:function(t,n){t<hr&&(hr=t),t>pr&&(pr=t),n<fr&&(fr=n),n>dr&&(dr=n)},lineStart:L,lineEnd:L,polygonStart:L,polygonEnd:L};function mr(){var t=yr(4.5),n=[],e={point:r,lineStart:function(){e.point=a},lineEnd:o,polygonStart:function(){e.lineEnd=s},polygonEnd:function(){e.lineEnd=o,e.point=r},pointRadius:function(n){return t=yr(n),e},result:function(){if(n.length){var t=n.join("");return n=[],t}}};function r(e,r){n.push("M",e,",",r,t)}function a(t,r){n.push("M",t,",",r),e.point=i}function i(t,e){n.push("L",t,",",e)}function o(){e.point=r}function s(){n.push("Z")}return e}function yr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var br,wr={point:xr,lineStart:kr,lineEnd:Sr,polygonStart:function(){wr.lineStart=_r},polygonEnd:function(){wr.point=xr,wr.lineStart=kr,wr.lineEnd=Sr}};function xr(t,n){we+=t,xe+=n,++ke}function kr(){var t,n;function e(e,r){var a=e-t,i=r-n,o=Math.sqrt(a*a+i*i);Se+=o*(t+e)/2,_e+=o*(n+r)/2,qe+=o,xr(t=e,n=r)}wr.point=function(r,a){wr.point=e,xr(t=r,n=a)}}function Sr(){wr.point=xr}function _r(){var t,n,e,r;function a(t,n){var a=t-e,i=n-r,o=Math.sqrt(a*a+i*i);Se+=o*(e+t)/2,_e+=o*(r+n)/2,qe+=o,Te+=(o=r*t-e*n)*(e+t),ze+=o*(r+n),Ee+=3*o,xr(e=t,r=n)}wr.point=function(i,o){wr.point=a,xr(t=e=i,n=r=o)},wr.lineEnd=function(){a(t,n)}}function qr(t){var n=4.5,e={point:r,lineStart:function(){e.point=a},lineEnd:o,polygonStart:function(){e.lineEnd=s},polygonEnd:function(){e.lineEnd=o,e.point=r},pointRadius:function(t){return n=t,e},result:L};function r(e,r){t.moveTo(e+n,r),t.arc(e,r,n,0,qt)}function a(n,r){t.moveTo(n,r),e.point=i}function i(n,e){t.lineTo(n,e)}function o(){e.point=r}function s(){t.closePath()}return e}function Tr(t){var n=.5,e=Math.cos(30*Et),r=16;function a(t){return(r?o:i)(t)}function i(n){return Ar(n,function(e,r){e=t(e,r),n.point(e[0],e[1])})}function o(n){var e,a,i,o,l,u,c,h,f,p,d,g,v={point:M,lineStart:m,lineEnd:b,polygonStart:function(){n.polygonStart(),v.lineStart=w},polygonEnd:function(){n.polygonEnd(),v.lineStart=m}};function M(e,r){e=t(e,r),n.point(e[0],e[1])}function m(){h=NaN,v.point=y,n.lineStart()}function y(e,a){var i=Le([e,a]),o=t(e,a);s(h,f,c,p,d,g,h=o[0],f=o[1],c=e,p=i[0],d=i[1],g=i[2],r,n),n.point(h,f)}function b(){v.point=M,n.lineEnd()}function w(){m(),v.point=x,v.lineEnd=k}function x(t,n){y(e=t,n),a=h,i=f,o=p,l=d,u=g,v.point=y}function k(){s(h,f,c,p,d,g,a,i,e,o,l,u,r,n),v.lineEnd=b,b()}return v}function s(r,a,i,o,l,u,c,h,f,p,d,g,v,m){var y=c-r,b=h-a,w=y*y+b*b;if(w>4*n&&v--){var x=o+p,k=l+d,S=u+g,_=Math.sqrt(x*x+k*k+S*S),q=Math.asin(S/=_),T=M(M(S)-1)<kt||M(i-f)<kt?(i+f)/2:Math.atan2(k,x),z=t(T,q),E=z[0],A=z[1],N=E-r,j=A-a,L=b*N-y*j;(L*L/w>n||M((y*N+b*j)/w-.5)>.3||o*p+l*d+u*g<e)&&(s(r,a,i,o,l,u,E,A,T,x/=_,k/=_,S,v,m),m.point(E,A),s(E,A,T,x,k,S,c,h,f,p,d,g,v,m))}}return a.precision=function(t){return arguments.length?(r=(n=t*t)>0&&16,a):Math.sqrt(n)},a}function zr(t){var n=Tr(function(n,e){return t([n*At,e*At])});return function(t){return Lr(n(t))}}function Er(t){this.stream=t}function Ar(t,n){return{point:n,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Nr(t){return jr(function(){return t})()}function jr(n){var e,r,a,i,o,s,l=Tr(function(t,n){return[(t=e(t,n))[0]*u+i,o-t[1]*u]}),u=150,c=480,h=250,f=0,p=0,d=0,g=0,v=0,M=er,m=E,y=null,b=null;function w(t){return[(t=a(t[0]*Et,t[1]*Et))[0]*u+i,o-t[1]*u]}function x(t){return(t=a.invert((t[0]-i)/u,(o-t[1])/u))&&[t[0]*At,t[1]*At]}function k(){a=Ye(r=Dr(d,g,v),e);var t=e(f,p);return i=c-t[0]*u,o=h+t[1]*u,S()}function S(){return s&&(s.valid=!1,s=null),w}return w.stream=function(t){return s&&(s.valid=!1),(s=Lr(M(r,l(m(t))))).valid=!0,s},w.clipAngle=function(t){return arguments.length?(M=null==t?(y=t,er):rr((y=+t)*Et),S()):y},w.clipExtent=function(t){return arguments.length?(b=t,m=t?or(t[0][0],t[0][1],t[1][0],t[1][1]):E,S()):b},w.scale=function(t){return arguments.length?(u=+t,k()):u},w.translate=function(t){return arguments.length?(c=+t[0],h=+t[1],k()):[c,h]},w.center=function(t){return arguments.length?(f=t[0]%360*Et,p=t[1]%360*Et,k()):[f*At,p*At]},w.rotate=function(t){return arguments.length?(d=t[0]%360*Et,g=t[1]%360*Et,v=t.length>2?t[2]%360*Et:0,k()):[d*At,g*At,v*At]},t.rebind(w,l,"precision"),function(){return e=n.apply(this,arguments),w.invert=e.invert&&x,k()}}function Lr(t){return Ar(t,function(n,e){t.point(n*Et,e*Et)})}function Pr(t,n){return[t,n]}function Cr(t,n){return[t>_t?t-qt:t<-_t?t+qt:t,n]}function Dr(t,n,e){return t?n||e?Ye(Rr(t),Fr(n,e)):Rr(t):n||e?Fr(n,e):Cr}function Ir(t){return function(n,e){return[(n+=t)>_t?n-qt:n<-_t?n+qt:n,e]}}function Rr(t){var n=Ir(t);return n.invert=Ir(-t),n}function Fr(t,n){var e=Math.cos(t),r=Math.sin(t),a=Math.cos(n),i=Math.sin(n);function o(t,n){var o=Math.cos(n),s=Math.cos(t)*o,l=Math.sin(t)*o,u=Math.sin(n),c=u*e+s*r;return[Math.atan2(l*a-c*i,s*e-u*r),Pt(c*a+l*i)]}return o.invert=function(t,n){var o=Math.cos(n),s=Math.cos(t)*o,l=Math.sin(t)*o,u=Math.sin(n),c=u*a-l*i;return[Math.atan2(l*a+u*i,s*e+c*r),Pt(c*e-s*r)]},o}function Or(t,n){var e=Math.cos(t),r=Math.sin(t);return function(a,i,o,s){var l=o*n;null!=a?(a=Ur(e,a),i=Ur(e,i),(o>0?a<i:a>i)&&(a+=o*qt)):(a=t+o*qt,i=t-.5*l);for(var u,c=a;o>0?c>i:c<i;c-=l)s.point((u=Fe([e,-r*Math.cos(c),-r*Math.sin(c)]))[0],u[1])}}function Ur(t,n){var e=Le(n);e[0]-=t,Re(e);var r=Lt(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-kt)%(2*Math.PI)}function Hr(n,e,r){var a=t.range(n,e-kt,r).concat(e);return function(t){return a.map(function(n){return[t,n]})}}function Br(n,e,r){var a=t.range(n,e-kt,r).concat(e);return function(t){return a.map(function(n){return[n,t]})}}function Qr(t){return t.source}function Vr(t){return t.target}t.geo.path=function(){var n,e,r,a,i,o=4.5;function s(n){return n&&("function"==typeof o&&a.pointRadius(+o.apply(this,arguments)),i&&i.valid||(i=r(a)),t.geo.stream(n,i)),a.result()}function l(){return i=null,s}return s.area=function(n){return ur=0,t.geo.stream(n,r(gr)),ur},s.centroid=function(n){return we=xe=ke=Se=_e=qe=Te=ze=Ee=0,t.geo.stream(n,r(wr)),Ee?[Te/Ee,ze/Ee]:qe?[Se/qe,_e/qe]:ke?[we/ke,xe/ke]:[NaN,NaN]},s.bounds=function(n){return pr=dr=-(hr=fr=1/0),t.geo.stream(n,r(Mr)),[[hr,fr],[pr,dr]]},s.projection=function(t){return arguments.length?(r=(n=t)?t.stream||zr(t):E,l()):n},s.context=function(t){return arguments.length?(a=null==(e=t)?new mr:new qr(t),"function"!=typeof o&&a.pointRadius(o),l()):e},s.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(a.pointRadius(+t),+t),s):o},s.projection(t.geo.albersUsa()).context(null)},t.geo.transform=function(t){return{stream:function(n){var e=new Er(n);for(var r in t)e[r]=t[r];return e}}},Er.prototype={point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},t.geo.projection=Nr,t.geo.projectionMutator=jr,(t.geo.equirectangular=function(){return Nr(Pr)}).raw=Pr.invert=Pr,t.geo.rotation=function(t){function n(n){return(n=t(n[0]*Et,n[1]*Et))[0]*=At,n[1]*=At,n}return t=Dr(t[0]%360*Et,t[1]*Et,t.length>2?t[2]*Et:0),n.invert=function(n){return(n=t.invert(n[0]*Et,n[1]*Et))[0]*=At,n[1]*=At,n},n},Cr.invert=Pr,t.geo.circle=function(){var t,n,e=[0,0],r=6;function a(){var t="function"==typeof e?e.apply(this,arguments):e,r=Dr(-t[0]*Et,-t[1]*Et,0).invert,a=[];return n(null,null,1,{point:function(t,n){a.push(t=r(t,n)),t[0]*=At,t[1]*=At}}),{type:"Polygon",coordinates:[a]}}return a.origin=function(t){return arguments.length?(e=t,a):e},a.angle=function(e){return arguments.length?(n=Or((t=+e)*Et,r*Et),a):t},a.precision=function(e){return arguments.length?(n=Or(t*Et,(r=+e)*Et),a):r},a.angle(90)},t.geo.distance=function(t,n){var e,r=(n[0]-t[0])*Et,a=t[1]*Et,i=n[1]*Et,o=Math.sin(r),s=Math.cos(r),l=Math.sin(a),u=Math.cos(a),c=Math.sin(i),h=Math.cos(i);return Math.atan2(Math.sqrt((e=h*o)*e+(e=u*c-l*h*s)*e),l*c+u*h*s)},t.geo.graticule=function(){var n,e,r,a,i,o,s,l,u,c,h,f,p=10,d=p,g=90,v=360,m=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return t.range(Math.ceil(a/g)*g,r,g).map(h).concat(t.range(Math.ceil(l/v)*v,s,v).map(f)).concat(t.range(Math.ceil(e/p)*p,n,p).filter(function(t){return M(t%g)>kt}).map(u)).concat(t.range(Math.ceil(o/d)*d,i,d).filter(function(t){return M(t%v)>kt}).map(c))}return y.lines=function(){return b().map(function(t){return{type:"LineString",coordinates:t}})},y.outline=function(){return{type:"Polygon",coordinates:[h(a).concat(f(s).slice(1),h(r).reverse().slice(1),f(l).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.majorExtent(t).minorExtent(t):y.minorExtent()},y.majorExtent=function(t){return arguments.length?(l=+t[0][1],s=+t[1][1],(a=+t[0][0])>(r=+t[1][0])&&(t=a,a=r,r=t),l>s&&(t=l,l=s,s=t),y.precision(m)):[[a,l],[r,s]]},y.minorExtent=function(t){return arguments.length?(o=+t[0][1],i=+t[1][1],(e=+t[0][0])>(n=+t[1][0])&&(t=e,e=n,n=t),o>i&&(t=o,o=i,i=t),y.precision(m)):[[e,o],[n,i]]},y.step=function(t){return arguments.length?y.majorStep(t).minorStep(t):y.minorStep()},y.majorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],y):[g,v]},y.minorStep=function(t){return arguments.length?(p=+t[0],d=+t[1],y):[p,d]},y.precision=function(t){return arguments.length?(m=+t,u=Hr(o,i,90),c=Br(e,n,m),h=Hr(l,s,90),f=Br(a,r,m),y):m},y.majorExtent([[-180,-90+kt],[180,90-kt]]).minorExtent([[-180,-80-kt],[180,80+kt]])},t.geo.greatArc=function(){var n,e,r=Qr,a=Vr;function i(){return{type:"LineString",coordinates:[n||r.apply(this,arguments),e||a.apply(this,arguments)]}}return i.distance=function(){return t.geo.distance(n||r.apply(this,arguments),e||a.apply(this,arguments))},i.source=function(t){return arguments.length?(r=t,n="function"==typeof t?null:t,i):r},i.target=function(t){return arguments.length?(a=t,e="function"==typeof t?null:t,i):a},i.precision=function(){return arguments.length?i:0},i},t.geo.interpolate=function(t,n){return e=t[0]*Et,r=t[1]*Et,a=n[0]*Et,i=n[1]*Et,o=Math.cos(r),s=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=o*Math.cos(e),h=o*Math.sin(e),f=l*Math.cos(a),p=l*Math.sin(a),d=2*Math.asin(Math.sqrt(Dt(i-r)+o*l*Dt(a-e))),g=1/Math.sin(d),(v=d?function(t){var n=Math.sin(t*=d)*g,e=Math.sin(d-t)*g,r=e*c+n*f,a=e*h+n*p,i=e*s+n*u;return[Math.atan2(a,r)*At,Math.atan2(i,Math.sqrt(r*r+a*a))*At]}:function(){return[e*At,r*At]}).distance=d,v;var e,r,a,i,o,s,l,u,c,h,f,p,d,g,v},t.geo.length=function(n){return br=0,t.geo.stream(n,Gr),br};var Gr={sphere:L,point:L,lineStart:function(){var t,n,e;function r(r,a){var i=Math.sin(a*=Et),o=Math.cos(a),s=M((r*=Et)-t),l=Math.cos(s);br+=Math.atan2(Math.sqrt((s=o*Math.sin(s))*s+(s=e*i-n*o*l)*s),n*i+e*o*l),t=r,n=i,e=o}Gr.point=function(a,i){t=a*Et,n=Math.sin(i*=Et),e=Math.cos(i),Gr.point=r},Gr.lineEnd=function(){Gr.point=Gr.lineEnd=L}},lineEnd:L,polygonStart:L,polygonEnd:L};function Yr(t,n){function e(n,e){var r=Math.cos(n),a=Math.cos(e),i=t(r*a);return[i*a*Math.sin(n),i*Math.sin(e)]}return e.invert=function(t,e){var r=Math.sqrt(t*t+e*e),a=n(r),i=Math.sin(a),o=Math.cos(a);return[Math.atan2(t*i,r*o),Math.asin(r&&e*i/r)]},e}var Wr=Yr(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(t.geo.azimuthalEqualArea=function(){return Nr(Wr)}).raw=Wr;var $r=Yr(function(t){var n=Math.acos(t);return n&&n/Math.sin(n)},E);function Zr(t,n){var e=Math.cos(t),r=function(t){return Math.tan(_t/4+t/2)},a=t===n?Math.sin(t):Math.log(e/Math.cos(n))/Math.log(r(n)/r(t)),i=e*Math.pow(r(t),a)/a;if(!a)return Kr;function o(t,n){i>0?n<-zt+kt&&(n=-zt+kt):n>zt-kt&&(n=zt-kt);var e=i/Math.pow(r(n),a);return[e*Math.sin(a*t),i-e*Math.cos(a*t)]}return o.invert=function(t,n){var e=i-n,r=Nt(a)*Math.sqrt(t*t+e*e);return[Math.atan2(t,e)/a,2*Math.atan(Math.pow(i/r,1/a))-zt]},o}function Xr(t,n){var e=Math.cos(t),r=t===n?Math.sin(t):(e-Math.cos(n))/(n-t),a=e/r+t;if(M(r)<kt)return Pr;function i(t,n){var e=a-n;return[e*Math.sin(r*t),a-e*Math.cos(r*t)]}return i.invert=function(t,n){var e=a-n;return[Math.atan2(t,e)/r,a-Nt(r)*Math.sqrt(t*t+e*e)]},i}(t.geo.azimuthalEquidistant=function(){return Nr($r)}).raw=$r,(t.geo.conicConformal=function(){return sr(Zr)}).raw=Zr,(t.geo.conicEquidistant=function(){return sr(Xr)}).raw=Xr;var Jr=Yr(function(t){return 1/t},Math.atan);function Kr(t,n){return[t,Math.log(Math.tan(_t/4+n/2))]}function ta(t){var n,e=Nr(t),r=e.scale,a=e.translate,i=e.clipExtent;return e.scale=function(){var t=r.apply(e,arguments);return t===e?n?e.clipExtent(null):e:t},e.translate=function(){var t=a.apply(e,arguments);return t===e?n?e.clipExtent(null):e:t},e.clipExtent=function(t){var o=i.apply(e,arguments);if(o===e){if(n=null==t){var s=_t*r(),l=a();i([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else n&&(o=null);return o},e.clipExtent(null)}(t.geo.gnomonic=function(){return Nr(Jr)}).raw=Jr,Kr.invert=function(t,n){return[t,2*Math.atan(Math.exp(n))-zt]},(t.geo.mercator=function(){return ta(Kr)}).raw=Kr;var na=Yr(function(){return 1},Math.asin);(t.geo.orthographic=function(){return Nr(na)}).raw=na;var ea=Yr(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});function ra(t,n){return[Math.log(Math.tan(_t/4+n/2)),-t]}function aa(t){return t[0]}function ia(t){return t[1]}function oa(t){for(var n=t.length,e=[0,1],r=2,a=2;a<n;a++){for(;r>1&&jt(t[e[r-2]],t[e[r-1]],t[a])<=0;)--r;e[r++]=a}return e.slice(0,r)}function sa(t,n){return t[0]-n[0]||t[1]-n[1]}(t.geo.stereographic=function(){return Nr(ea)}).raw=ea,ra.invert=function(t,n){return[-n,2*Math.atan(Math.exp(t))-zt]},(t.geo.transverseMercator=function(){var t=ta(ra),n=t.center,e=t.rotate;return t.center=function(t){return t?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return t?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90])}).raw=ra,t.geom={},t.geom.hull=function(t){var n=aa,e=ia;if(arguments.length)return r(t);function r(t){if(t.length<3)return[];var r,a=vn(n),i=vn(e),o=t.length,s=[],l=[];for(r=0;r<o;r++)s.push([+a.call(this,t[r],r),+i.call(this,t[r],r),r]);for(s.sort(sa),r=0;r<o;r++)l.push([s[r][0],-s[r][1]]);var u=oa(s),c=oa(l),h=c[0]===u[0],f=c[c.length-1]===u[u.length-1],p=[];for(r=u.length-1;r>=0;--r)p.push(t[s[u[r]][2]]);for(r=+h;r<c.length-f;++r)p.push(t[s[c[r]][2]]);return p}return r.x=function(t){return arguments.length?(n=t,r):n},r.y=function(t){return arguments.length?(e=t,r):e},r},t.geom.polygon=function(t){return O(t,la),t};var la=t.geom.polygon.prototype=[];function ua(t,n,e){return(e[0]-n[0])*(t[1]-n[1])<(e[1]-n[1])*(t[0]-n[0])}function ca(t,n,e,r){var a=t[0],i=e[0],o=n[0]-a,s=r[0]-i,l=t[1],u=e[1],c=n[1]-l,h=r[1]-u,f=(s*(l-u)-h*(a-i))/(h*o-s*c);return[a+f*o,l+f*c]}function ha(t){var n=t[0],e=t[t.length-1];return!(n[0]-e[0]||n[1]-e[1])}la.area=function(){for(var t,n=-1,e=this.length,r=this[e-1],a=0;++n<e;)a+=(t=r)[1]*(r=this[n])[0]-t[0]*r[1];return.5*a},la.centroid=function(t){var n,e,r=-1,a=this.length,i=0,o=0,s=this[a-1];for(arguments.length||(t=-1/(6*this.area()));++r<a;)i+=((n=s)[0]+(s=this[r])[0])*(e=n[0]*s[1]-s[0]*n[1]),o+=(n[1]+s[1])*e;return[i*t,o*t]},la.clip=function(t){for(var n,e,r,a,i,o,s=ha(t),l=-1,u=this.length-ha(this),c=this[u-1];++l<u;){for(n=t.slice(),t.length=0,a=this[l],i=n[(r=n.length-s)-1],e=-1;++e<r;)ua(o=n[e],c,a)?(ua(i,c,a)||t.push(ca(i,o,c,a)),t.push(o)):ua(i,c,a)&&t.push(ca(i,o,c,a)),i=o;s&&t.push(t[0]),c=a}return t};var fa,pa,da,ga,va,Ma=[],ma=[];function ya(){Ia(this),this.edge=this.site=this.circle=null}function ba(t){var n=Ma.pop()||new ya;return n.site=t,n}function wa(t){Aa(t),da.remove(t),Ma.push(t),Ia(t)}function xa(t){var n=t.circle,e=n.x,r=n.cy,a={x:e,y:r},i=t.P,o=t.N,s=[t];wa(t);for(var l=i;l.circle&&M(e-l.circle.x)<kt&&M(r-l.circle.cy)<kt;)i=l.P,s.unshift(l),wa(l),l=i;s.unshift(l),Aa(l);for(var u=o;u.circle&&M(e-u.circle.x)<kt&&M(r-u.circle.cy)<kt;)o=u.N,s.push(u),wa(u),u=o;s.push(u),Aa(u);var c,h=s.length;for(c=1;c<h;++c)Pa((u=s[c]).edge,(l=s[c-1]).site,u.site,a);(u=s[h-1]).edge=La((l=s[0]).site,u.site,null,a),Ea(l),Ea(u)}function ka(t){for(var n,e,r,a,i=t.x,o=t.y,s=da._;s;)if((r=Sa(s,o)-i)>kt)s=s.L;else{if(!((a=i-_a(s,o))>kt)){r>-kt?(n=s.P,e=s):a>-kt?(n=s,e=s.N):n=e=s;break}if(!s.R){n=s;break}s=s.R}var l=ba(t);if(da.insert(n,l),n||e){if(n===e)return Aa(n),e=ba(n.site),da.insert(l,e),l.edge=e.edge=La(n.site,l.site),Ea(n),void Ea(e);if(e){Aa(n),Aa(e);var u=n.site,c=u.x,h=u.y,f=t.x-c,p=t.y-h,d=e.site,g=d.x-c,v=d.y-h,M=2*(f*v-p*g),m=f*f+p*p,y=g*g+v*v,b={x:(v*m-p*y)/M+c,y:(f*y-g*m)/M+h};Pa(e.edge,u,d,b),l.edge=La(u,t,null,b),e.edge=La(t,d,null,b),Ea(n),Ea(e)}else l.edge=La(n.site,l.site)}}function Sa(t,n){var e=t.site,r=e.x,a=e.y,i=a-n;if(!i)return r;var o=t.P;if(!o)return-1/0;var s=(e=o.site).x,l=e.y,u=l-n;if(!u)return s;var c=s-r,h=1/i-1/u,f=c/u;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*u)-l+u/2+a-i/2)))/h+r:(r+s)/2}function _a(t,n){var e=t.N;if(e)return Sa(e,n);var r=t.site;return r.y===n?r.x:1/0}function qa(t){this.site=t,this.edges=[]}function Ta(t,n){return n.angle-t.angle}function za(){Ia(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ea(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,a=t.site,i=e.site;if(r!==i){var o=a.x,s=a.y,l=r.x-o,u=r.y-s,c=i.x-o,h=2*(l*(v=i.y-s)-u*c);if(!(h>=-St)){var f=l*l+u*u,p=c*c+v*v,d=(v*f-u*p)/h,g=(l*p-c*f)/h,v=g+s,M=ma.pop()||new za;M.arc=t,M.site=a,M.x=d+o,M.y=v+Math.sqrt(d*d+g*g),M.cy=v,t.circle=M;for(var m=null,y=va._;y;)if(M.y<y.y||M.y===y.y&&M.x<=y.x){if(!y.L){m=y.P;break}y=y.L}else{if(!y.R){m=y;break}y=y.R}va.insert(m,M),m||(ga=M)}}}}function Aa(t){var n=t.circle;n&&(n.P||(ga=n.N),va.remove(n),ma.push(n),Ia(n),t.circle=null)}function Na(t,n){var e=t.b;if(e)return!0;var r,a,i=t.a,o=n[0][0],s=n[1][0],l=n[0][1],u=n[1][1],c=t.l,h=t.r,f=c.x,p=c.y,d=h.x,g=h.y,v=(f+d)/2;if(g===p){if(v<o||v>=s)return;if(f>d){if(i){if(i.y>=u)return}else i={x:v,y:l};e={x:v,y:u}}else{if(i){if(i.y<l)return}else i={x:v,y:u};e={x:v,y:l}}}else if(a=(p+g)/2-(r=(f-d)/(g-p))*v,r<-1||r>1)if(f>d){if(i){if(i.y>=u)return}else i={x:(l-a)/r,y:l};e={x:(u-a)/r,y:u}}else{if(i){if(i.y<l)return}else i={x:(u-a)/r,y:u};e={x:(l-a)/r,y:l}}else if(p<g){if(i){if(i.x>=s)return}else i={x:o,y:r*o+a};e={x:s,y:r*s+a}}else{if(i){if(i.x<o)return}else i={x:s,y:r*s+a};e={x:o,y:r*o+a}}return t.a=i,t.b=e,!0}function ja(t,n){this.l=t,this.r=n,this.a=this.b=null}function La(t,n,e,r){var a=new ja(t,n);return fa.push(a),e&&Pa(a,t,n,e),r&&Pa(a,n,t,r),pa[t.i].edges.push(new Ca(a,t,n)),pa[n.i].edges.push(new Ca(a,n,t)),a}function Pa(t,n,e,r){t.a||t.b?t.l===e?t.b=r:t.a=r:(t.a=r,t.l=n,t.r=e)}function Ca(t,n,e){var r=t.a,a=t.b;this.edge=t,this.site=n,this.angle=e?Math.atan2(e.y-n.y,e.x-n.x):t.l===n?Math.atan2(a.x-r.x,r.y-a.y):Math.atan2(r.x-a.x,a.y-r.y)}function Da(){this._=null}function Ia(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Ra(t,n){var e=n,r=n.R,a=e.U;a?a.L===e?a.L=r:a.R=r:t._=r,r.U=a,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function Fa(t,n){var e=n,r=n.L,a=e.U;a?a.L===e?a.L=r:a.R=r:t._=r,r.U=a,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function Oa(t){for(;t.L;)t=t.L;return t}function Ua(t,n){var e,r,a,i=t.sort(Ha).pop();for(fa=[],pa=new Array(t.length),da=new Da,va=new Da;;)if(a=ga,i&&(!a||i.y<a.y||i.y===a.y&&i.x<a.x))i.x===e&&i.y===r||(pa[i.i]=new qa(i),ka(i),e=i.x,r=i.y),i=t.pop();else{if(!a)break;xa(a.arc)}n&&(function(t){for(var n,e=fa,r=ar(t[0][0],t[0][1],t[1][0],t[1][1]),a=e.length;a--;)(!Na(n=e[a],t)||!r(n)||M(n.a.x-n.b.x)<kt&&M(n.a.y-n.b.y)<kt)&&(n.a=n.b=null,e.splice(a,1))}(n),function(t){for(var n,e,r,a,i,o,s,l,u,c,h=t[0][0],f=t[1][0],p=t[0][1],d=t[1][1],g=pa,v=g.length;v--;)if((i=g[v])&&i.prepare())for(l=(s=i.edges).length,o=0;o<l;)r=(c=s[o].end()).x,a=c.y,e=(u=s[++o%l].start()).y,(M(r-(n=u.x))>kt||M(a-e)>kt)&&(s.splice(o,0,new Ca((m=i.site,y=c,b=M(r-h)<kt&&d-a>kt?{x:h,y:M(n-h)<kt?e:d}:M(a-d)<kt&&f-r>kt?{x:M(e-d)<kt?n:f,y:d}:M(r-f)<kt&&a-p>kt?{x:f,y:M(n-f)<kt?e:p}:M(a-p)<kt&&r-h>kt?{x:M(e-p)<kt?n:h,y:p}:null,w=void 0,(w=new ja(m,null)).a=y,w.b=b,fa.push(w),w),i.site,null)),++l);var m,y,b,w}(n));var o={cells:pa,edges:fa};return da=va=fa=pa=null,o}function Ha(t,n){return n.y-t.y||n.x-t.x}qa.prototype.prepare=function(){for(var t,n=this.edges,e=n.length;e--;)(t=n[e].edge).b&&t.a||n.splice(e,1);return n.sort(Ta),n.length},Ca.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Da.prototype={insert:function(t,n){var e,r,a;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=Oa(this._),n.P=null,n.N=t,t.P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(a=r.R)&&a.C?(e.C=a.C=!1,r.C=!0,t=r):(t===e.R&&(Ra(this,e),e=(t=e).U),e.C=!1,r.C=!0,Fa(this,r)):(a=r.L)&&a.C?(e.C=a.C=!1,r.C=!0,t=r):(t===e.L&&(Fa(this,e),e=(t=e).U),e.C=!1,r.C=!0,Ra(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,a=t.U,i=t.L,o=t.R;if(e=i?o?Oa(o):i:o,a?a.L===t?a.L=e:a.R=e:this._=e,i&&o?(r=e.C,e.C=t.C,e.L=i,i.U=e,e!==o?(a=e.U,e.U=t.U,a.L=t=e.R,e.R=o,o.U=e):(e.U=a,a=e,t=e.R)):(r=t.C,t=e),t&&(t.U=a),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===a.L){if((n=a.R).C&&(n.C=!1,a.C=!0,Ra(this,a),n=a.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,Fa(this,n),n=a.R),n.C=a.C,a.C=n.R.C=!1,Ra(this,a),t=this._;break}}else if((n=a.L).C&&(n.C=!1,a.C=!0,Fa(this,a),n=a.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,Ra(this,n),n=a.L),n.C=a.C,a.C=n.L.C=!1,Fa(this,a),t=this._;break}n.C=!0,t=a,a=a.U}while(!t.C);t&&(t.C=!1)}}},t.geom.voronoi=function(t){var n=aa,e=ia,r=n,a=e,i=Ba;if(t)return o(t);function o(t){var n=new Array(t.length),e=i[0][0],r=i[0][1],a=i[1][0],o=i[1][1];return Ua(s(t),i).cells.forEach(function(i,s){var l=i.edges,u=i.site;(n[s]=l.length?l.map(function(t){var n=t.start();return[n.x,n.y]}):u.x>=e&&u.x<=a&&u.y>=r&&u.y<=o?[[e,o],[a,o],[a,r],[e,r]]:[]).point=t[s]}),n}function s(t){return t.map(function(t,n){return{x:Math.round(r(t,n)/kt)*kt,y:Math.round(a(t,n)/kt)*kt,i:n}})}return o.links=function(t){return Ua(s(t)).edges.filter(function(t){return t.l&&t.r}).map(function(n){return{source:t[n.l.i],target:t[n.r.i]}})},o.triangles=function(t){var n=[];return Ua(s(t)).cells.forEach(function(e,r){for(var a,i,o,s,l=e.site,u=e.edges.sort(Ta),c=-1,h=u.length,f=u[h-1].edge,p=f.l===l?f.r:f.l;++c<h;)a=p,p=(f=u[c].edge).l===l?f.r:f.l,r<a.i&&r<p.i&&((i=l).x-(s=p).x)*((o=a).y-i.y)-(i.x-o.x)*(s.y-i.y)<0&&n.push([t[r],t[a.i],t[p.i]])}),n},o.x=function(t){return arguments.length?(r=vn(n=t),o):n},o.y=function(t){return arguments.length?(a=vn(e=t),o):e},o.clipExtent=function(t){return arguments.length?(i=null==t?Ba:t,o):i===Ba?null:i},o.size=function(t){return arguments.length?o.clipExtent(t&&[[0,0],t]):i===Ba?null:i&&i[1]},o};var Ba=[[-1e6,-1e6],[1e6,1e6]];function Qa(t){return t.x}function Va(t){return t.y}function Ga(t,n,e,r,a,i){if(!t(n,e,r,a,i)){var o=.5*(e+a),s=.5*(r+i),l=n.nodes;l[0]&&Ga(t,l[0],e,r,o,s),l[1]&&Ga(t,l[1],o,r,a,s),l[2]&&Ga(t,l[2],e,s,o,i),l[3]&&Ga(t,l[3],o,s,a,i)}}function Ya(t,n,e,r,a,i,o){var s,l=1/0;return function t(u,c,h,f,p){if(!(c>i||h>o||f<r||p<a)){if(d=u.point){var d,g=n-u.x,v=e-u.y,M=g*g+v*v;if(M<l){var m=Math.sqrt(l=M);r=n-m,a=e-m,i=n+m,o=e+m,s=d}}for(var y=u.nodes,b=.5*(c+f),w=.5*(h+p),x=(e>=w)<<1|n>=b,k=x+4;x<k;++x)if(u=y[3&x])switch(3&x){case 0:t(u,c,h,b,w);break;case 1:t(u,b,h,f,w);break;case 2:t(u,c,w,b,p);break;case 3:t(u,b,w,f,p)}}}(t,r,a,i,o),s}function Wa(n,e){n=t.rgb(n),e=t.rgb(e);var r=n.r,a=n.g,i=n.b,o=e.r-r,s=e.g-a,l=e.b-i;return function(t){return"#"+un(Math.round(r+o*t))+un(Math.round(a+s*t))+un(Math.round(i+l*t))}}function $a(t,n){var e,r={},a={};for(e in t)e in n?r[e]=ti(t[e],n[e]):a[e]=t[e];for(e in n)e in t||(a[e]=n[e]);return function(t){for(e in r)a[e]=r[e](t);return a}}function Za(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function Xa(t,n){var e,r,a,i=Ja.lastIndex=Ka.lastIndex=0,o=-1,s=[],l=[];for(t+="",n+="";(e=Ja.exec(t))&&(r=Ka.exec(n));)(a=r.index)>i&&(a=n.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(e=e[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:Za(e,r)})),i=Ka.lastIndex;return i<n.length&&(a=n.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?(n=l[0].x,function(t){return n(t)+""}):function(){return n}:(n=l.length,function(t){for(var e,r=0;r<n;++r)s[(e=l[r]).i]=e.x(t);return s.join("")})}t.geom.delaunay=function(n){return t.geom.voronoi().triangles(n)},t.geom.quadtree=function(t,n,e,r,a){var i,o=aa,s=ia;if(i=arguments.length)return o=Qa,s=Va,3===i&&(a=e,r=n,e=n=0),l(t);function l(t){var l,u,c,h,f,p,d,g,v,m=vn(o),y=vn(s);if(null!=n)p=n,d=e,g=r,v=a;else if(g=v=-(p=d=1/0),u=[],c=[],f=t.length,i)for(h=0;h<f;++h)(l=t[h]).x<p&&(p=l.x),l.y<d&&(d=l.y),l.x>g&&(g=l.x),l.y>v&&(v=l.y),u.push(l.x),c.push(l.y);else for(h=0;h<f;++h){var b=+m(l=t[h],h),w=+y(l,h);b<p&&(p=b),w<d&&(d=w),b>g&&(g=b),w>v&&(v=w),u.push(b),c.push(w)}var x=g-p,k=v-d;function S(t,n,e,r,a,i,o,s){if(!isNaN(e)&&!isNaN(r))if(t.leaf){var l=t.x,u=t.y;if(null!=l)if(M(l-e)+M(u-r)<.01)_(t,n,e,r,a,i,o,s);else{var c=t.point;t.x=t.y=t.point=null,_(t,c,l,u,a,i,o,s),_(t,n,e,r,a,i,o,s)}else t.x=e,t.y=r,t.point=n}else _(t,n,e,r,a,i,o,s)}function _(t,n,e,r,a,i,o,s){var l=.5*(a+o),u=.5*(i+s),c=e>=l,h=r>=u,f=h<<1|c;t.leaf=!1,c?a=l:o=l,h?i=u:s=u,S(t=t.nodes[f]||(t.nodes[f]={leaf:!0,nodes:[],point:null,x:null,y:null}),n,e,r,a,i,o,s)}x>k?v=d+x:g=p+k;var q={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){S(q,t,+m(t,++h),+y(t,h),p,d,g,v)},visit:function(t){Ga(t,q,p,d,g,v)},find:function(t){return Ya(q,t[0],t[1],p,d,g,v)}};if(h=-1,null==n){for(;++h<f;)S(q,t[h],u[h],c[h],p,d,g,v);--h}else t.forEach(q.add);return u=c=t=l=null,q}return l.x=function(t){return arguments.length?(o=t,l):o},l.y=function(t){return arguments.length?(s=t,l):s},l.extent=function(t){return arguments.length?(null==t?n=e=r=a=null:(n=+t[0][0],e=+t[0][1],r=+t[1][0],a=+t[1][1]),l):null==n?null:[[n,e],[r,a]]},l.size=function(t){return arguments.length?(null==t?n=e=r=a=null:(n=e=0,r=+t[0],a=+t[1]),l):null==n?null:[r-n,a-e]},l},t.interpolateRgb=Wa,t.interpolateObject=$a,t.interpolateNumber=Za,t.interpolateString=Xa;var Ja=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ka=new RegExp(Ja.source,"g");function ti(n,e){for(var r,a=t.interpolators.length;--a>=0&&!(r=t.interpolators[a](n,e)););return r}function ni(t,n){var e,r=[],a=[],i=t.length,o=n.length,s=Math.min(t.length,n.length);for(e=0;e<s;++e)r.push(ti(t[e],n[e]));for(;e<i;++e)a[e]=t[e];for(;e<o;++e)a[e]=n[e];return function(t){for(e=0;e<s;++e)a[e]=r[e](t);return a}}t.interpolate=ti,t.interpolators=[function(t,n){var e=typeof n;return("string"===e?gn.has(n.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(n)?Wa:Xa:n instanceof Ut?Wa:Array.isArray(n)?ni:"object"===e&&isNaN(n)?$a:Za)(t,n)}],t.interpolateArray=ni;var ei=function(){return E},ri=t.map({linear:ei,poly:function(t){return function(n){return Math.pow(n,t)}},quad:function(){return li},cubic:function(){return ui},sin:function(){return hi},exp:function(){return fi},circle:function(){return pi},elastic:function(t,n){var e;return arguments.length<2&&(n=.45),arguments.length?e=n/qt*Math.asin(1/t):(t=1,e=n/4),function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-e)*qt/n)}},back:function(t){return t||(t=1.70158),function(n){return n*n*((t+1)*n-t)}},bounce:function(){return di}}),ai=t.map({in:E,out:oi,"in-out":si,"out-in":function(t){return si(oi(t))}});function ii(t){return function(n){return n<=0?0:n>=1?1:t(n)}}function oi(t){return function(n){return 1-t(1-n)}}function si(t){return function(n){return.5*(n<.5?t(2*n):2-t(2-2*n))}}function li(t){return t*t}function ui(t){return t*t*t}function ci(t){if(t<=0)return 0;if(t>=1)return 1;var n=t*t,e=n*t;return 4*(t<.5?e:3*(t-n)+e-.75)}function hi(t){return 1-Math.cos(t*zt)}function fi(t){return Math.pow(2,10*(t-1))}function pi(t){return 1-Math.sqrt(1-t*t)}function di(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function gi(t,n){return n-=t,function(e){return Math.round(t+n*e)}}function vi(t){var n,e,r,a=[t.a,t.b],i=[t.c,t.d],o=mi(a),s=Mi(a,i),l=mi(((n=i)[0]+=(r=-s)*(e=a)[0],n[1]+=r*e[1],n))||0;a[0]*i[1]<i[0]*a[1]&&(a[0]*=-1,a[1]*=-1,o*=-1,s*=-1),this.rotate=(o?Math.atan2(a[1],a[0]):Math.atan2(-i[0],i[1]))*At,this.translate=[t.e,t.f],this.scale=[o,l],this.skew=l?Math.atan2(s,l)*At:0}function Mi(t,n){return t[0]*n[0]+t[1]*n[1]}function mi(t){var n=Math.sqrt(Mi(t,t));return n&&(t[0]/=n,t[1]/=n),n}t.ease=function(t){var e=t.indexOf("-"),r=e>=0?t.slice(0,e):t,a=e>=0?t.slice(e+1):"in";return r=ri.get(r)||ei,ii((a=ai.get(a)||E)(r.apply(null,n.call(arguments,1))))},t.interpolateHcl=function(n,e){n=t.hcl(n),e=t.hcl(e);var r=n.h,a=n.c,i=n.l,o=e.h-r,s=e.c-a,l=e.l-i;return isNaN(s)&&(s=0,a=isNaN(a)?e.c:a),isNaN(o)?(o=0,r=isNaN(r)?e.h:r):o>180?o-=360:o<-180&&(o+=360),function(t){return Yt(r+o*t,a+s*t,i+l*t)+""}},t.interpolateHsl=function(n,e){n=t.hsl(n),e=t.hsl(e);var r=n.h,a=n.s,i=n.l,o=e.h-r,s=e.s-a,l=e.l-i;return isNaN(s)&&(s=0,a=isNaN(a)?e.s:a),isNaN(o)?(o=0,r=isNaN(r)?e.h:r):o>180?o-=360:o<-180&&(o+=360),function(t){return Qt(r+o*t,a+s*t,i+l*t)+""}},t.interpolateLab=function(n,e){n=t.lab(n),e=t.lab(e);var r=n.l,a=n.a,i=n.b,o=e.l-r,s=e.a-a,l=e.b-i;return function(t){return Kt(r+o*t,a+s*t,i+l*t)+""}},t.interpolateRound=gi,t.transform=function(n){var e=r.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new vi(n?n.matrix:yi)})(n)},vi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var yi={a:1,b:0,c:0,d:1,e:0,f:0};function bi(t){return t.length?t.pop()+",":""}function wi(n,e){var r=[],a=[];return n=t.transform(n),e=t.transform(e),function(t,n,e,r){if(t[0]!==n[0]||t[1]!==n[1]){var a=e.push("translate(",null,",",null,")");r.push({i:a-4,x:Za(t[0],n[0])},{i:a-2,x:Za(t[1],n[1])})}else(n[0]||n[1])&&e.push("translate("+n+")")}(n.translate,e.translate,r,a),function(t,n,e,r){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),r.push({i:e.push(bi(e)+"rotate(",null,")")-2,x:Za(t,n)})):n&&e.push(bi(e)+"rotate("+n+")")}(n.rotate,e.rotate,r,a),function(t,n,e,r){t!==n?r.push({i:e.push(bi(e)+"skewX(",null,")")-2,x:Za(t,n)}):n&&e.push(bi(e)+"skewX("+n+")")}(n.skew,e.skew,r,a),function(t,n,e,r){if(t[0]!==n[0]||t[1]!==n[1]){var a=e.push(bi(e)+"scale(",null,",",null,")");r.push({i:a-4,x:Za(t[0],n[0])},{i:a-2,x:Za(t[1],n[1])})}else 1===n[0]&&1===n[1]||e.push(bi(e)+"scale("+n+")")}(n.scale,e.scale,r,a),n=e=null,function(t){for(var n,e=-1,i=a.length;++e<i;)r[(n=a[e]).i]=n.x(t);return r.join("")}}function xi(t,n){return n=(n-=t=+t)||1/n,function(e){return(e-t)/n}}function ki(t,n){return n=(n-=t=+t)||1/n,function(e){return Math.max(0,Math.min(1,(e-t)/n))}}function Si(t){for(var n=t.source,e=t.target,r=function(t,n){if(t===n)return t;for(var e=_i(t),r=_i(n),a=e.pop(),i=r.pop(),o=null;a===i;)o=a,a=e.pop(),i=r.pop();return o}(n,e),a=[n];n!==r;)a.push(n=n.parent);for(var i=a.length;e!==r;)a.splice(i,0,e),e=e.parent;return a}function _i(t){for(var n=[],e=t.parent;null!=e;)n.push(t),t=e,e=e.parent;return n.push(t),n}function qi(t){t.fixed|=2}function Ti(t){t.fixed&=-7}function zi(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Ei(t){t.fixed&=-5}function Ai(t,n,e){var r=0,a=0;if(t.charge=0,!t.leaf)for(var i,o=t.nodes,s=o.length,l=-1;++l<s;)null!=(i=o[l])&&(Ai(i,n,e),t.charge+=i.charge,r+=i.charge*i.cx,a+=i.charge*i.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=n*e[t.point.index];t.charge+=t.pointCharge=u,r+=u*t.point.x,a+=u*t.point.y}t.cx=r/t.charge,t.cy=a/t.charge}t.interpolateTransform=wi,t.layout={},t.layout.bundle=function(){return function(t){for(var n=[],e=-1,r=t.length;++e<r;)n.push(Si(t[e]));return n}},t.layout.chord=function(){var n,e,r,a,i,o,s,l={},u=0;function c(){var l,c,f,p,d,g={},v=[],M=t.range(a),m=[];for(n=[],e=[],l=0,p=-1;++p<a;){for(c=0,d=-1;++d<a;)c+=r[p][d];v.push(c),m.push(t.range(a)),l+=c}for(i&&M.sort(function(t,n){return i(v[t],v[n])}),o&&m.forEach(function(t,n){t.sort(function(t,e){return o(r[n][t],r[n][e])})}),l=(qt-u*a)/l,c=0,p=-1;++p<a;){for(f=c,d=-1;++d<a;){var y=M[p],b=m[y][d],w=r[y][b],x=c,k=c+=w*l;g[y+"-"+b]={index:y,subindex:b,startAngle:x,endAngle:k,value:w}}e[y]={index:y,startAngle:f,endAngle:c,value:v[y]},c+=u}for(p=-1;++p<a;)for(d=p-1;++d<a;){var S=g[p+"-"+d],_=g[d+"-"+p];(S.value||_.value)&&n.push(S.value<_.value?{source:_,target:S}:{source:S,target:_})}s&&h()}function h(){n.sort(function(t,n){return s((t.source.value+t.target.value)/2,(n.source.value+n.target.value)/2)})}return l.matrix=function(t){return arguments.length?(a=(r=t)&&r.length,n=e=null,l):r},l.padding=function(t){return arguments.length?(u=t,n=e=null,l):u},l.sortGroups=function(t){return arguments.length?(i=t,n=e=null,l):i},l.sortSubgroups=function(t){return arguments.length?(o=t,n=null,l):o},l.sortChords=function(t){return arguments.length?(s=t,n&&h(),l):s},l.chords=function(){return n||c(),n},l.groups=function(){return e||c(),e},l},t.layout.force=function(){var n,e,r,a,i,o,s={},l=t.dispatch("start","tick","end"),u=[1,1],c=.9,h=Ni,f=ji,p=-30,d=Li,g=.1,v=.64,M=[],m=[];function y(t){return function(n,e,r,a){if(n.point!==t){var i,o=n.cx-t.x,s=n.cy-t.y,l=a-e,u=o*o+s*s;if(l*l/v<u)return u<d&&(t.px-=o*(i=n.charge/u),t.py-=s*i),!0;n.point&&u&&u<d&&(t.px-=o*(i=n.pointCharge/u),t.py-=s*i)}return!n.charge}}function b(n){n.px=t.event.x,n.py=t.event.y,s.resume()}return s.tick=function(){if((r*=.99)<.005)return n=null,l.end({type:"end",alpha:r=0}),!0;var e,s,h,f,d,v,b,w,x,k=M.length,S=m.length;for(s=0;s<S;++s)(v=(w=(d=(h=m[s]).target).x-(f=h.source).x)*w+(x=d.y-f.y)*x)&&(x*=v=r*i[s]*((v=Math.sqrt(v))-a[s])/v,d.x-=(w*=v)*(b=f.weight+d.weight?f.weight/(f.weight+d.weight):.5),d.y-=x*b,f.x+=w*(b=1-b),f.y+=x*b);if((b=r*g)&&(w=u[0]/2,x=u[1]/2,s=-1,b))for(;++s<k;)(h=M[s]).x+=(w-h.x)*b,h.y+=(x-h.y)*b;if(p)for(Ai(e=t.geom.quadtree(M),r,o),s=-1;++s<k;)(h=M[s]).fixed||e.visit(y(h));for(s=-1;++s<k;)(h=M[s]).fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*c,h.y-=(h.py-(h.py=h.y))*c);l.tick({type:"tick",alpha:r})},s.nodes=function(t){return arguments.length?(M=t,s):M},s.links=function(t){return arguments.length?(m=t,s):m},s.size=function(t){return arguments.length?(u=t,s):u},s.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.friction=function(t){return arguments.length?(c=+t,s):c},s.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,s):p},s.chargeDistance=function(t){return arguments.length?(d=t*t,s):Math.sqrt(d)},s.gravity=function(t){return arguments.length?(g=+t,s):g},s.theta=function(t){return arguments.length?(v=t*t,s):Math.sqrt(v)},s.alpha=function(t){return arguments.length?(t=+t,r?t>0?r=t:(n.c=null,n.t=NaN,n=null,l.end({type:"end",alpha:r=0})):t>0&&(l.start({type:"start",alpha:r=t}),n=Sn(s.tick)),s):r},s.start=function(){var t,n,e,r=M.length,l=m.length,c=u[0],d=u[1];for(t=0;t<r;++t)(e=M[t]).index=t,e.weight=0;for(t=0;t<l;++t)"number"==typeof(e=m[t]).source&&(e.source=M[e.source]),"number"==typeof e.target&&(e.target=M[e.target]),++e.source.weight,++e.target.weight;for(t=0;t<r;++t)e=M[t],isNaN(e.x)&&(e.x=g("x",c)),isNaN(e.y)&&(e.y=g("y",d)),isNaN(e.px)&&(e.px=e.x),isNaN(e.py)&&(e.py=e.y);if(a=[],"function"==typeof h)for(t=0;t<l;++t)a[t]=+h.call(this,m[t],t);else for(t=0;t<l;++t)a[t]=h;if(i=[],"function"==typeof f)for(t=0;t<l;++t)i[t]=+f.call(this,m[t],t);else for(t=0;t<l;++t)i[t]=f;if(o=[],"function"==typeof p)for(t=0;t<r;++t)o[t]=+p.call(this,M[t],t);else for(t=0;t<r;++t)o[t]=p;function g(e,a){if(!n){for(n=new Array(r),u=0;u<r;++u)n[u]=[];for(u=0;u<l;++u){var i=m[u];n[i.source.index].push(i.target),n[i.target.index].push(i.source)}}for(var o,s=n[t],u=-1,c=s.length;++u<c;)if(!isNaN(o=s[u][e]))return o;return Math.random()*a}return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){if(e||(e=t.behavior.drag().origin(E).on("dragstart.force",qi).on("drag.force",b).on("dragend.force",Ti)),!arguments.length)return e;this.on("mouseover.force",zi).on("mouseout.force",Ei).call(e)},t.rebind(s,l,"on")};var Ni=20,ji=1,Li=1/0;function Pi(n,e){return t.rebind(n,e,"sort","children","value"),n.nodes=n,n.links=Oi,n}function Ci(t,n){for(var e=[t];null!=(t=e.pop());)if(n(t),(a=t.children)&&(r=a.length))for(var r,a;--r>=0;)e.push(a[r])}function Di(t,n){for(var e=[t],r=[];null!=(t=e.pop());)if(r.push(t),(i=t.children)&&(a=i.length))for(var a,i,o=-1;++o<a;)e.push(i[o]);for(;null!=(t=r.pop());)n(t)}function Ii(t){return t.children}function Ri(t){return t.value}function Fi(t,n){return n.value-t.value}function Oi(n){return t.merge(n.map(function(t){return(t.children||[]).map(function(n){return{source:t,target:n}})}))}t.layout.hierarchy=function(){var t=Fi,n=Ii,e=Ri;function r(a){var i,o=[a],s=[];for(a.depth=0;null!=(i=o.pop());)if(s.push(i),(u=n.call(r,i,i.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)o.push(c=u[l]),c.parent=i,c.depth=i.depth+1;e&&(i.value=0),i.children=u}else e&&(i.value=+e.call(r,i,i.depth)||0),delete i.children;return Di(a,function(n){var r,a;t&&(r=n.children)&&r.sort(t),e&&(a=n.parent)&&(a.value+=n.value)}),s}return r.sort=function(n){return arguments.length?(t=n,r):t},r.children=function(t){return arguments.length?(n=t,r):n},r.value=function(t){return arguments.length?(e=t,r):e},r.revalue=function(t){return e&&(Ci(t,function(t){t.children&&(t.value=0)}),Di(t,function(t){var n;t.children||(t.value=+e.call(r,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)})),t},r},t.layout.partition=function(){var n=t.layout.hierarchy(),e=[1,1];function r(t,n,e,a){var i=t.children;if(t.x=n,t.y=t.depth*a,t.dx=e,t.dy=a,i&&(o=i.length)){var o,s,l,u=-1;for(e=t.value?e/t.value:0;++u<o;)r(s=i[u],n,l=s.value*e,a),n+=l}}function a(t){var n=t.children,e=0;if(n&&(r=n.length))for(var r,i=-1;++i<r;)e=Math.max(e,a(n[i]));return 1+e}function i(t,i){var o=n.call(this,t,i);return r(o[0],0,e[0],e[1]/a(o[0])),o}return i.size=function(t){return arguments.length?(e=t,i):e},Pi(i,n)},t.layout.pie=function(){var n=Number,e=Ui,r=0,a=qt,i=0;function o(s){var l,u=s.length,c=s.map(function(t,e){return+n.call(o,t,e)}),h=+("function"==typeof r?r.apply(this,arguments):r),f=("function"==typeof a?a.apply(this,arguments):a)-h,p=Math.min(Math.abs(f)/u,+("function"==typeof i?i.apply(this,arguments):i)),d=p*(f<0?-1:1),g=t.sum(c),v=g?(f-u*d)/g:0,M=t.range(u),m=[];return null!=e&&M.sort(e===Ui?function(t,n){return c[n]-c[t]}:function(t,n){return e(s[t],s[n])}),M.forEach(function(t){m[t]={data:s[t],value:l=c[t],startAngle:h,endAngle:h+=l*v+d,padAngle:p}}),m}return o.value=function(t){return arguments.length?(n=t,o):n},o.sort=function(t){return arguments.length?(e=t,o):e},o.startAngle=function(t){return arguments.length?(r=t,o):r},o.endAngle=function(t){return arguments.length?(a=t,o):a},o.padAngle=function(t){return arguments.length?(i=t,o):i},o};var Ui={};function Hi(t){return t.x}function Bi(t){return t.y}function Qi(t,n,e){t.y0=n,t.y=e}t.layout.stack=function(){var n=E,e=Yi,r=Wi,a=Qi,i=Hi,o=Bi;function s(l,u){if(!(p=l.length))return l;var c=l.map(function(t,e){return n.call(s,t,e)}),h=c.map(function(t){return t.map(function(t,n){return[i.call(s,t,n),o.call(s,t,n)]})}),f=e.call(s,h,u);c=t.permute(c,f),h=t.permute(h,f);var p,d,g,v,M=r.call(s,h,u),m=c[0].length;for(g=0;g<m;++g)for(a.call(s,c[0][g],v=M[g],h[0][g][1]),d=1;d<p;++d)a.call(s,c[d][g],v+=h[d-1][g][1],h[d][g][1]);return l}return s.values=function(t){return arguments.length?(n=t,s):n},s.order=function(t){return arguments.length?(e="function"==typeof t?t:Vi.get(t)||Yi,s):e},s.offset=function(t){return arguments.length?(r="function"==typeof t?t:Gi.get(t)||Wi,s):r},s.x=function(t){return arguments.length?(i=t,s):i},s.y=function(t){return arguments.length?(o=t,s):o},s.out=function(t){return arguments.length?(a=t,s):a},s};var Vi=t.map({"inside-out":function(n){var e,r,a=n.length,i=n.map($i),o=n.map(Zi),s=t.range(a).sort(function(t,n){return i[t]-i[n]}),l=0,u=0,c=[],h=[];for(e=0;e<a;++e)r=s[e],l<u?(l+=o[r],c.push(r)):(u+=o[r],h.push(r));return h.reverse().concat(c)},reverse:function(n){return t.range(n.length).reverse()},default:Yi}),Gi=t.map({silhouette:function(t){var n,e,r,a=t.length,i=t[0].length,o=[],s=0,l=[];for(e=0;e<i;++e){for(n=0,r=0;n<a;n++)r+=t[n][e][1];r>s&&(s=r),o.push(r)}for(e=0;e<i;++e)l[e]=(s-o[e])/2;return l},wiggle:function(t){var n,e,r,a,i,o,s,l,u,c=t.length,h=t[0],f=h.length,p=[];for(p[0]=l=u=0,e=1;e<f;++e){for(n=0,a=0;n<c;++n)a+=t[n][e][1];for(n=0,i=0,s=h[e][0]-h[e-1][0];n<c;++n){for(r=0,o=(t[n][e][1]-t[n][e-1][1])/(2*s);r<n;++r)o+=(t[r][e][1]-t[r][e-1][1])/s;i+=o*t[n][e][1]}p[e]=l-=a?i/a*s:0,l<u&&(u=l)}for(e=0;e<f;++e)p[e]-=u;return p},expand:function(t){var n,e,r,a=t.length,i=t[0].length,o=1/a,s=[];for(e=0;e<i;++e){for(n=0,r=0;n<a;n++)r+=t[n][e][1];if(r)for(n=0;n<a;n++)t[n][e][1]/=r;else for(n=0;n<a;n++)t[n][e][1]=o}for(e=0;e<i;++e)s[e]=0;return s},zero:Wi});function Yi(n){return t.range(n.length)}function Wi(t){for(var n=-1,e=t[0].length,r=[];++n<e;)r[n]=0;return r}function $i(t){for(var n,e=1,r=0,a=t[0][1],i=t.length;e<i;++e)(n=t[e][1])>a&&(r=e,a=n);return r}function Zi(t){return t.reduce(Xi,0)}function Xi(t,n){return t+n[1]}function Ji(t,n){return Ki(t,Math.ceil(Math.log(n.length)/Math.LN2+1))}function Ki(t,n){for(var e=-1,r=+t[0],a=(t[1]-r)/n,i=[];++e<=n;)i[e]=a*e+r;return i}function to(n){return[t.min(n),t.max(n)]}function no(t,n){return t.value-n.value}function eo(t,n){var e=t._pack_next;t._pack_next=n,n._pack_prev=t,n._pack_next=e,e._pack_prev=n}function ro(t,n){t._pack_next=n,n._pack_prev=t}function ao(t,n){var e=n.x-t.x,r=n.y-t.y,a=t.r+n.r;return.999*a*a>e*e+r*r}function io(t){if((n=t.children)&&(l=n.length)){var n,e,r,a,i,o,s,l,u=1/0,c=-1/0,h=1/0,f=-1/0;if(n.forEach(oo),(e=n[0]).x=-e.r,e.y=0,y(e),l>1&&((r=n[1]).x=r.r,r.y=0,y(r),l>2))for(uo(e,r,a=n[2]),y(a),eo(e,a),e._pack_prev=a,eo(a,r),r=e._pack_next,i=3;i<l;i++){uo(e,r,a=n[i]);var p=0,d=1,g=1;for(o=r._pack_next;o!==r;o=o._pack_next,d++)if(ao(o,a)){p=1;break}if(1==p)for(s=e._pack_prev;s!==o._pack_prev&&!ao(s,a);s=s._pack_prev,g++);p?(d<g||d==g&&r.r<e.r?ro(e,r=o):ro(e=s,r),i--):(eo(e,a),r=a,y(a))}var v=(u+c)/2,M=(h+f)/2,m=0;for(i=0;i<l;i++)(a=n[i]).x-=v,a.y-=M,m=Math.max(m,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=m,n.forEach(so)}function y(t){u=Math.min(t.x-t.r,u),c=Math.max(t.x+t.r,c),h=Math.min(t.y-t.r,h),f=Math.max(t.y+t.r,f)}}function oo(t){t._pack_next=t._pack_prev=t}function so(t){delete t._pack_next,delete t._pack_prev}function lo(t,n,e,r){var a=t.children;if(t.x=n+=r*t.x,t.y=e+=r*t.y,t.r*=r,a)for(var i=-1,o=a.length;++i<o;)lo(a[i],n,e,r)}function uo(t,n,e){var r=t.r+e.r,a=n.x-t.x,i=n.y-t.y;if(r&&(a||i)){var o=n.r+e.r,s=a*a+i*i,l=.5+((r*=r)-(o*=o))/(2*s),u=Math.sqrt(Math.max(0,2*o*(r+s)-(r-=s)*r-o*o))/(2*s);e.x=t.x+l*a+u*i,e.y=t.y+l*i-u*a}else e.x=t.x+r,e.y=t.y}function co(t,n){return t.parent==n.parent?1:2}function ho(t){var n=t.children;return n.length?n[0]:t.t}function fo(t){var n,e=t.children;return(n=e.length)?e[n-1]:t.t}function po(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function go(t,n,e){return t.a.parent===n.parent?t.a:e}function vo(t){var n=t.children;return n&&n.length?vo(n[0]):t}function Mo(t){var n,e=t.children;return e&&(n=e.length)?Mo(e[n-1]):t}function mo(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function yo(t,n){var e=t.x+n[3],r=t.y+n[0],a=t.dx-n[1]-n[3],i=t.dy-n[0]-n[2];return a<0&&(e+=a/2,a=0),i<0&&(r+=i/2,i=0),{x:e,y:r,dx:a,dy:i}}function bo(t){var n=t[0],e=t[t.length-1];return n<e?[n,e]:[e,n]}function wo(t){return t.rangeExtent?t.rangeExtent():bo(t.range())}function xo(t,n,e,r){var a=e(t[0],t[1]),i=r(n[0],n[1]);return function(t){return i(a(t))}}function ko(t,n){var e,r=0,a=t.length-1,i=t[r],o=t[a];return o<i&&(e=r,r=a,a=e,e=i,i=o,o=e),t[r]=n.floor(i),t[a]=n.ceil(o),t}function So(t){return t?{floor:function(n){return Math.floor(n/t)*t},ceil:function(n){return Math.ceil(n/t)*t}}:_o}t.layout.histogram=function(){var n=!0,e=Number,r=to,a=Ji;function i(i,o){for(var s,l,u=[],c=i.map(e,this),h=r.call(this,c,o),f=a.call(this,h,c,o),p=(o=-1,c.length),d=f.length-1,g=n?1:1/p;++o<d;)(s=u[o]=[]).dx=f[o+1]-(s.x=f[o]),s.y=0;if(d>0)for(o=-1;++o<p;)(l=c[o])>=h[0]&&l<=h[1]&&((s=u[t.bisect(f,l,1,d)-1]).y+=g,s.push(i[o]));return u}return i.value=function(t){return arguments.length?(e=t,i):e},i.range=function(t){return arguments.length?(r=vn(t),i):r},i.bins=function(t){return arguments.length?(a="number"==typeof t?function(n){return Ki(n,t)}:vn(t),i):a},i.frequency=function(t){return arguments.length?(n=!!t,i):n},i},t.layout.pack=function(){var n,e=t.layout.hierarchy().sort(no),r=0,a=[1,1];function i(t,i){var o=e.call(this,t,i),s=o[0],l=a[0],u=a[1],c=null==n?Math.sqrt:"function"==typeof n?n:function(){return n};if(s.x=s.y=0,Di(s,function(t){t.r=+c(t.value)}),Di(s,io),r){var h=r*(n?1:Math.max(2*s.r/l,2*s.r/u))/2;Di(s,function(t){t.r+=h}),Di(s,io),Di(s,function(t){t.r-=h})}return lo(s,l/2,u/2,n?1:1/Math.max(2*s.r/l,2*s.r/u)),o}return i.size=function(t){return arguments.length?(a=t,i):a},i.radius=function(t){return arguments.length?(n=null==t||"function"==typeof t?t:+t,i):n},i.padding=function(t){return arguments.length?(r=+t,i):r},Pi(i,e)},t.layout.tree=function(){var n=t.layout.hierarchy().sort(null).value(null),e=co,r=[1,1],a=null;function i(t,i){var u=n.call(this,t,i),c=u[0],h=function(t){for(var n,e={A:null,children:[t]},r=[e];null!=(n=r.pop());)for(var a,i=n.children,o=0,s=i.length;o<s;++o)r.push((i[o]=a={_:i[o],parent:n,children:(a=i[o].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=a);return e.children[0]}(c);if(Di(h,o),h.parent.m=-h.z,Ci(h,s),a)Ci(c,l);else{var f=c,p=c,d=c;Ci(c,function(t){t.x<f.x&&(f=t),t.x>p.x&&(p=t),t.depth>d.depth&&(d=t)});var g=e(f,p)/2-f.x,v=r[0]/(p.x+e(p,f)/2+g),M=r[1]/(d.depth||1);Ci(c,function(t){t.x=(t.x+g)*v,t.y=t.depth*M})}return u}function o(t){var n=t.children,r=t.parent.children,a=t.i?r[t.i-1]:null;if(n.length){!function(t){for(var n,e=0,r=0,a=t.children,i=a.length;--i>=0;)(n=a[i]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(t);var i=(n[0].z+n[n.length-1].z)/2;a?(t.z=a.z+e(t._,a._),t.m=t.z-i):t.z=i}else a&&(t.z=a.z+e(t._,a._));t.parent.A=function(t,n,r){if(n){for(var a,i=t,o=t,s=n,l=i.parent.children[0],u=i.m,c=o.m,h=s.m,f=l.m;s=fo(s),i=ho(i),s&&i;)l=ho(l),(o=fo(o)).a=t,(a=s.z+h-i.z-u+e(s._,i._))>0&&(po(go(s,t,r),t,a),u+=a,c+=a),h+=s.m,u+=i.m,f+=l.m,c+=o.m;s&&!fo(o)&&(o.t=s,o.m+=h-c),i&&!ho(l)&&(l.t=i,l.m+=u-f,r=t)}return r}(t,a,t.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=r[0],t.y=t.depth*r[1]}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(t){return arguments.length?(a=null==(r=t)?l:null,i):a?null:r},i.nodeSize=function(t){return arguments.length?(a=null==(r=t)?null:l,i):a?r:null},Pi(i,n)},t.layout.cluster=function(){var n=t.layout.hierarchy().sort(null).value(null),e=co,r=[1,1],a=!1;function i(i,o){var s,l=n.call(this,i,o),u=l[0],c=0;Di(u,function(n){var r=n.children;r&&r.length?(n.x=function(t){return t.reduce(function(t,n){return t+n.x},0)/t.length}(r),n.y=function(n){return 1+t.max(n,function(t){return t.y})}(r)):(n.x=s?c+=e(n,s):0,n.y=0,s=n)});var h=vo(u),f=Mo(u),p=h.x-e(h,f)/2,d=f.x+e(f,h)/2;return Di(u,a?function(t){t.x=(t.x-u.x)*r[0],t.y=(u.y-t.y)*r[1]}:function(t){t.x=(t.x-p)/(d-p)*r[0],t.y=(1-(u.y?t.y/u.y:1))*r[1]}),l}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(t){return arguments.length?(a=null==(r=t),i):a?null:r},i.nodeSize=function(t){return arguments.length?(a=null!=(r=t),i):a?r:null},Pi(i,n)},t.layout.treemap=function(){var n,e=t.layout.hierarchy(),r=Math.round,a=[1,1],i=null,o=mo,s=!1,l="squarify",u=.5*(1+Math.sqrt(5));function c(t,n){for(var e,r,a=-1,i=t.length;++a<i;)r=(e=t[a]).value*(n<0?0:n),e.area=isNaN(r)||r<=0?0:r}function h(t){var n=t.children;if(n&&n.length){var e,r,a,i=o(t),s=[],u=n.slice(),f=1/0,g="slice"===l?i.dx:"dice"===l?i.dy:"slice-dice"===l?1&t.depth?i.dy:i.dx:Math.min(i.dx,i.dy);for(c(u,i.dx*i.dy/t.value),s.area=0;(a=u.length)>0;)s.push(e=u[a-1]),s.area+=e.area,"squarify"!==l||(r=p(s,g))<=f?(u.pop(),f=r):(s.area-=s.pop().area,d(s,g,i,!1),g=Math.min(i.dx,i.dy),s.length=s.area=0,f=1/0);s.length&&(d(s,g,i,!0),s.length=s.area=0),n.forEach(h)}}function f(t){var n=t.children;if(n&&n.length){var e,r=o(t),a=n.slice(),i=[];for(c(a,r.dx*r.dy/t.value),i.area=0;e=a.pop();)i.push(e),i.area+=e.area,null!=e.z&&(d(i,e.z?r.dx:r.dy,r,!a.length),i.length=i.area=0);n.forEach(f)}}function p(t,n){for(var e,r=t.area,a=0,i=1/0,o=-1,s=t.length;++o<s;)(e=t[o].area)&&(e<i&&(i=e),e>a&&(a=e));return n*=n,(r*=r)?Math.max(n*a*u/r,r/(n*i*u)):1/0}function d(t,n,e,a){var i,o=-1,s=t.length,l=e.x,u=e.y,c=n?r(t.area/n):0;if(n==e.dx){for((a||c>e.dy)&&(c=e.dy);++o<s;)(i=t[o]).x=l,i.y=u,i.dy=c,l+=i.dx=Math.min(e.x+e.dx-l,c?r(i.area/c):0);i.z=!0,i.dx+=e.x+e.dx-l,e.y+=c,e.dy-=c}else{for((a||c>e.dx)&&(c=e.dx);++o<s;)(i=t[o]).x=l,i.y=u,i.dx=c,u+=i.dy=Math.min(e.y+e.dy-u,c?r(i.area/c):0);i.z=!1,i.dy+=e.y+e.dy-u,e.x+=c,e.dx-=c}}function g(t){var r=n||e(t),i=r[0];return i.x=i.y=0,i.value?(i.dx=a[0],i.dy=a[1]):i.dx=i.dy=0,n&&e.revalue(i),c([i],i.dx*i.dy/i.value),(n?f:h)(i),s&&(n=r),r}return g.size=function(t){return arguments.length?(a=t,g):a},g.padding=function(t){if(!arguments.length)return i;function n(n){var e=t.call(g,n,n.depth);return null==e?mo(n):yo(n,"number"==typeof e?[e,e,e,e]:e)}function e(n){return yo(n,t)}var r;return o=null==(i=t)?mo:"function"==(r=typeof t)?n:"number"===r?(t=[t,t,t,t],e):e,g},g.round=function(t){return arguments.length?(r=t?Math.round:Number,g):r!=Number},g.sticky=function(t){return arguments.length?(s=t,n=null,g):s},g.ratio=function(t){return arguments.length?(u=t,g):u},g.mode=function(t){return arguments.length?(l=t+"",g):l},Pi(g,e)},t.random={normal:function(t,n){var e=arguments.length;return e<2&&(n=1),e<1&&(t=0),function(){var e,r,a;do{a=(e=2*Math.random()-1)*e+(r=2*Math.random()-1)*r}while(!a||a>1);return t+n*e*Math.sqrt(-2*Math.log(a)/a)}},logNormal:function(){var n=t.random.normal.apply(t,arguments);return function(){return Math.exp(n())}},bates:function(n){var e=t.random.irwinHall(n);return function(){return e()/n}},irwinHall:function(t){return function(){for(var n=0,e=0;e<t;e++)n+=Math.random();return n}}},t.scale={};var _o={floor:E,ceil:E};function qo(n,e,r,a){var i=[],o=[],s=0,l=Math.min(n.length,e.length)-1;for(n[l]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++s<=l;)i.push(r(n[s-1],n[s])),o.push(a(e[s-1],e[s]));return function(e){var r=t.bisect(n,e,1,l)-1;return o[r](i[r](e))}}function To(t,n,e,r){var a,i;function o(){var o=Math.min(t.length,n.length)>2?qo:xo,l=r?ki:xi;return a=o(t,n,l,e),i=o(n,t,l,ti),s}function s(t){return a(t)}return s.invert=function(t){return i(t)},s.domain=function(n){return arguments.length?(t=n.map(Number),o()):t},s.range=function(t){return arguments.length?(n=t,o()):n},s.rangeRound=function(t){return s.range(t).interpolate(gi)},s.clamp=function(t){return arguments.length?(r=t,o()):r},s.interpolate=function(t){return arguments.length?(e=t,o()):e},s.ticks=function(n){return No(t,n)},s.tickFormat=function(n,e){return jo(t,n,e)},s.nice=function(n){return Eo(t,n),o()},s.copy=function(){return To(t,n,e,r)},o()}function zo(n,e){return t.rebind(n,e,"range","rangeRound","interpolate","clamp")}function Eo(t,n){return ko(t,So(Ao(t,n)[2])),ko(t,So(Ao(t,n)[2])),t}function Ao(t,n){null==n&&(n=10);var e=bo(t),r=e[1]-e[0],a=Math.pow(10,Math.floor(Math.log(r/n)/Math.LN10)),i=n/r*a;return i<=.15?a*=10:i<=.35?a*=5:i<=.75&&(a*=2),e[0]=Math.ceil(e[0]/a)*a,e[1]=Math.floor(e[1]/a)*a+.5*a,e[2]=a,e}function No(n,e){return t.range.apply(t,Ao(n,e))}function jo(n,e,r){var a=Ao(n,e);if(r){var i=Nn.exec(r);if(i.shift(),"s"===i[8]){var o=t.formatPrefix(Math.max(M(a[0]),M(a[1])));return i[7]||(i[7]="."+Po(o.scale(a[2]))),i[8]="f",r=t.format(i.join("")),function(t){return r(o.scale(t))+o.symbol}}i[7]||(i[7]="."+function(t,n){var e=Po(n[2]);return t in Lo?Math.abs(e-Po(Math.max(M(n[0]),M(n[1]))))+ +("e"!==t):e-2*("%"===t)}(i[8],a)),r=i.join("")}else r=",."+Po(a[2])+"f";return t.format(r)}t.scale.linear=function(){return To([0,1],[0,1],ti,!1)};var Lo={s:1,g:1,p:1,r:1,e:1};function Po(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Co(n,e,r,a){function i(t){return(r?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return r?Math.pow(e,t):-Math.pow(e,-t)}function s(t){return n(i(t))}return s.invert=function(t){return o(n.invert(t))},s.domain=function(t){return arguments.length?(r=t[0]>=0,n.domain((a=t.map(Number)).map(i)),s):a},s.base=function(t){return arguments.length?(e=+t,n.domain(a.map(i)),s):e},s.nice=function(){var t=ko(a.map(i),r?Math:Io);return n.domain(t),a=t.map(o),s},s.ticks=function(){var t=bo(a),n=[],s=t[0],l=t[1],u=Math.floor(i(s)),c=Math.ceil(i(l)),h=e%1?2:e;if(isFinite(c-u)){if(r){for(;u<c;u++)for(var f=1;f<h;f++)n.push(o(u)*f);n.push(o(u))}else for(n.push(o(u));u++<c;)for(f=h-1;f>0;f--)n.push(o(u)*f);for(u=0;n[u]<s;u++);for(c=n.length;n[c-1]>l;c--);n=n.slice(u,c)}return n},s.tickFormat=function(n,r){if(!arguments.length)return Do;arguments.length<2?r=Do:"function"!=typeof r&&(r=t.format(r));var a=Math.max(1,e*n/s.ticks().length);return function(t){var n=t/o(Math.round(i(t)));return n*e<e-.5&&(n*=e),n<=a?r(t):""}},s.copy=function(){return Co(n.copy(),e,r,a)},zo(s,n)}t.scale.log=function(){return Co(t.scale.linear().domain([0,1]),10,!0,[1,10])};var Do=t.format(".0e"),Io={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function Ro(t,n,e){var r=Fo(n),a=Fo(1/n);function i(n){return t(r(n))}return i.invert=function(n){return a(t.invert(n))},i.domain=function(n){return arguments.length?(t.domain((e=n.map(Number)).map(r)),i):e},i.ticks=function(t){return No(e,t)},i.tickFormat=function(t,n){return jo(e,t,n)},i.nice=function(t){return i.domain(Eo(e,t))},i.exponent=function(o){return arguments.length?(r=Fo(n=o),a=Fo(1/n),t.domain(e.map(r)),i):n},i.copy=function(){return Ro(t.copy(),n,e)},zo(i,t)}function Fo(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function Oo(n,e){var r,a,i;function o(t){return a[((r.get(t)||("range"===e.t?r.set(t,n.push(t)):NaN))-1)%a.length]}function s(e,r){return t.range(n.length).map(function(t){return e+r*t})}return o.domain=function(t){if(!arguments.length)return n;n=[],r=new b;for(var a,i=-1,s=t.length;++i<s;)r.has(a=t[i])||r.set(a,n.push(a));return o[e.t].apply(o,e.a)},o.range=function(t){return arguments.length?(a=t,i=0,e={t:"range",a:arguments},o):a},o.rangePoints=function(t,r){arguments.length<2&&(r=0);var l=t[0],u=t[1],c=n.length<2?(l=(l+u)/2,0):(u-l)/(n.length-1+r);return a=s(l+c*r/2,c),i=0,e={t:"rangePoints",a:arguments},o},o.rangeRoundPoints=function(t,r){arguments.length<2&&(r=0);var l=t[0],u=t[1],c=n.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(n.length-1+r)|0;return a=s(l+Math.round(c*r/2+(u-l-(n.length-1+r)*c)/2),c),i=0,e={t:"rangeRoundPoints",a:arguments},o},o.rangeBands=function(t,r,l){arguments.length<2&&(r=0),arguments.length<3&&(l=r);var u=t[1]<t[0],c=t[u-0],h=t[1-u],f=(h-c)/(n.length-r+2*l);return a=s(c+f*l,f),u&&a.reverse(),i=f*(1-r),e={t:"rangeBands",a:arguments},o},o.rangeRoundBands=function(t,r,l){arguments.length<2&&(r=0),arguments.length<3&&(l=r);var u=t[1]<t[0],c=t[u-0],h=t[1-u],f=Math.floor((h-c)/(n.length-r+2*l));return a=s(c+Math.round((h-c-(n.length-r)*f)/2),f),u&&a.reverse(),i=Math.round(f*(1-r)),e={t:"rangeRoundBands",a:arguments},o},o.rangeBand=function(){return i},o.rangeExtent=function(){return bo(e.a[0])},o.copy=function(){return Oo(n,e)},o.domain(n)}t.scale.pow=function(){return Ro(t.scale.linear(),1,[0,1])},t.scale.sqrt=function(){return t.scale.pow().exponent(.5)},t.scale.ordinal=function(){return Oo([],{t:"range",a:[[]]})},t.scale.category10=function(){return t.scale.ordinal().range(Uo)},t.scale.category20=function(){return t.scale.ordinal().range(Ho)},t.scale.category20b=function(){return t.scale.ordinal().range(Bo)},t.scale.category20c=function(){return t.scale.ordinal().range(Qo)};var Uo=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(sn),Ho=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(sn),Bo=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(sn),Qo=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(sn);function Vo(n,e){var r;function a(){var a=0,o=e.length;for(r=[];++a<o;)r[a-1]=t.quantile(n,a/o);return i}function i(n){if(!isNaN(n=+n))return e[t.bisect(r,n)]}return i.domain=function(t){return arguments.length?(n=t.map(f).filter(p).sort(h),a()):n},i.range=function(t){return arguments.length?(e=t,a()):e},i.quantiles=function(){return r},i.invertExtent=function(t){return(t=e.indexOf(t))<0?[NaN,NaN]:[t>0?r[t-1]:n[0],t<r.length?r[t]:n[n.length-1]]},i.copy=function(){return Vo(n,e)},a()}function Go(t,n,e){var r,a;function i(n){return e[Math.max(0,Math.min(a,Math.floor(r*(n-t))))]}function o(){return r=e.length/(n-t),a=e.length-1,i}return i.domain=function(e){return arguments.length?(t=+e[0],n=+e[e.length-1],o()):[t,n]},i.range=function(t){return arguments.length?(e=t,o()):e},i.invertExtent=function(n){return[n=(n=e.indexOf(n))<0?NaN:n/r+t,n+1/r]},i.copy=function(){return Go(t,n,e)},o()}function Yo(n,e){function r(r){if(r<=r)return e[t.bisect(n,r)]}return r.domain=function(t){return arguments.length?(n=t,r):n},r.range=function(t){return arguments.length?(e=t,r):e},r.invertExtent=function(t){return t=e.indexOf(t),[n[t-1],n[t]]},r.copy=function(){return Yo(n,e)},r}function Wo(t){function n(t){return+t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=e.map(n),n):t},n.ticks=function(n){return No(t,n)},n.tickFormat=function(n,e){return jo(t,n,e)},n.copy=function(){return Wo(t)},n}function $o(){return 0}t.scale.quantile=function(){return Vo([],[])},t.scale.quantize=function(){return Go(0,1,[0,1])},t.scale.threshold=function(){return Yo([.5],[0,1])},t.scale.identity=function(){return Wo([0,1])},t.svg={},t.svg.arc=function(){var t=Xo,n=Jo,e=$o,r=Zo,a=Ko,i=ts,o=ns;function s(){var s=Math.max(0,+t.apply(this,arguments)),u=Math.max(0,+n.apply(this,arguments)),c=a.apply(this,arguments)-zt,h=i.apply(this,arguments)-zt,f=Math.abs(h-c),p=c>h?0:1;if(u<s&&(d=u,u=s,s=d),f>=Tt)return l(u,p)+(s?l(s,1-p):"")+"Z";var d,g,v,M,m,y,b,w,x,k,S,_,q=0,T=0,z=[];if((M=(+o.apply(this,arguments)||0)/2)&&(v=r===Zo?Math.sqrt(s*s+u*u):+r.apply(this,arguments),p||(T*=-1),u&&(T=Pt(v/u*Math.sin(M))),s&&(q=Pt(v/s*Math.sin(M)))),u){m=u*Math.cos(c+T),y=u*Math.sin(c+T),b=u*Math.cos(h-T),w=u*Math.sin(h-T);var E=Math.abs(h-c-2*T)<=_t?0:1;if(T&&es(m,y,b,w)===p^E){var A=(c+h)/2;m=u*Math.cos(A),y=u*Math.sin(A),b=w=null}}else m=y=0;if(s){x=s*Math.cos(h-q),k=s*Math.sin(h-q),S=s*Math.cos(c+q),_=s*Math.sin(c+q);var N=Math.abs(c-h+2*q)<=_t?0:1;if(q&&es(x,k,S,_)===1-p^N){var j=(c+h)/2;x=s*Math.cos(j),k=s*Math.sin(j),S=_=null}}else x=k=0;if(f>kt&&(d=Math.min(Math.abs(u-s)/2,+e.apply(this,arguments)))>.001){g=s<u^p?0:1;var L=d,P=d;if(f<_t){var C=null==S?[x,k]:null==b?[m,y]:ca([m,y],[S,_],[b,w],[x,k]),D=m-C[0],I=y-C[1],R=b-C[0],F=w-C[1],O=1/Math.sin(Math.acos((D*R+I*F)/(Math.sqrt(D*D+I*I)*Math.sqrt(R*R+F*F)))/2),U=Math.sqrt(C[0]*C[0]+C[1]*C[1]);P=Math.min(d,(s-U)/(O-1)),L=Math.min(d,(u-U)/(O+1))}if(null!=b){var H=rs(null==S?[x,k]:[S,_],[m,y],u,L,p),B=rs([b,w],[x,k],u,L,p);d===L?z.push("M",H[0],"A",L,",",L," 0 0,",g," ",H[1],"A",u,",",u," 0 ",1-p^es(H[1][0],H[1][1],B[1][0],B[1][1]),",",p," ",B[1],"A",L,",",L," 0 0,",g," ",B[0]):z.push("M",H[0],"A",L,",",L," 0 1,",g," ",B[0])}else z.push("M",m,",",y);if(null!=S){var Q=rs([m,y],[S,_],s,-P,p),V=rs([x,k],null==b?[m,y]:[b,w],s,-P,p);d===P?z.push("L",V[0],"A",P,",",P," 0 0,",g," ",V[1],"A",s,",",s," 0 ",p^es(V[1][0],V[1][1],Q[1][0],Q[1][1]),",",1-p," ",Q[1],"A",P,",",P," 0 0,",g," ",Q[0]):z.push("L",V[0],"A",P,",",P," 0 0,",g," ",Q[0])}else z.push("L",x,",",k)}else z.push("M",m,",",y),null!=b&&z.push("A",u,",",u," 0 ",E,",",p," ",b,",",w),z.push("L",x,",",k),null!=S&&z.push("A",s,",",s," 0 ",N,",",1-p," ",S,",",_);return z.push("Z"),z.join("")}function l(t,n){return"M0,"+t+"A"+t+","+t+" 0 1,"+n+" 0,"+-t+"A"+t+","+t+" 0 1,"+n+" 0,"+t}return s.innerRadius=function(n){return arguments.length?(t=vn(n),s):t},s.outerRadius=function(t){return arguments.length?(n=vn(t),s):n},s.cornerRadius=function(t){return arguments.length?(e=vn(t),s):e},s.padRadius=function(t){return arguments.length?(r=t==Zo?Zo:vn(t),s):r},s.startAngle=function(t){return arguments.length?(a=vn(t),s):a},s.endAngle=function(t){return arguments.length?(i=vn(t),s):i},s.padAngle=function(t){return arguments.length?(o=vn(t),s):o},s.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-zt;return[Math.cos(r)*e,Math.sin(r)*e]},s};var Zo="auto";function Xo(t){return t.innerRadius}function Jo(t){return t.outerRadius}function Ko(t){return t.startAngle}function ts(t){return t.endAngle}function ns(t){return t&&t.padAngle}function es(t,n,e,r){return(t-e)*n-(n-r)*t>0?0:1}function rs(t,n,e,r,a){var i=t[0]-n[0],o=t[1]-n[1],s=(a?r:-r)/Math.sqrt(i*i+o*o),l=s*o,u=-s*i,c=t[0]+l,h=t[1]+u,f=n[0]+l,p=n[1]+u,d=(c+f)/2,g=(h+p)/2,v=f-c,M=p-h,m=v*v+M*M,y=e-r,b=c*p-f*h,w=(M<0?-1:1)*Math.sqrt(Math.max(0,y*y*m-b*b)),x=(b*M-v*w)/m,k=(-b*v-M*w)/m,S=(b*M+v*w)/m,_=(-b*v+M*w)/m,q=x-d,T=k-g,z=S-d,E=_-g;return q*q+T*T>z*z+E*E&&(x=S,k=_),[[x-l,k-u],[x*e/y,k*e/y]]}function as(t){var n=aa,e=ia,r=We,a=os,i=a.key,o=.7;function s(i){var s,l=[],u=[],c=-1,h=i.length,f=vn(n),p=vn(e);function d(){l.push("M",a(t(u),o))}for(;++c<h;)r.call(this,s=i[c],c)?u.push([+f.call(this,s,c),+p.call(this,s,c)]):u.length&&(d(),u=[]);return u.length&&d(),l.length?l.join(""):null}return s.x=function(t){return arguments.length?(n=t,s):n},s.y=function(t){return arguments.length?(e=t,s):e},s.defined=function(t){return arguments.length?(r=t,s):r},s.interpolate=function(t){return arguments.length?(i="function"==typeof t?a=t:(a=is.get(t)||os).key,s):i},s.tension=function(t){return arguments.length?(o=t,s):o},s}t.svg.line=function(){return as(E)};var is=t.map({linear:os,"linear-closed":ss,step:function(t){for(var n=0,e=t.length,r=t[0],a=[r[0],",",r[1]];++n<e;)a.push("H",(r[0]+(r=t[n])[0])/2,"V",r[1]);return e>1&&a.push("H",r[0]),a.join("")},"step-before":ls,"step-after":us,basis:fs,"basis-open":function(t){if(t.length<4)return os(t);for(var n,e=[],r=-1,a=t.length,i=[0],o=[0];++r<3;)i.push((n=t[r])[0]),o.push(n[1]);for(e.push(ps(vs,i)+","+ps(vs,o)),--r;++r<a;)n=t[r],i.shift(),i.push(n[0]),o.shift(),o.push(n[1]),Ms(e,i,o);return e.join("")},"basis-closed":function(t){for(var n,e,r=-1,a=t.length,i=a+4,o=[],s=[];++r<4;)o.push((e=t[r%a])[0]),s.push(e[1]);for(n=[ps(vs,o),",",ps(vs,s)],--r;++r<i;)e=t[r%a],o.shift(),o.push(e[0]),s.shift(),s.push(e[1]),Ms(n,o,s);return n.join("")},bundle:function(t,n){var e=t.length-1;if(e)for(var r,a,i=t[0][0],o=t[0][1],s=t[e][0]-i,l=t[e][1]-o,u=-1;++u<=e;)(r=t[u])[0]=n*r[0]+(1-n)*(i+(a=u/e)*s),r[1]=n*r[1]+(1-n)*(o+a*l);return fs(t)},cardinal:function(t,n){return t.length<3?os(t):t[0]+cs(t,hs(t,n))},"cardinal-open":function(t,n){return t.length<4?os(t):t[1]+cs(t.slice(1,-1),hs(t,n))},"cardinal-closed":function(t,n){return t.length<3?ss(t):t[0]+cs((t.push(t[0]),t),hs([t[t.length-2]].concat(t,[t[1]]),n))},monotone:function(t){return t.length<3?os(t):t[0]+cs(t,function(t){for(var n,e,r,a,i=[],o=function(t){for(var n=0,e=t.length-1,r=[],a=t[0],i=t[1],o=r[0]=ms(a,i);++n<e;)r[n]=(o+(o=ms(a=i,i=t[n+1])))/2;return r[n]=o,r}(t),s=-1,l=t.length-1;++s<l;)n=ms(t[s],t[s+1]),M(n)<kt?o[s]=o[s+1]=0:(a=(e=o[s]/n)*e+(r=o[s+1]/n)*r)>9&&(a=3*n/Math.sqrt(a),o[s]=a*e,o[s+1]=a*r);for(s=-1;++s<=l;)a=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s])),i.push([a||0,o[s]*a||0]);return i}(t))}});function os(t){return t.length>1?t.join("L"):t+"Z"}function ss(t){return t.join("L")+"Z"}function ls(t){for(var n=0,e=t.length,r=t[0],a=[r[0],",",r[1]];++n<e;)a.push("V",(r=t[n])[1],"H",r[0]);return a.join("")}function us(t){for(var n=0,e=t.length,r=t[0],a=[r[0],",",r[1]];++n<e;)a.push("H",(r=t[n])[0],"V",r[1]);return a.join("")}function cs(t,n){if(n.length<1||t.length!=n.length&&t.length!=n.length+2)return os(t);var e=t.length!=n.length,r="",a=t[0],i=t[1],o=n[0],s=o,l=1;if(e&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],a=t[1],l=2),n.length>1){i=t[l],l++,r+="C"+(a[0]+o[0])+","+(a[1]+o[1])+","+(i[0]-(s=n[1])[0])+","+(i[1]-s[1])+","+i[0]+","+i[1];for(var u=2;u<n.length;u++,l++)r+="S"+((i=t[l])[0]-(s=n[u])[0])+","+(i[1]-s[1])+","+i[0]+","+i[1]}if(e){var c=t[l];r+="Q"+(i[0]+2*s[0]/3)+","+(i[1]+2*s[1]/3)+","+c[0]+","+c[1]}return r}function hs(t,n){for(var e,r=[],a=(1-n)/2,i=t[0],o=t[1],s=1,l=t.length;++s<l;)e=i,i=o,r.push([a*((o=t[s])[0]-e[0]),a*(o[1]-e[1])]);return r}function fs(t){if(t.length<3)return os(t);var n=1,e=t.length,r=t[0],a=r[0],i=r[1],o=[a,a,a,(r=t[1])[0]],s=[i,i,i,r[1]],l=[a,",",i,"L",ps(vs,o),",",ps(vs,s)];for(t.push(t[e-1]);++n<=e;)r=t[n],o.shift(),o.push(r[0]),s.shift(),s.push(r[1]),Ms(l,o,s);return t.pop(),l.push("L",r),l.join("")}function ps(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}is.forEach(function(t,n){n.key=t,n.closed=/-closed$/.test(t)});var ds=[0,2/3,1/3,0],gs=[0,1/3,2/3,0],vs=[0,1/6,2/3,1/6];function Ms(t,n,e){t.push("C",ps(ds,n),",",ps(ds,e),",",ps(gs,n),",",ps(gs,e),",",ps(vs,n),",",ps(vs,e))}function ms(t,n){return(n[1]-t[1])/(n[0]-t[0])}function ys(t){for(var n,e,r,a=-1,i=t.length;++a<i;)r=(n=t[a])[1]-zt,n[0]=(e=n[0])*Math.cos(r),n[1]=e*Math.sin(r);return t}function bs(t){var n=aa,e=aa,r=0,a=ia,i=We,o=os,s=o.key,l=o,u="L",c=.7;function h(s){var h,f,p,d=[],g=[],v=[],M=-1,m=s.length,y=vn(n),b=vn(r),w=n===e?function(){return f}:vn(e),x=r===a?function(){return p}:vn(a);function k(){d.push("M",o(t(v),c),u,l(t(g.reverse()),c),"Z")}for(;++M<m;)i.call(this,h=s[M],M)?(g.push([f=+y.call(this,h,M),p=+b.call(this,h,M)]),v.push([+w.call(this,h,M),+x.call(this,h,M)])):g.length&&(k(),g=[],v=[]);return g.length&&k(),d.length?d.join(""):null}return h.x=function(t){return arguments.length?(n=e=t,h):e},h.x0=function(t){return arguments.length?(n=t,h):n},h.x1=function(t){return arguments.length?(e=t,h):e},h.y=function(t){return arguments.length?(r=a=t,h):a},h.y0=function(t){return arguments.length?(r=t,h):r},h.y1=function(t){return arguments.length?(a=t,h):a},h.defined=function(t){return arguments.length?(i=t,h):i},h.interpolate=function(t){return arguments.length?(s="function"==typeof t?o=t:(o=is.get(t)||os).key,l=o.reverse||o,u=o.closed?"M":"L",h):s},h.tension=function(t){return arguments.length?(c=t,h):c},h}function ws(t){return t.radius}function xs(t){return[t.x,t.y]}function ks(t){return function(){var n=t.apply(this,arguments),e=n[0],r=n[1]-zt;return[e*Math.cos(r),e*Math.sin(r)]}}function Ss(){return 64}function _s(){return"circle"}function qs(t){var n=Math.sqrt(t/_t);return"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z"}t.svg.line.radial=function(){var t=as(ys);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ls.reverse=us,us.reverse=ls,t.svg.area=function(){return bs(E)},t.svg.area.radial=function(){var t=bs(ys);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},t.svg.chord=function(){var t=Qr,n=Vr,e=ws,r=Ko,a=ts;function i(e,r){var a,i,u=o(this,t,e,r),c=o(this,n,e,r);return"M"+u.p0+s(u.r,u.p1,u.a1-u.a0)+((a=u).a0==(i=c).a0&&a.a1==i.a1?l(0,0,0,u.p0):l(0,0,0,c.p0)+s(c.r,c.p1,c.a1-c.a0)+l(0,0,0,u.p0))+"Z"}function o(t,n,i,o){var s=n.call(t,i,o),l=e.call(t,s,o),u=r.call(t,s,o)-zt,c=a.call(t,s,o)-zt;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(t,n,e){return"A"+t+","+t+" 0 "+ +(e>_t)+",1 "+n}function l(t,n,e,r){return"Q 0,0 "+r}return i.radius=function(t){return arguments.length?(e=vn(t),i):e},i.source=function(n){return arguments.length?(t=vn(n),i):t},i.target=function(t){return arguments.length?(n=vn(t),i):n},i.startAngle=function(t){return arguments.length?(r=vn(t),i):r},i.endAngle=function(t){return arguments.length?(a=vn(t),i):a},i},t.svg.diagonal=function(){var t=Qr,n=Vr,e=xs;function r(r,a){var i=t.call(this,r,a),o=n.call(this,r,a),s=(i.y+o.y)/2,l=[i,{x:i.x,y:s},{x:o.x,y:s},o];return"M"+(l=l.map(e))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return r.source=function(n){return arguments.length?(t=vn(n),r):t},r.target=function(t){return arguments.length?(n=vn(t),r):n},r.projection=function(t){return arguments.length?(e=t,r):e},r},t.svg.diagonal.radial=function(){var n=t.svg.diagonal(),e=xs,r=n.projection;return n.projection=function(t){return arguments.length?r(ks(e=t)):e},n},t.svg.symbol=function(){var t=_s,n=Ss;function e(e,r){return(Ts.get(t.call(this,e,r))||qs)(n.call(this,e,r))}return e.type=function(n){return arguments.length?(t=vn(n),e):t},e.size=function(t){return arguments.length?(n=vn(t),e):n},e};var Ts=t.map({circle:qs,cross:function(t){var n=Math.sqrt(t/5)/2;return"M"+-3*n+","+-n+"H"+-n+"V"+-3*n+"H"+n+"V"+-n+"H"+3*n+"V"+n+"H"+n+"V"+3*n+"H"+-n+"V"+n+"H"+-3*n+"Z"},diamond:function(t){var n=Math.sqrt(t/(2*Es)),e=n*Es;return"M0,"+-n+"L"+e+",0 0,"+n+" "+-e+",0Z"},square:function(t){var n=Math.sqrt(t)/2;return"M"+-n+","+-n+"L"+n+","+-n+" "+n+","+n+" "+-n+","+n+"Z"},"triangle-down":function(t){var n=Math.sqrt(t/zs),e=n*zs/2;return"M0,"+e+"L"+n+","+-e+" "+-n+","+-e+"Z"},"triangle-up":function(t){var n=Math.sqrt(t/zs),e=n*zs/2;return"M0,"+-e+"L"+n+","+e+" "+-n+","+e+"Z"}});t.svg.symbolTypes=Ts.keys();var zs=Math.sqrt(3),Es=Math.tan(30*Et);V.transition=function(t){for(var n,e,r=Ls||++Ds,a=Fs(t),i=[],o=Ps||{time:Date.now(),ease:ci,delay:0,duration:250},s=-1,l=this.length;++s<l;){i.push(n=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(e=u[c])&&Os(e,c,a,r,o),n.push(e)}return js(i,a,r)},V.interrupt=function(t){return this.each(null==t?As:Ns(Fs(t)))};var As=Ns(Fs());function Ns(t){return function(){var n,e,r;(n=this[t])&&(r=n[e=n.active])&&(r.timer.c=null,r.timer.t=NaN,--n.count?delete n[e]:delete this[t],n.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function js(t,n,e){return O(t,Cs),t.namespace=n,t.id=e,t}var Ls,Ps,Cs=[],Ds=0;function Is(t,n,e,r){var a=t.id,i=t.namespace;return ut(t,"function"==typeof e?function(t,o,s){t[i][a].tween.set(n,r(e.call(t,t.__data__,o,s)))}:(e=r(e),function(t){t[i][a].tween.set(n,e)}))}function Rs(t){return null==t&&(t=""),function(){this.textContent=t}}function Fs(t){return null==t?"__transition__":"__transition_"+t+"__"}function Os(t,n,e,r,a){var i,o,s,l,u,c=t[e]||(t[e]={active:0,count:0}),h=c[r];function f(e){var a=c.active,f=c[a];for(var d in f&&(f.timer.c=null,f.timer.t=NaN,--c.count,delete c[a],f.event&&f.event.interrupt.call(t,t.__data__,f.index)),c)if(+d<r){var g=c[d];g.timer.c=null,g.timer.t=NaN,--c.count,delete c[d]}o.c=p,Sn(function(){return o.c&&p(e||1)&&(o.c=null,o.t=NaN),1},0,i),c.active=r,h.event&&h.event.start.call(t,t.__data__,n),u=[],h.tween.forEach(function(e,r){(r=r.call(t,t.__data__,n))&&u.push(r)}),l=h.ease,s=h.duration}function p(a){for(var i=a/s,o=l(i),f=u.length;f>0;)u[--f].call(t,o);if(i>=1)return h.event&&h.event.end.call(t,t.__data__,n),--c.count?delete c[r]:delete t[e],1}h||(o=Sn(function(t){var n=h.delay;if(o.t=n+i,n<=t)return f(t-n);o.c=f},0,i=a.time),h=c[r]={tween:new b,time:i,timer:o,delay:a.delay,duration:a.duration,ease:a.ease,index:n},a=null,++c.count)}Cs.call=V.call,Cs.empty=V.empty,Cs.node=V.node,Cs.size=V.size,t.transition=function(n,e){return n&&n.transition?Ls?n.transition(e):n:t.selection().transition(n)},t.transition.prototype=Cs,Cs.select=function(t){var n,e,r,a=this.id,i=this.namespace,o=[];t=G(t);for(var s=-1,l=this.length;++s<l;){o.push(n=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(r=u[c])&&(e=t.call(r,r.__data__,c,s))?("__data__"in r&&(e.__data__=r.__data__),Os(e,c,i,a,r[i][a]),n.push(e)):n.push(null)}return js(o,i,a)},Cs.selectAll=function(t){var n,e,r,a,i,o=this.id,s=this.namespace,l=[];t=Y(t);for(var u=-1,c=this.length;++u<c;)for(var h=this[u],f=-1,p=h.length;++f<p;)if(r=h[f]){i=r[s][o],e=t.call(r,r.__data__,f,u),l.push(n=[]);for(var d=-1,g=e.length;++d<g;)(a=e[d])&&Os(a,d,s,o,i),n.push(a)}return js(l,s,o)},Cs.filter=function(t){var n,e,r=[];"function"!=typeof t&&(t=st(t));for(var a=0,i=this.length;a<i;a++){r.push(n=[]);for(var o,s=0,l=(o=this[a]).length;s<l;s++)(e=o[s])&&t.call(e,e.__data__,s,a)&&n.push(e)}return js(r,this.namespace,this.id)},Cs.tween=function(t,n){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(t):ut(this,null==n?function(n){n[r][e].tween.remove(t)}:function(a){a[r][e].tween.set(t,n)})},Cs.attr=function(n,e){if(arguments.length<2){for(e in n)this.attr(e,n[e]);return this}var r="transform"==n?wi:ti,a=t.ns.qualify(n);function i(){this.removeAttribute(a)}function o(){this.removeAttributeNS(a.space,a.local)}function s(t){return null==t?i:(t+="",function(){var n,e=this.getAttribute(a);return e!==t&&(n=r(e,t),function(t){this.setAttribute(a,n(t))})})}function l(t){return null==t?o:(t+="",function(){var n,e=this.getAttributeNS(a.space,a.local);return e!==t&&(n=r(e,t),function(t){this.setAttributeNS(a.space,a.local,n(t))})})}return Is(this,"attr."+n,e,a.local?l:s)},Cs.attrTween=function(n,e){var r=t.ns.qualify(n);return this.tween("attr."+n,r.local?function(t,n){var a=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return a&&function(t){this.setAttributeNS(r.space,r.local,a(t))}}:function(t,n){var a=e.call(this,t,n,this.getAttribute(r));return a&&function(t){this.setAttribute(r,a(t))}})},Cs.style=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=""),t)this.style(e,t[e],n);return this}e=""}function a(){this.style.removeProperty(t)}function o(n){return null==n?a:(n+="",function(){var r,a=i(this).getComputedStyle(this,null).getPropertyValue(t);return a!==n&&(r=ti(a,n),function(n){this.style.setProperty(t,r(n),e)})})}return Is(this,"style."+t,n,o)},Cs.styleTween=function(t,n,e){function r(r,a){var o=n.call(this,r,a,i(this).getComputedStyle(this,null).getPropertyValue(t));return o&&function(n){this.style.setProperty(t,o(n),e)}}return arguments.length<3&&(e=""),this.tween("style."+t,r)},Cs.text=function(t){return Is(this,"text",t,Rs)},Cs.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var n;this[t].count<2&&(n=this.parentNode)&&n.removeChild(this)})},Cs.ease=function(n){var e=this.id,r=this.namespace;return arguments.length<1?this.node()[r][e].ease:("function"!=typeof n&&(n=t.ease.apply(t,arguments)),ut(this,function(t){t[r][e].ease=n}))},Cs.delay=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].delay:ut(this,"function"==typeof t?function(r,a,i){r[e][n].delay=+t.call(r,r.__data__,a,i)}:(t=+t,function(r){r[e][n].delay=t}))},Cs.duration=function(t){var n=this.id,e=this.namespace;return arguments.length<1?this.node()[e][n].duration:ut(this,"function"==typeof t?function(r,a,i){r[e][n].duration=Math.max(1,t.call(r,r.__data__,a,i))}:(t=Math.max(1,t),function(r){r[e][n].duration=t}))},Cs.each=function(n,e){var r=this.id,a=this.namespace;if(arguments.length<2){var i=Ps,o=Ls;try{Ls=r,ut(this,function(t,e,i){Ps=t[a][r],n.call(t,t.__data__,e,i)})}finally{Ps=i,Ls=o}}else ut(this,function(i){var o=i[a][r];(o.event||(o.event=t.dispatch("start","end","interrupt"))).on(n,e)});return this},Cs.transition=function(){for(var t,n,e,r=this.id,a=++Ds,i=this.namespace,o=[],s=0,l=this.length;s<l;s++){o.push(t=[]);for(var u,c=0,h=(u=this[s]).length;c<h;c++)(n=u[c])&&Os(n,c,i,a,{time:(e=n[i][r]).time,ease:e.ease,delay:e.delay+e.duration,duration:e.duration}),t.push(n)}return js(o,i,a)},t.svg.axis=function(){var n,r=t.scale.linear(),a=Us,i=6,o=6,s=3,l=[10],u=null;function c(e){e.each(function(){var e,c=t.select(this),h=this.__chart__||r,f=this.__chart__=r.copy(),p=null==u?f.ticks?f.ticks.apply(f,l):f.domain():u,d=null==n?f.tickFormat?f.tickFormat.apply(f,l):E:n,g=c.selectAll(".tick").data(p,f),v=g.enter().insert("g",".domain").attr("class","tick").style("opacity",kt),M=t.transition(g.exit()).style("opacity",kt).remove(),m=t.transition(g.order()).style("opacity",1),y=Math.max(i,0)+s,b=wo(f),w=c.selectAll(".domain").data([0]),x=(w.enter().append("path").attr("class","domain"),t.transition(w));v.append("line"),v.append("text");var k,S,_,q,T=v.select("line"),z=m.select("line"),A=g.select("text").text(d),N=v.select("text"),j=m.select("text"),L="top"===a||"left"===a?-1:1;if("bottom"===a||"top"===a?(e=Bs,k="x",_="y",S="x2",q="y2",A.attr("dy",L<0?"0em":".71em").style("text-anchor","middle"),x.attr("d","M"+b[0]+","+L*o+"V0H"+b[1]+"V"+L*o)):(e=Qs,k="y",_="x",S="y2",q="x2",A.attr("dy",".32em").style("text-anchor",L<0?"end":"start"),x.attr("d","M"+L*o+","+b[0]+"H0V"+b[1]+"H"+L*o)),T.attr(q,L*i),N.attr(_,L*y),z.attr(S,0).attr(q,L*i),j.attr(k,0).attr(_,L*y),f.rangeBand){var P=f,C=P.rangeBand()/2;h=f=function(t){return P(t)+C}}else h.rangeBand?h=f:M.call(e,f,h);v.call(e,h,f),m.call(e,f,f)})}return c.scale=function(t){return arguments.length?(r=t,c):r},c.orient=function(t){return arguments.length?(a=t in Hs?t+"":Us,c):a},c.ticks=function(){return arguments.length?(l=e(arguments),c):l},c.tickValues=function(t){return arguments.length?(u=t,c):u},c.tickFormat=function(t){return arguments.length?(n=t,c):n},c.tickSize=function(t){var n=arguments.length;return n?(i=+t,o=+arguments[n-1],c):i},c.innerTickSize=function(t){return arguments.length?(i=+t,c):i},c.outerTickSize=function(t){return arguments.length?(o=+t,c):o},c.tickPadding=function(t){return arguments.length?(s=+t,c):s},c.tickSubdivide=function(){return arguments.length&&c},c};var Us="bottom",Hs={top:1,right:1,bottom:1,left:1};function Bs(t,n,e){t.attr("transform",function(t){var r=n(t);return"translate("+(isFinite(r)?r:e(t))+",0)"})}function Qs(t,n,e){t.attr("transform",function(t){var r=n(t);return"translate(0,"+(isFinite(r)?r:e(t))+")"})}t.svg.brush=function(){var n,e,r=R(f,"brushstart","brush","brushend"),a=null,o=null,s=[0,0],l=[0,0],u=!0,c=!0,h=Gs[0];function f(n){n.each(function(){var n=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",v).on("touchstart.brush",v),e=n.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),n.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var r=n.selectAll(".resize").data(h,E);r.exit().remove(),r.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Vs[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),r.style("display",f.empty()?"none":null);var i,s=t.transition(n),l=t.transition(e);a&&(i=wo(a),l.attr("x",i[0]).attr("width",i[1]-i[0]),d(s)),o&&(i=wo(o),l.attr("y",i[0]).attr("height",i[1]-i[0]),g(s)),p(s)})}function p(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+s[+/e$/.test(t)]+","+l[+/^s/.test(t)]+")"})}function d(t){t.select(".extent").attr("x",s[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function g(t){t.select(".extent").attr("y",l[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1]-l[0])}function v(){var h,v,M=this,m=t.select(t.event.target),y=r.of(M,arguments),b=t.select(M),w=m.datum(),x=!/^(n|s)$/.test(w)&&a,k=!/^(e|w)$/.test(w)&&o,S=m.classed("extent"),_=yt(M),q=t.mouse(M),T=t.select(i(M)).on("keydown.brush",A).on("keyup.brush",N);if(t.event.changedTouches?T.on("touchmove.brush",j).on("touchend.brush",P):T.on("mousemove.brush",j).on("mouseup.brush",P),b.interrupt().selectAll("*").interrupt(),S)q[0]=s[0]-q[0],q[1]=l[0]-q[1];else if(w){var z=+/w$/.test(w),E=+/^n/.test(w);v=[s[1-z]-q[0],l[1-E]-q[1]],q[0]=s[z],q[1]=l[E]}else t.event.altKey&&(h=q.slice());function A(){32==t.event.keyCode&&(S||(h=null,q[0]-=s[1],q[1]-=l[1],S=2),D())}function N(){32==t.event.keyCode&&2==S&&(q[0]+=s[1],q[1]+=l[1],S=0,D())}function j(){var n=t.mouse(M),e=!1;v&&(n[0]+=v[0],n[1]+=v[1]),S||(t.event.altKey?(h||(h=[(s[0]+s[1])/2,(l[0]+l[1])/2]),q[0]=s[+(n[0]<h[0])],q[1]=l[+(n[1]<h[1])]):h=null),x&&L(n,a,0)&&(d(b),e=!0),k&&L(n,o,1)&&(g(b),e=!0),e&&(p(b),y({type:"brush",mode:S?"move":"resize"}))}function L(t,r,a){var i,o,f=wo(r),p=f[0],d=f[1],g=q[a],v=a?l:s,M=v[1]-v[0];if(S&&(p-=g,d-=M+g),i=(a?c:u)?Math.max(p,Math.min(d,t[a])):t[a],S?o=(i+=g)+M:(h&&(g=Math.max(p,Math.min(d,2*h[a]-i))),g<i?(o=i,i=g):o=g),v[0]!=i||v[1]!=o)return a?e=null:n=null,v[0]=i,v[1]=o,!0}function P(){j(),b.style("pointer-events","all").selectAll(".resize").style("display",f.empty()?"none":null),t.select("body").style("cursor",null),T.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),_(),y({type:"brushend"})}b.style("pointer-events","none").selectAll(".resize").style("display",null),t.select("body").style("cursor",m.style("cursor")),y({type:"brushstart"}),j()}return f.event=function(a){a.each(function(){var a=r.of(this,arguments),i={x:s,y:l,i:n,j:e},o=this.__chart__||i;this.__chart__=i,Ls?t.select(this).transition().each("start.brush",function(){n=o.i,e=o.j,s=o.x,l=o.y,a({type:"brushstart"})}).tween("brush:brush",function(){var t=ni(s,i.x),r=ni(l,i.y);return n=e=null,function(n){s=i.x=t(n),l=i.y=r(n),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){n=i.i,e=i.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},f.x=function(t){return arguments.length?(h=Gs[!(a=t)<<1|!o],f):a},f.y=function(t){return arguments.length?(h=Gs[!a<<1|!(o=t)],f):o},f.clamp=function(t){return arguments.length?(a&&o?(u=!!t[0],c=!!t[1]):a?u=!!t:o&&(c=!!t),f):a&&o?[u,c]:a?u:o?c:null},f.extent=function(t){var r,i,u,c,h;return arguments.length?(a&&(r=t[0],i=t[1],o&&(r=r[0],i=i[0]),n=[r,i],a.invert&&(r=a(r),i=a(i)),i<r&&(h=r,r=i,i=h),r==s[0]&&i==s[1]||(s=[r,i])),o&&(u=t[0],c=t[1],a&&(u=u[1],c=c[1]),e=[u,c],o.invert&&(u=o(u),c=o(c)),c<u&&(h=u,u=c,c=h),u==l[0]&&c==l[1]||(l=[u,c])),f):(a&&(n?(r=n[0],i=n[1]):(r=s[0],i=s[1],a.invert&&(r=a.invert(r),i=a.invert(i)),i<r&&(h=r,r=i,i=h))),o&&(e?(u=e[0],c=e[1]):(u=l[0],c=l[1],o.invert&&(u=o.invert(u),c=o.invert(c)),c<u&&(h=u,u=c,c=h))),a&&o?[[r,u],[i,c]]:a?[r,i]:o&&[u,c])},f.clear=function(){return f.empty()||(s=[0,0],l=[0,0],n=e=null),f},f.empty=function(){return!!a&&s[0]==s[1]||!!o&&l[0]==l[1]},t.rebind(f,r,"on")};var Vs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Gs=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ys=Pn.format=ue.timeFormat,Ws=Ys.utc,$s=Ws("%Y-%m-%dT%H:%M:%S.%LZ");function Zs(t){return t.toISOString()}function Xs(n,e,r){function a(t){return n(t)}function i(n,r){var a=(n[1]-n[0])/r,i=t.bisect(Ks,a);return i==Ks.length?[e.year,Ao(n.map(function(t){return t/31536e6}),r)[2]]:i?e[a/Ks[i-1]<Ks[i]/a?i-1:i]:[el,Ao(n,r)[2]]}return a.invert=function(t){return Js(n.invert(t))},a.domain=function(t){return arguments.length?(n.domain(t),a):n.domain().map(Js)},a.nice=function(t,n){var e=a.domain(),r=bo(e),o=null==t?i(r,10):"number"==typeof t&&i(r,t);function s(e){return!isNaN(e)&&!t.range(e,Js(+e+1),n).length}return o&&(t=o[0],n=o[1]),a.domain(ko(e,n>1?{floor:function(n){for(;s(n=t.floor(n));)n=Js(n-1);return n},ceil:function(n){for(;s(n=t.ceil(n));)n=Js(+n+1);return n}}:t))},a.ticks=function(t,n){var e=bo(a.domain()),r=null==t?i(e,10):"number"==typeof t?i(e,t):!t.range&&[{range:t},n];return r&&(t=r[0],n=r[1]),t.range(e[0],Js(+e[1]+1),n<1?1:n)},a.tickFormat=function(){return r},a.copy=function(){return Xs(n.copy(),e,r)},zo(a,n)}function Js(t){return new Date(t)}Ys.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Zs:$s,Zs.parse=function(t){var n=new Date(t);return isNaN(n)?null:n},Zs.toString=$s.toString,Pn.second=Rn(function(t){return new Cn(1e3*Math.floor(t/1e3))},function(t,n){t.setTime(t.getTime()+1e3*Math.floor(n))},function(t){return t.getSeconds()}),Pn.seconds=Pn.second.range,Pn.seconds.utc=Pn.second.utc.range,Pn.minute=Rn(function(t){return new Cn(6e4*Math.floor(t/6e4))},function(t,n){t.setTime(t.getTime()+6e4*Math.floor(n))},function(t){return t.getMinutes()}),Pn.minutes=Pn.minute.range,Pn.minutes.utc=Pn.minute.utc.range,Pn.hour=Rn(function(t){var n=t.getTimezoneOffset()/60;return new Cn(36e5*(Math.floor(t/36e5-n)+n))},function(t,n){t.setTime(t.getTime()+36e5*Math.floor(n))},function(t){return t.getHours()}),Pn.hours=Pn.hour.range,Pn.hours.utc=Pn.hour.utc.range,Pn.month=Rn(function(t){return(t=Pn.day(t)).setDate(1),t},function(t,n){t.setMonth(t.getMonth()+n)},function(t){return t.getMonth()}),Pn.months=Pn.month.range,Pn.months.utc=Pn.month.utc.range;var Ks=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],tl=[[Pn.second,1],[Pn.second,5],[Pn.second,15],[Pn.second,30],[Pn.minute,1],[Pn.minute,5],[Pn.minute,15],[Pn.minute,30],[Pn.hour,1],[Pn.hour,3],[Pn.hour,6],[Pn.hour,12],[Pn.day,1],[Pn.day,2],[Pn.week,1],[Pn.month,1],[Pn.month,3],[Pn.year,1]],nl=Ys.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",We]]),el={range:function(n,e,r){return t.range(Math.ceil(n/r)*r,+e,r).map(Js)},floor:E,ceil:E};tl.year=Pn.year,Pn.scale=function(){return Xs(t.scale.linear(),tl,nl)};var rl=tl.map(function(t){return[t[0].utc,t[1]]}),al=Ws.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",We]]);function il(t){return JSON.parse(t.responseText)}function ol(t){var n=r.createRange();return n.selectNode(r.body),n.createContextualFragment(t.responseText)}rl.year=Pn.year.utc,Pn.scale.utc=function(){return Xs(t.scale.linear(),rl,al)},t.text=Mn(function(t){return t.responseText}),t.json=function(t,n){return mn(t,"application/json",il,n)},t.html=function(t,n){return mn(t,"text/html",ol,n)},t.xml=Mn(function(t){return t.responseXML}),"function"==typeof define&&define.amd?(this.d3=t,define(t)):"object"==typeof module&&module.exports?module.exports=t:this.d3=t}(),function(){function t(t,e){return{type:"Feature",id:t.id,properties:t.properties,geometry:n(t.geometry,e)}}function n(t,e){if(!t)return null;if("GeometryCollection"===t.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(t){return n(t,e)})};if(!l.hasOwnProperty(t.type))return null;var r=l[t.type];return d3.geo.stream(t,e(r)),r.result()}d3.geo.project=function(t,r){var a=r.stream;if(!a)throw new Error("not yet supported");return(t&&e.hasOwnProperty(t.type)?e[t.type]:n)(t,a)};var e={Feature:t,FeatureCollection:function(n,e){return{type:"FeatureCollection",features:n.features.map(function(n){return t(n,e)})}}},r=[],a=[],i={point:function(t,n){r.push([t,n])},result:function(){var t=r.length?r.length<2?{type:"Point",coordinates:r[0]}:{type:"MultiPoint",coordinates:r}:null;return r=[],t}},o={lineStart:u,point:function(t,n){r.push([t,n])},lineEnd:function(){r.length&&(a.push(r),r=[])},result:function(){var t=a.length?a.length<2?{type:"LineString",coordinates:a[0]}:{type:"MultiLineString",coordinates:a}:null;return a=[],t}},s={polygonStart:u,lineStart:u,point:function(t,n){r.push([t,n])},lineEnd:function(){var t=r.length;if(t){do{r.push(r[0].slice())}while(++t<4);a.push(r),r=[]}},polygonEnd:u,result:function(){if(!a.length)return null;var t=[],n=[];return a.forEach(function(e){!function(t){if((n=t.length)<4)return!1;for(var n,e=0,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r<=0}(e)?n.push(e):t.push([e])}),n.forEach(function(n){var e=n[0];t.some(function(t){if(function(t,n){for(var e=n[0],r=n[1],a=!1,i=0,o=t.length,s=o-1;i<o;s=i++){var l=t[i],u=l[0],c=l[1],h=t[s],f=h[1];c>r^f>r&&e<(h[0]-u)*(r-c)/(f-c)+u&&(a=!a)}return a}(t[0],e))return t.push(n),!0})||t.push([n])}),a=[],t.length?t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t[0]}:null}},l={Point:i,MultiPoint:i,LineString:o,MultiLineString:o,Polygon:s,MultiPolygon:s,Sphere:s};function u(){}var c=1e-6,h=c*c,f=Math.PI,p=f/2,d=Math.sqrt(f),g=f/180,v=180/f;function M(t){return t>0?1:t<0?-1:0}function m(t){return t>1?p:t<-1?-p:Math.asin(t)}function y(t){return t>1?0:t<-1?f:Math.acos(t)}function b(t){return t>0?Math.sqrt(t):0}var w=d3.geo.projection,x=d3.geo.projectionMutator;function k(t){var n=Math.tan(.5*t),e=2*Math.log(Math.cos(.5*t))/(n*n);function r(t,n){var r=Math.cos(t),a=Math.cos(n),i=Math.sin(n),o=a*r,s=-((1-o?Math.log(.5*(1+o))/(1-o):-.5)+e/(1+o));return[s*a*Math.sin(t),s*i]}return r.invert=function(n,r){var a,i=Math.sqrt(n*n+r*r),o=-.5*t,s=50;if(!i)return[0,0];do{var l=.5*o,u=Math.cos(l),h=Math.sin(l),f=Math.tan(l),p=Math.log(1/u);o-=a=(2/f*p-e*f-i)/(-p/(h*h)+1-e/(2*u*u))}while(Math.abs(a)>c&&--s>0);var d=Math.sin(o);return[Math.atan2(n*d,i*Math.cos(o)),m(r*d/i)]},r}function S(t,n){var e,r=Math.cos(n),a=(e=y(r*Math.cos(t/=2)))?e/Math.sin(e):1;return[2*r*Math.sin(t)*a,Math.sin(n)*a]}function _(t){var n=Math.sin(t),e=Math.cos(t),r=t>0?1:-1,a=Math.tan(r*t),i=(1+n-e)/2;function o(t,o){var s=Math.cos(o),l=Math.cos(t/=2);return[(1+s)*Math.sin(t),(r*o>-Math.atan2(l,a)-.001?0:10*-r)+i+Math.sin(o)*e-(1+s)*n*l]}return o.invert=function(t,o){var s=0,l=0,u=50;do{var h=Math.cos(s),f=Math.sin(s),p=Math.cos(l),d=Math.sin(l),g=1+p,v=g*f-t,M=i+d*e-g*n*h-o,m=.5*g*h,y=-f*d,b=.5*n*g*f,w=e*p+n*h*d,x=y*b-w*m,k=.5*(M*y-v*w)/x,S=(v*b-M*m)/x;s-=k,l-=S}while((Math.abs(k)>c||Math.abs(S)>c)&&--u>0);return r*l>-Math.atan2(Math.cos(s),a)-.001?[2*s,l]:null},o}function q(t){return.5*(Math.exp(t)-Math.exp(-t))}function T(t){return.5*(Math.exp(t)+Math.exp(-t))}function z(t,n){var e=Math.tan(n/2),r=b(1-e*e),a=1+r*Math.cos(t/=2),i=Math.sin(t)*r/a,o=e/a,s=i*i,l=o*o;return[4/3*i*(3+s-3*l),4/3*o*(3+3*s-l)]}d3.geo.interrupt=function(t){var n,e=[[[[-f,0],[0,p],[f,0]]],[[[-f,0],[0,-p],[f,0]]]];function r(n,r){for(var a=r<0?-1:1,i=e[+(r<0)],o=0,s=i.length-1;o<s&&n>i[o][2][0];++o);var l=t(n-i[o][1][0],r);return l[0]+=t(i[o][1][0],a*r>a*i[o][0][1]?i[o][0][1]:r)[0],l}function a(){n=e.map(function(n){return n.map(function(n){var e,r=t(n[0][0],n[0][1])[0],a=t(n[2][0],n[2][1])[0],i=t(n[1][0],n[0][1])[1],o=t(n[1][0],n[1][1])[1];return i>o&&(e=i,i=o,o=e),[[r,i],[a,o]]})})}t.invert&&(r.invert=function(a,i){for(var o=n[+(i<0)],s=e[+(i<0)],u=0,c=o.length;u<c;++u){var h=o[u];if(h[0][0]<=a&&a<h[1][0]&&h[0][1]<=i&&i<h[1][1]){var f=t.invert(a-t(s[u][1][0],0)[0],i);return f[0]+=s[u][1][0],l(r(f[0],f[1]),[a,i])?f:null}}});var i=d3.geo.projection(r),o=i.stream;function s(t,n){for(var e,r,a,i=-1,o=t.length,s=t[0],l=[];++i<o;){r=((e=t[i])[0]-s[0])/n,a=(e[1]-s[1])/n;for(var u=0;u<n;++u)l.push([s[0]+u*r,s[1]+u*a]);s=e}return l.push(e),l}function l(t,n){return Math.abs(t[0]-n[0])<c&&Math.abs(t[1]-n[1])<c}return i.stream=function(t){var n=i.rotate(),r=o(t),a=(i.rotate([0,0]),o(t));return i.rotate(n),r.sphere=function(){d3.geo.stream(function(){for(var t=1e-6,n=[],r=0,a=e[0].length;r<a;++r)n.push(s([[(o=180*(i=e[0][r])[0][0]/f)+t,180*i[0][1]/f+t],[o+t,(l=180*i[1][1]/f)-t],[(u=180*i[2][0]/f)-t,l-t],[u-t,180*i[2][1]/f+t]],30));for(r=e[1].length-1;r>=0;--r){var i,o,l,u;n.push(s([[(u=180*(i=e[1][r])[2][0]/f)-t,180*i[2][1]/f-t],[u-t,(l=180*i[1][1]/f)+t],[(o=180*i[0][0]/f)+t,l+t],[o+t,180*i[0][1]/f-t]],30))}return{type:"Polygon",coordinates:[d3.merge(n)]}}(),a)},r},i.lobes=function(t){return arguments.length?(e=t.map(function(t){return t.map(function(t){return[[t[0][0]*f/180,t[0][1]*f/180],[t[1][0]*f/180,t[1][1]*f/180],[t[2][0]*f/180,t[2][1]*f/180]]})}),a(),i):e.map(function(t){return t.map(function(t){return[[180*t[0][0]/f,180*t[0][1]/f],[180*t[1][0]/f,180*t[1][1]/f],[180*t[2][0]/f,180*t[2][1]/f]]})})},i},(d3.geo.airy=function(){var t=p,n=x(k),e=n(t);return e.radius=function(e){return arguments.length?n(t=e*f/180):t/f*180},e}).raw=k,S.invert=function(t,n){if(!(t*t+4*n*n>f*f+c)){var e=t,r=n,a=25;do{var i,o=Math.sin(e),s=Math.sin(e/2),l=Math.cos(e/2),u=Math.sin(r),h=Math.cos(r),p=Math.sin(2*r),d=u*u,g=h*h,v=s*s,M=1-g*l*l,m=M?y(h*l)*Math.sqrt(i=1/M):i=0,b=2*m*h*s-t,w=m*u-n,x=i*(g*v+m*h*l*d),k=i*(.5*o*p-2*m*u*s),S=.25*i*(p*s-m*u*g*o),_=i*(d*l+m*v*h),q=k*S-_*x;if(!q)break;var T=(w*k-b*_)/q,z=(b*S-w*x)/q;e-=T,r-=z}while((Math.abs(T)>c||Math.abs(z)>c)&&--a>0);return[e,r]}},(d3.geo.aitoff=function(){return w(S)}).raw=S,(d3.geo.armadillo=function(){var t=f/9,n=t>0?1:-1,e=Math.tan(n*t),r=x(_),a=r(t),i=a.stream;return a.parallel=function(a){return arguments.length?(e=Math.tan((n=(t=a*f/180)>0?1:-1)*t),r(t)):t/f*180},a.stream=function(r){var o=a.rotate(),s=i(r),l=(a.rotate([0,0]),i(r));return a.rotate(o),s.sphere=function(){l.polygonStart(),l.lineStart();for(var r=-180*n;n*r<180;r+=90*n)l.point(r,90*n);for(;n*(r-=t)>=-180;)l.point(r,n*-Math.atan2(Math.cos(r*g/2),e)*v);l.lineEnd(),l.polygonEnd()},s},a}).raw=_,z.invert=function(t,n){if(n*=3/8,!(t*=3/8)&&Math.abs(n)>1)return null;var e=1+t*t+n*n,r=Math.sqrt(.5*(e-Math.sqrt(e*e-4*n*n))),a=m(r)/3,i=r?function(t){return Math.log(t+b(t*t-1))}(Math.abs(n/r))/3:function(t){return Math.log(t+b(t*t+1))}(Math.abs(t))/3,o=Math.cos(a),s=T(i),l=s*s-o*o;return[2*M(t)*Math.atan2(q(i)*o,.25-l),2*M(n)*Math.atan2(s*Math.sin(a),.25+l)]},(d3.geo.august=function(){return w(z)}).raw=z;var E=Math.log(1+Math.SQRT2);function A(t,n){var e=Math.abs(n);return e<f/4?[t,Math.log(Math.tan(f/4+n/2))]:[t*Math.cos(e)*(2*Math.SQRT2-1/Math.sin(e)),M(n)*(2*Math.SQRT2*(e-f/4)-Math.log(Math.tan(e/2)))]}A.invert=function(t,n){if((r=Math.abs(n))<E)return[t,2*Math.atan(Math.exp(n))-p];var e,r,a=Math.sqrt(8),i=f/4,o=25;do{var s=Math.cos(i/2),l=Math.tan(i/2);i-=e=(a*(i-f/4)-Math.log(l)-r)/(a-.5*s*s/l)}while(Math.abs(e)>h&&--o>0);return[t/(Math.cos(i)*(a-1/Math.sin(i))),M(n)*i]},(d3.geo.baker=function(){return w(A)}).raw=A;var N=d3.geo.azimuthalEquidistant.raw;function j(t){var n=2*f/t;function e(t,e){var r=N(t,e);if(Math.abs(t)>p){var a=Math.atan2(r[1],r[0]),i=Math.sqrt(r[0]*r[0]+r[1]*r[1]),o=n*Math.round((a-p)/n)+p,s=Math.atan2(Math.sin(a-=o),2-Math.cos(a));a=o+m(f/i*Math.sin(s))-s,r[0]=i*Math.cos(a),r[1]=i*Math.sin(a)}return r}return e.invert=function(t,e){var r=Math.sqrt(t*t+e*e);if(r>p){var a=Math.atan2(e,t),i=n*Math.round((a-p)/n)+p,o=a>i?-1:1,s=r*Math.cos(i-a),l=1/Math.tan(o*Math.acos((s-f)/Math.sqrt(f*(f-2*s)+r*r)));a=i+2*Math.atan((l+o*Math.sqrt(l*l-3))/3),t=r*Math.cos(a),e=r*Math.sin(a)}return N.invert(t,e)},e}function L(t){return function(n){var e,r=t*Math.sin(n),a=30;do{n-=e=(n+Math.sin(n)-r)/(1+Math.cos(n))}while(Math.abs(e)>c&&--a>0);return n/2}}function P(t,n,e){var r=L(e);function a(e,a){return[t*e*Math.cos(a=r(a)),n*Math.sin(a)]}return a.invert=function(r,a){var i=m(a/n);return[r/(t*Math.cos(i)),m((2*i+Math.sin(2*i))/e)]},a}(d3.geo.berghaus=function(){var t=5,n=x(j),e=n(t),r=e.stream,a=.01,i=-Math.cos(a*g),o=Math.sin(a*g);return e.lobes=function(e){return arguments.length?n(t=+e):t},e.stream=function(n){var s=e.rotate(),l=r(n),u=(e.rotate([0,0]),r(n));return e.rotate(s),l.sphere=function(){u.polygonStart(),u.lineStart();for(var n=0,e=360/t,r=2*f/t,s=90-180/t,l=p;n<t;++n,s-=e,l-=r)u.point(Math.atan2(o*Math.cos(l),i)*v,m(o*Math.sin(l))*v),s<-90?(u.point(-90,-180-s-a),u.point(-90,-180-s+a)):(u.point(90,s+a),u.point(90,s-a));u.lineEnd(),u.polygonEnd()},l},e}).raw=j;var C=L(f),D=P(Math.SQRT2/p,Math.SQRT2,f);function I(t,n){var e=2.00276,r=C(n);return[e*t/(1/Math.cos(n)+1.11072/Math.cos(r)),(n+Math.SQRT2*Math.sin(r))/e]}function R(t){var n=0,e=x(t),r=e(n);return r.parallel=function(t){return arguments.length?e(n=t*f/180):n/f*180},r}function F(t,n){return[t*Math.cos(n),n]}function O(t){if(!t)return F;var n=1/Math.tan(t);function e(e,r){var a=n+t-r,i=a?e*Math.cos(r)/a:a;return[a*Math.sin(i),n-a*Math.cos(i)]}return e.invert=function(e,r){var a=Math.sqrt(e*e+(r=n-r)*r),i=n+t-a;return[a/Math.cos(i)*Math.atan2(e,r),i]},e}function U(t){var n=Math.sin(t);function e(t,e){var r=p-e,a=r?t*n*Math.sin(r)/r:r;return[r*Math.sin(a)/n,p-r*Math.cos(a)]}return e.invert=function(t,e){var r=t*n,a=p-e,i=Math.sqrt(r*r+a*a),o=Math.atan2(r,a);return[(i?i/Math.sin(i):1)*o/n,p-i]},e}(d3.geo.mollweide=function(){return w(D)}).raw=D,I.invert=function(t,n){var e,r,a=2.00276,i=a*n,o=n<0?-f/4:f/4,s=25;do{r=i-Math.SQRT2*Math.sin(o),o-=e=(Math.sin(2*o)+2*o-f*Math.sin(r))/(2*Math.cos(2*o)+2+f*Math.cos(r)*Math.SQRT2*Math.cos(o))}while(Math.abs(e)>c&&--s>0);return r=i-Math.SQRT2*Math.sin(o),[t*(1/Math.cos(r)+1.11072/Math.cos(o))/a,r]},(d3.geo.boggs=function(){return w(I)}).raw=I,F.invert=function(t,n){return[t/Math.cos(n),n]},(d3.geo.sinusoidal=function(){return w(F)}).raw=F,(d3.geo.bonne=function(){return R(O).parallel(45)}).raw=O,(d3.geo.bottomley=function(){var t=f/6,n=d3.geo.projectionMutator(U),e=n(t);return e.variant=function(e){return arguments.length?n(t=+e):t},e}).raw=U;var H=P(1,4/f,f);function B(t){for(var n,e=(t=t.map(function(t){return[t[0],t[1],Math.sin(t[1]),Math.cos(t[1])]}))[2],r=0;r<3;++r,e=n)e.v=Q((n=t[r])[1]-e[1],e[3],e[2],n[3],n[2],n[0]-e[0]),e.point=[0,0];var a=V(t[0].v[0],t[2].v[0],t[1].v[0]),i=V(t[0].v[0],t[1].v[0],t[2].v[0]),o=f-a;t[2].point[1]=0,t[0].point[0]=-(t[1].point[0]=.5*t[0].v[0]);var s=[t[2].point[0]=t[0].point[0]+t[2].v[0]*Math.cos(a),2*(t[0].point[1]=t[1].point[1]=t[2].v[0]*Math.sin(a))];return function(n,e){for(var r=Math.sin(e),a=Math.cos(e),l=new Array(3),u=0;u<3;++u){var c=t[u];if(l[u]=Q(e-c[1],c[3],c[2],a,r,n-c[0]),!l[u][0])return c.point;l[u][1]=G(l[u][1]-c.v[1])}var h=s.slice();for(u=0;u<3;++u){var f=V(t[u].v[0],l[u][0],l[2==u?0:u+1][0]);l[u][1]<0&&(f=-f),u?1==u?(f=i-f,h[0]-=l[u][0]*Math.cos(f),h[1]-=l[u][0]*Math.sin(f)):(f=o-f,h[0]+=l[u][0]*Math.cos(f),h[1]+=l[u][0]*Math.sin(f)):(h[0]+=l[u][0]*Math.cos(f),h[1]-=l[u][0]*Math.sin(f))}return h[0]/=3,h[1]/=3,h}}function Q(t,n,e,r,a,i){var o,s=Math.cos(i);if(Math.abs(t)>1||Math.abs(i)>1)o=y(e*a+n*r*s);else{var l=Math.sin(.5*t),u=Math.sin(.5*i);o=2*m(Math.sqrt(l*l+n*r*u*u))}return Math.abs(o)>c?[o,Math.atan2(r*Math.sin(i),n*a-e*r*s)]:[0,0]}function V(t,n,e){return y(.5*(t*t+n*n-e*e)/(t*n))}function G(t){return t-2*f*Math.floor((t+f)/(2*f))}function Y(t){return[t[0]*g,t[1]*g]}function W(t,n){var e=b(1-Math.sin(n));return[2/d*t*e,d*(1-e)]}function $(t){var n=Math.tan(t);function e(t,e){return[t,(t?t/Math.sin(t):1)*(Math.sin(e)*Math.cos(t)-n*Math.cos(e))]}return e.invert=n?function(t,e){t&&(e*=Math.sin(t)/t);var r=Math.cos(t);return[t,2*Math.atan2(Math.sqrt(r*r+n*n-e*e)-r,n-e)]}:function(t,n){return[t,m(t?n*Math.tan(t)/t:n)]},e}function Z(t,n){var e=Math.sqrt(3);return[e*t*(2*Math.cos(2*n/3)-1)/d,e*d*Math.sin(n/3)]}function X(t){var n=Math.cos(t);function e(t,e){return[t*n,Math.sin(e)/n]}return e.invert=function(t,e){return[t/n,m(e*n)]},e}function J(t){var n=Math.cos(t);function e(t,e){return[t*n,(1+n)*Math.tan(.5*e)]}return e.invert=function(t,e){return[t/n,2*Math.atan(e/(1+n))]},e}function K(t,n){var e=Math.sqrt(8/(3*f));return[e*t*(1-Math.abs(n)/f),e*n]}function tt(t,n){var e=Math.sqrt(4-3*Math.sin(Math.abs(n)));return[2/Math.sqrt(6*f)*t*e,M(n)*Math.sqrt(2*f/3)*(2-e)]}function nt(t,n){var e=Math.sqrt(f*(4+f));return[2/e*t*(1+Math.sqrt(1-4*n*n/(f*f))),4/e*n]}function et(t,n){var e=(2+p)*Math.sin(n);n/=2;for(var r=0,a=1/0;r<10&&Math.abs(a)>c;r++){var i=Math.cos(n);n-=a=(n+Math.sin(n)*(i+2)-e)/(2*i*(1+i))}return[2/Math.sqrt(f*(4+f))*t*(1+Math.cos(n)),2*Math.sqrt(f/(4+f))*Math.sin(n)]}function rt(t,n){return[t*(1+Math.cos(n))/Math.sqrt(2+f),2*n/Math.sqrt(2+f)]}function at(t,n){for(var e=(1+p)*Math.sin(n),r=0,a=1/0;r<10&&Math.abs(a)>c;r++)n-=a=(n+Math.sin(n)-e)/(1+Math.cos(n));return e=Math.sqrt(2+f),[t*(1+Math.cos(n))/e,2*n/e]}function it(t,n){var e=Math.sin(t/=2),r=Math.cos(t),a=Math.sqrt(Math.cos(n)),i=Math.cos(n/=2),o=Math.sin(n)/(i+Math.SQRT2*r*a),s=Math.sqrt(2/(1+o*o)),l=Math.sqrt((Math.SQRT2*i+(r+e)*a)/(Math.SQRT2*i+(r-e)*a));return[ot*(s*(l-1/l)-2*Math.log(l)),ot*(s*o*(l+1/l)-2*Math.atan(o))]}(d3.geo.bromley=function(){return w(H)}).raw=H,(d3.geo.chamberlin=function(){var t=[[0,0],[0,0],[0,0]],n=x(B),e=n(t),r=e.rotate;return delete e.rotate,e.points=function(a){if(!arguments.length)return t;t=a;var i=d3.geo.centroid({type:"MultiPoint",coordinates:t}),o=[-i[0],-i[1]];return r.call(e,o),n(t.map(d3.geo.rotation(o)).map(Y))},e.points([[-150,55],[-35,55],[-92.5,10]])}).raw=B,W.invert=function(t,n){var e=(e=n/d-1)*e;return[e>0?t*Math.sqrt(f/e)/2:0,m(1-e)]},(d3.geo.collignon=function(){return w(W)}).raw=W,(d3.geo.craig=function(){return R($)}).raw=$,Z.invert=function(t,n){var e=Math.sqrt(3),r=3*m(n/(e*d));return[d*t/(e*(2*Math.cos(2*r/3)-1)),r]},(d3.geo.craster=function(){return w(Z)}).raw=Z,(d3.geo.cylindricalEqualArea=function(){return R(X)}).raw=X,(d3.geo.cylindricalStereographic=function(){return R(J)}).raw=J,K.invert=function(t,n){var e=Math.sqrt(8/(3*f)),r=n/e;return[t/(e*(1-Math.abs(r)/f)),r]},(d3.geo.eckert1=function(){return w(K)}).raw=K,tt.invert=function(t,n){var e=2-Math.abs(n)/Math.sqrt(2*f/3);return[t*Math.sqrt(6*f)/(2*e),M(n)*m((4-e*e)/3)]},(d3.geo.eckert2=function(){return w(tt)}).raw=tt,nt.invert=function(t,n){var e=Math.sqrt(f*(4+f))/2;return[t*e/(1+b(1-n*n*(4+f)/(4*f))),n*e/2]},(d3.geo.eckert3=function(){return w(nt)}).raw=nt,et.invert=function(t,n){var e=.5*n*Math.sqrt((4+f)/f),r=m(e),a=Math.cos(r);return[t/(2/Math.sqrt(f*(4+f))*(1+a)),m((r+e*(a+2))/(2+p))]},(d3.geo.eckert4=function(){return w(et)}).raw=et,rt.invert=function(t,n){var e=Math.sqrt(2+f),r=n*e/2;return[e*t/(1+Math.cos(r)),r]},(d3.geo.eckert5=function(){return w(rt)}).raw=rt,at.invert=function(t,n){var e=1+p,r=Math.sqrt(e/2);return[2*t*r/(1+Math.cos(n*=r)),m((n+Math.sin(n))/e)]},(d3.geo.eckert6=function(){return w(at)}).raw=at,it.invert=function(t,n){var e=d3.geo.august.raw.invert(t/1.2,1.065*n);if(!e)return null;var r=e[0],a=e[1],i=20;t/=ot,n/=ot;do{var o=r/2,s=a/2,l=Math.sin(o),u=Math.cos(o),h=Math.sin(s),f=Math.cos(s),d=Math.cos(a),g=Math.sqrt(d),v=h/(f+Math.SQRT2*u*g),M=v*v,m=Math.sqrt(2/(1+M)),y=(Math.SQRT2*f+(u+l)*g)/(Math.SQRT2*f+(u-l)*g),b=Math.sqrt(y),w=b-1/b,x=b+1/b,k=m*w-2*Math.log(b)-t,S=m*v*x-2*Math.atan(v)-n,_=h&&Math.SQRT1_2*g*l*M/h,q=(Math.SQRT2*u*f+g)/(2*(f+Math.SQRT2*u*g)*(f+Math.SQRT2*u*g)*g),T=-.5*v*m*m*m,z=T*_,E=T*q,A=(A=2*f+Math.SQRT2*g*(u-l))*A*b,N=(Math.SQRT2*u*f*g+d)/A,j=-Math.SQRT2*l*h/(g*A),L=w*z-2*N/b+m*(N+N/y),P=w*E-2*j/b+m*(j+j/y),C=v*x*z-2*_/(1+M)+m*x*_+m*v*(N-N/y),D=v*x*E-2*q/(1+M)+m*x*q+m*v*(j-j/y),I=P*C-D*L;if(!I)break;var R=(S*P-k*D)/I,F=(k*C-S*L)/I;r-=R,a=Math.max(-p,Math.min(p,a-F))}while((Math.abs(R)>c||Math.abs(F)>c)&&--i>0);return Math.abs(Math.abs(a)-p)<c?[0,a]:i&&[r,a]};var ot=3+2*Math.SQRT2;function st(t,n){var e=Math.tan(n/2);return[t*lt*b(1-e*e),(1+lt)*e]}(d3.geo.eisenlohr=function(){return w(it)}).raw=it,st.invert=function(t,n){var e=n/(1+lt);return[t?t/(lt*b(1-e*e)):0,2*Math.atan(e)]};var lt=Math.cos(35*g);function ut(t,n){var e=n/2,r=Math.cos(e);return[2*t/d*Math.cos(n)*r*r,d*Math.tan(e)]}(d3.geo.fahey=function(){return w(st)}).raw=st,ut.invert=function(t,n){var e=Math.atan(n/d),r=Math.cos(e),a=2*e;return[t*d*.5/(Math.cos(a)*r*r),a]},(d3.geo.foucaut=function(){return w(ut)}).raw=ut,d3.geo.gilbert=function(t){var n=d3.geo.equirectangular().scale(v).translate([0,0]);function e(n){return t([.5*n[0],m(Math.tan(.5*n[1]*g))*v])}return t.invert&&(e.invert=function(n){return(n=t.invert(n))[0]*=2,n[1]=2*Math.atan(Math.sin(n[1]*g))*v,n}),e.stream=function(e){e=t.stream(e);var r=n.stream({point:function(t,n){e.point(.5*t,m(Math.tan(.5*-n*g))*v)},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}});return r.sphere=function(){e.sphere()},r.valid=!1,r},e};var ct=d3.geo.azimuthalEquidistant.raw;function ht(t,n){var e=2*f/n,r=t*t;function a(n,a){var i=ct(n,a),o=i[0],s=i[1],l=o*o+s*s;if(l>r){var u=Math.sqrt(l),h=Math.atan2(s,o),d=e*Math.round(h/e),g=h-d,v=t*Math.cos(g),M=(t*Math.sin(g)-g*Math.sin(v))/(p-v),m=ft(g,M),y=(f-t)/pt(m,v,f);o=u;var b,w=50;do{o-=b=(t+pt(m,v,o)*y-u)/(m(o)*y)}while(Math.abs(b)>c&&--w>0);s=g*Math.sin(o),o<p&&(s-=M*(o-p));var x=Math.sin(d),k=Math.cos(d);i[0]=o*k-s*x,i[1]=o*x+s*k}return i}return a.invert=function(n,a){var i=n*n+a*a;if(i>r){var o=Math.sqrt(i),s=Math.atan2(a,n),l=e*Math.round(s/e),u=s-l;n=o*Math.cos(u),a=o*Math.sin(u);for(var c=n-p,d=Math.sin(n),g=a/d,v=n<p?1/0:0,M=10;;){var m=t*Math.sin(g),y=t*Math.cos(g),b=Math.sin(y),w=p-y,x=(m-g*b)/w,k=ft(g,x);if(Math.abs(v)<h||!--M)break;g-=v=(g*d-x*c-a)/(d-2*c*(w*(y+g*m*Math.cos(y)-b)-m*(m-g*b))/(w*w))}s=l+g,n=(o=t+pt(k,y,n)*(f-t)/pt(k,y,f))*Math.cos(s),a=o*Math.sin(s)}return ct.invert(n,a)},a}function ft(t,n){return function(e){var r=t*Math.cos(e);return e<p&&(r-=n),Math.sqrt(1+r*r)}}function pt(t,n,e){for(var r=(e-n)/50,a=t(n)+t(e),i=1,o=n;i<50;++i)a+=2*t(o+=r);return.5*a*r}function dt(t,n,e,r,a,i,o,s){function l(l,u){if(!u)return[t*l/f,0];var c=u*u,h=t+c*(n+c*(e+c*r)),p=u*(a-1+c*(i-s+c*o)),d=(h*h+p*p)/(2*p),g=l*Math.asin(h/d)/f;return[d*Math.sin(g),u*(1+c*s)+d*(1-Math.cos(g))]}return arguments.length<8&&(s=0),l.invert=function(l,u){var h,p,d=f*l/t,g=u,v=50;do{var M=g*g,m=t+M*(n+M*(e+M*r)),y=g*(a-1+M*(i-s+M*o)),w=m*m+y*y,x=2*y,k=w/x,S=k*k,_=Math.asin(m/k)/f,q=d*_;if(xB2=m*m,dxBd\u03c6=(2*n+M*(4*e+6*M*r))*g,dyBd\u03c6=a+M*(3*i+5*M*o),dpd\u03c6=2*(m*dxBd\u03c6+y*(dyBd\u03c6-1)),dqd\u03c6=2*(dyBd\u03c6-1),dmd\u03c6=(dpd\u03c6*x-w*dqd\u03c6)/(x*x),cos\u03b1=Math.cos(q),sin\u03b1=Math.sin(q),mcos\u03b1=k*cos\u03b1,msin\u03b1=k*sin\u03b1,d\u03b1d\u03c6=d/f*(1/b(1-xB2/S))*(dxBd\u03c6*k-m*dmd\u03c6)/S,fx=msin\u03b1-l,fy=g*(1+M*s)+k-mcos\u03b1-u,\u03b4x\u03b4\u03c6=dmd\u03c6*sin\u03b1+mcos\u03b1*d\u03b1d\u03c6,\u03b4x\u03b4\u03bb=mcos\u03b1*_,\u03b4y\u03b4\u03c6=1+dmd\u03c6-(dmd\u03c6*cos\u03b1-msin\u03b1*d\u03b1d\u03c6),\u03b4y\u03b4\u03bb=msin\u03b1*_,denominator=\u03b4x\u03b4\u03c6*\u03b4y\u03b4\u03bb-\u03b4y\u03b4\u03c6*\u03b4x\u03b4\u03bb,!denominator)break;d-=h=(fy*\u03b4x\u03b4\u03c6-fx*\u03b4y\u03b4\u03c6)/denominator,g-=p=(fx*\u03b4y\u03b4\u03bb-fy*\u03b4x\u03b4\u03bb)/denominator}while((Math.abs(h)>c||Math.abs(p)>c)&&--v>0);return[d,g]},l}(d3.geo.gingery=function(){var t=6,n=30*g,e=Math.cos(n),r=Math.sin(n),a=x(ht),i=a(n,t),o=i.stream,s=-Math.cos(.01*g),l=Math.sin(.01*g);return i.radius=function(i){return arguments.length?(e=Math.cos(n=i*g),r=Math.sin(n),a(n,t)):n*v},i.lobes=function(e){return arguments.length?a(n,t=+e):t},i.stream=function(n){var a=i.rotate(),u=o(n),c=(i.rotate([0,0]),o(n));return i.rotate(a),u.sphere=function(){c.polygonStart(),c.lineStart();for(var n=0,a=2*f/t,i=0;n<t;++n,i-=a)c.point(Math.atan2(l*Math.cos(i),s)*v,Math.asin(l*Math.sin(i))*v),c.point(Math.atan2(r*Math.cos(i-a/2),e)*v,Math.asin(r*Math.sin(i-a/2))*v);c.lineEnd(),c.polygonEnd()},u},i}).raw=ht;var gt=dt(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);(d3.geo.ginzburg4=function(){return w(gt)}).raw=gt;var vt=dt(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);(d3.geo.ginzburg5=function(){return w(vt)}).raw=vt;var Mt=dt(5/6*f,-.62636,-.0344,0,1.3493,-.05524,0,.045);function mt(t,n){var e=t*t,r=n*n;return[t*(1-.162388*r)*(.87-952426e-9*e*e),n*(1+r/12)]}(d3.geo.ginzburg6=function(){return w(Mt)}).raw=Mt,mt.invert=function(t,n){var e,r=t,a=n,i=50;do{var o=a*a;a-=e=(a*(1+o/12)-n)/(1+o/4)}while(Math.abs(e)>c&&--i>0);i=50,t/=1-.162388*o;do{var s=(s=r*r)*s;r-=e=(r*(.87-952426e-9*s)-t)/(.87-.00476213*s)}while(Math.abs(e)>c&&--i>0);return[r,a]},(d3.geo.ginzburg8=function(){return w(mt)}).raw=mt;var yt=dt(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function bt(t){var n=t(p,0)[0]-t(-p,0)[0];function e(){var t=!1,n=x(r),e=n(t);return e.quincuncial=function(e){return arguments.length?n(t=!!e):t},e}function r(e){var r=e?function(e,r){var a=Math.abs(e)<p,i=t(a?e:e>0?e-f:e+f,r),o=(i[0]-i[1])*Math.SQRT1_2,s=(i[0]+i[1])*Math.SQRT1_2;if(a)return[o,s];var l=n*Math.SQRT1_2,u=o>0^s>0?-1:1;return[u*o-M(s)*l,u*s-M(o)*l]}:function(e,r){var a=e>0?-.5:.5,i=t(e+a*f,r);return i[0]-=a*n,i};return t.invert&&(r.invert=e?function(e,r){var a=(e+r)*Math.SQRT1_2,i=(r-e)*Math.SQRT1_2,o=Math.abs(a)<.5*n&&Math.abs(i)<.5*n;if(!o){var s=n*Math.SQRT1_2,l=a>0^i>0?-1:1,u=-l*(e+(i>0?1:-1)*s),c=-l*(r+(a>0?1:-1)*s);a=(-u-c)*Math.SQRT1_2,i=(u-c)*Math.SQRT1_2}var h=t.invert(a,i);return o||(h[0]+=a>0?f:-f),h}:function(e,r){var a=e>0?-.5:.5,i=t.invert(e+a*n,r),o=i[0]-a*f;return o<-f?o+=2*f:o>f&&(o-=2*f),i[0]=o,i}),r}return e.raw=r,e}function wt(t,n){var e=M(t),r=M(n),a=Math.cos(n),i=Math.cos(t)*a,o=Math.sin(t)*a,s=Math.sin(r*n);t=Math.abs(Math.atan2(o,s)),n=m(i),Math.abs(t-p)>c&&(t%=p);var l=function(t,n){if(n===p)return[0,0];var e=Math.sin(n),r=e*e,a=r*r,i=1+a,o=1+3*a,s=1-a,l=m(1/Math.sqrt(i)),u=s+r*i*l,h=(1-e)/u,d=Math.sqrt(h),g=h*i,v=Math.sqrt(g),M=d*s;if(0===t)return[0,-(M+r*v)];var y=Math.cos(n),w=1/y,x=2*e*y,k=(-u*y-(-3*r+l*o)*x*(1-e))/(u*u),S=-w*x,_=-w*(r*i*k+h*o*x),q=-2*w*(s*(.5*k/d)-2*r*d*x),T=4*t/f;if(t>.222*f||n<f/4&&t>.175*f){var z=(M+r*b(g*(1+a)-M*M))/(1+a);if(t>f/4)return[z,z];var E=z,A=.5*z,N=50;z=.5*(A+E);do{if(!(D=z*(q+S*(L=Math.sqrt(g-z*z)))+_*m(z/v)-T))break;D<0?A=z:E=z,z=.5*(A+E)}while(Math.abs(E-A)>c&&--N>0)}else{var j;z=c,N=25;do{var L,P=z*z,C=q+S*(L=b(g-P)),D=z*C+_*m(z/v)-T;z-=j=L?D/(C+(_-S*P)/L):0}while(Math.abs(j)>c&&--N>0)}return[z,-M-r*b(g-z*z)]}(t>f/4?p-t:t,n);return t>f/4&&(s=l[0],l[0]=-l[1],l[1]=-s),l[0]*=e,l[1]*=-r,l}function xt(t,n){var e,r,a,i,o,s;if(n<c)return[(i=Math.sin(t))-(e=.25*n*(t-i*(r=Math.cos(t))))*r,r+e*i,1-.5*n*i*i,t-e];if(n>=1-c)return e=.25*(1-n),s=t,a=1/(r=T(t)),[(i=((s=Math.exp(2*s))-1)/(s+1))+e*((o=r*q(t))-t)/(r*r),a-e*i*a*(o-t),a+e*i*a*(o+t),2*Math.atan(Math.exp(t))-p+e*(o-t)/r];var l=[1,0,0,0,0,0,0,0,0],u=[Math.sqrt(n),0,0,0,0,0,0,0,0],h=0;for(r=Math.sqrt(1-n),o=1;Math.abs(u[h]/l[h])>c&&h<8;)e=l[h++],u[h]=.5*(e-r),l[h]=.5*(e+r),r=b(e*r),o*=2;a=o*l[h]*t;do{a=.5*(m(i=u[h]*Math.sin(r=a)/l[h])+a)}while(--h);return[Math.sin(a),i=Math.cos(a),i/Math.cos(a-r),a]}function kt(t,n){if(!n)return t;if(1===n)return Math.log(Math.tan(t/2+f/4));for(var e=1,r=Math.sqrt(1-n),a=Math.sqrt(n),i=0;Math.abs(a)>c;i++){if(t%f){var o=Math.atan(r*Math.tan(t)/e);o<0&&(o+=f),t+=o+~~(t/f)*f}else t+=t;a=(e+r)/2,r=Math.sqrt(e*r),a=((e=a)-r)/2}return t/(Math.pow(2,i)*e)}function St(t,n){var e=(Math.SQRT2-1)/(Math.SQRT2+1),r=Math.sqrt(1-e*e),a=kt(p,r*r),i=Math.log(Math.tan(f/4+Math.abs(n)/2)),o=Math.exp(-1*i)/Math.sqrt(e),s=function(t,n){var e=t*t,r=n+1,a=1-e-n*n;return[.5*((t>=0?p:-p)-Math.atan2(a,2*t)),-.25*Math.log(a*a+4*e)+.5*Math.log(r*r+e)]}(o*Math.cos(-1*t),o*Math.sin(-1*t)),l=function(t,n,e){var r=Math.abs(t),a=q(Math.abs(n));if(r){var i=1/Math.sin(r),o=1/(Math.tan(r)*Math.tan(r)),s=-(o+e*a*a*i*i-1+e),l=.5*(-s+Math.sqrt(s*s-(e-1)*o*4));return[kt(Math.atan(1/Math.sqrt(l)),e)*M(t),kt(Math.atan(b((l/o-1)/e)),1-e)*M(n)]}return[0,kt(Math.atan(a),1-e)*M(n)]}(s[0],s[1],r*r);return[-l[1],(n>=0?1:-1)*(.5*a-l[0])]}function _t(t){var n=Math.sin(t),e=Math.cos(t),r=qt(t);function a(t,a){var i=r(t,a);t=i[0],a=i[1];var o=Math.sin(a),s=Math.cos(a),l=Math.cos(t),u=y(n*o+e*s*l),h=Math.sin(u),f=Math.abs(h)>c?u/h:1;return[f*e*Math.sin(t),(Math.abs(t)>p?f:-f)*(n*s-e*o*l)]}return r.invert=qt(-t),a.invert=function(t,e){var a=Math.sqrt(t*t+e*e),i=-Math.sin(a),o=Math.cos(a),s=a*o,l=-e*i,u=a*n,c=b(s*s+l*l-u*u),h=Math.atan2(s*u+l*c,l*u-s*c),f=(a>p?-1:1)*Math.atan2(t*i,a*Math.cos(h)*o+e*Math.sin(h)*i);return r.invert(f,h)},a}function qt(t){var n=Math.sin(t),e=Math.cos(t);return function(t,r){var a=Math.cos(r),i=Math.cos(t)*a,o=Math.sin(t)*a,s=Math.sin(r);return[Math.atan2(o,i*e-s*n),m(s*e+i*n)]}}(d3.geo.ginzburg9=function(){return w(yt)}).raw=yt,wt.invert=function(t,n){var e=M(t),r=M(n),a=-e*t,i=-r*n,o=i/a<1,s=function(t,n){for(var e=0,r=1,a=.5,i=50;;){var o=a*a,s=Math.sqrt(a),l=Math.asin(1/Math.sqrt(1+o)),u=1-o+a*(1+o)*l,c=(1-s)/u,p=Math.sqrt(c),d=c*(1+o),g=p*(1-o),v=Math.sqrt(d-t*t),M=n+g+a*v;if(Math.abs(r-e)<h||0==--i||0===M)break;M>0?e=a:r=a,a=.5*(e+r)}if(!i)return null;var m=Math.asin(s),y=Math.cos(m),b=1/y,w=2*s*y,x=(-u*y-(-3*a+l*(1+3*o))*w*(1-s))/(u*u);return[f/4*(t*(-2*b*(.5*x/p*(1-o)-2*a*p*w)+-b*w*v)+-b*(a*(1+o)*x+c*(1+3*o)*w)*Math.asin(t/Math.sqrt(d))),m]}(o?i:a,o?a:i),l=s[0],u=s[1];o&&(l=-p-l);var c=Math.cos(u),d=(t=Math.cos(l)*c,n=Math.sin(l)*c,Math.sin(u));return[e*(Math.atan2(n,-d)+f),r*m(t)]},d3.geo.gringorten=bt(wt),St.invert=function(t,n){var e=(Math.SQRT2-1)/(Math.SQRT2+1),r=Math.sqrt(1-e*e),a=function(t,n,e){if(!t)return[[0,(a=xt(n,1-e))[0]/a[1]],[1/a[1],0],[a[2]/a[1],0]];var r=xt(t,e);if(!n)return[[r[0],0],[r[1],0],[r[2],0]];var a,i=(a=xt(n,1-e))[1]*a[1]+e*r[0]*r[0]*a[0]*a[0];return[[r[0]*a[2]/i,r[1]*r[2]*a[0]*a[1]/i],[r[1]*a[1]/i,-r[0]*r[2]*a[0]*a[2]/i],[r[2]*a[1]*a[2]/i,-e*r[0]*r[1]*a[0]/i]]}(.5*kt(p,r*r)-n,-t,r*r),i=function(t,n){var e=n[0]*n[0]+n[1]*n[1];return[(t[0]*n[0]+t[1]*n[1])/e,(t[1]*n[0]-t[0]*n[1])/e]}(a[0],a[1]);return[Math.atan2(i[1],i[0])/-1,2*Math.atan(Math.exp(-.5*Math.log(e*i[0]*i[0]+e*i[1]*i[1])))-p]},d3.geo.guyou=bt(St),(d3.geo.hammerRetroazimuthal=function(){var t=0,n=x(_t),e=n(t),r=e.rotate,a=e.stream,i=d3.geo.circle();return e.parallel=function(r){if(!arguments.length)return t/f*180;var a=e.rotate();return n(t=r*f/180).rotate(a)},e.rotate=function(n){return arguments.length?(r.call(e,[n[0],n[1]-t/f*180]),i.origin([-n[0],-n[1]]),e):((n=r.call(e))[1]+=t/f*180,n)},e.stream=function(t){return(t=a(t)).sphere=function(){t.polygonStart();var n,e=i.angle(89.99)().coordinates[0],r=e.length-1,a=-1;for(t.lineStart();++a<r;)t.point((n=e[a])[0],n[1]);for(t.lineEnd(),r=(e=i.angle(90.01)().coordinates[0]).length-1,t.lineStart();--a>=0;)t.point((n=e[a])[0],n[1]);t.lineEnd(),t.polygonEnd()},t},e}).raw=_t;var Tt=d3.geo.azimuthalEqualArea.raw;function zt(t,n){if(arguments.length<2&&(n=t),1===n)return Tt;if(n===1/0)return Et;function e(e,r){var a=Tt(e/n,r);return a[0]*=t,a}return e.invert=function(e,r){var a=Tt.invert(e/t,r);return a[0]*=n,a},e}function Et(t,n){return[t*Math.cos(n)/Math.cos(n/=2),2*Math.sin(n)]}function At(t,n){for(var e,r=Math.sin(n)*(n<0?2.43763:2.67595),a=0;a<20&&(n-=e=(n+Math.sin(n)-r)/(1+Math.cos(n)),!(Math.abs(e)<c));a++);return[.85*t*Math.cos(n*=.5),Math.sin(n)*(n<0?1.93052:1.75859)]}Et.invert=function(t,n){var e=2*m(n/2);return[t*Math.cos(e/2)/Math.cos(e),e]},(d3.geo.hammer=function(){var t=2,n=x(zt),e=n(t);return e.coefficient=function(e){return arguments.length?n(t=+e):t},e}).raw=zt,At.invert=function(t,n){var e=Math.abs(e=n*(n<0?.5179951515653813:.5686373742600607))>1-c?e>0?p:-p:m(e);return[1.1764705882352942*t/Math.cos(e),Math.abs(e=((e+=e)+Math.sin(e))*(n<0?.4102345310814193:.3736990601468637))>1-c?e>0?p:-p:m(e)]},(d3.geo.hatano=function(){return w(At)}).raw=At;var Nt=41+48/36+37/3600;function jt(t){var n=d3.geo.cylindricalEqualArea.raw(0),e=Nt*f/180,r=2*f,a=d3.geo.collignon.raw(f,e)[0]-d3.geo.collignon.raw(-f,e)[0],i=n(0,e)[1],o=d3.geo.collignon.raw(0,e)[1],s=d3.geo.collignon.raw(0,p)[1]-o,l=2*f/t;function u(u,c){var h,p=Math.abs(c);if(p>e){var d=Math.min(t-1,Math.max(0,Math.floor((u+f)/l)));u+=f*(t-1)/t-d*l,(h=d3.geo.collignon.raw(u,p))[0]=h[0]*r/a-r*(t-1)/(2*t)+d*r/t,h[1]=i+4*(h[1]-o)*s/r,c<0&&(h[1]=-h[1])}else h=n(u,c);return h[0]/=2,h}return u.invert=function(e,u){e*=2;var c=Math.abs(u);if(c>i){var h=Math.min(t-1,Math.max(0,Math.floor((e+f)/l)));e=(e+f*(t-1)/t-h*l)*a/r;var p=d3.geo.collignon.raw.invert(e,.25*(c-i)*r/s+o);return p[0]-=f*(t-1)/t-h*l,u<0&&(p[1]=-p[1]),p}return n.invert(e,u)},u}function Lt(t){var n,e=1+t,r=m(Math.sin(1/e)),a=2*Math.sqrt(f/(n=f+4*r*e)),i=.5*a*(e+Math.sqrt(t*(2+t))),o=t*t,s=e*e;function l(l,u){var c,d,g=1-Math.sin(u);if(g&&g<2){var v,M=p-u,m=25;do{var y=Math.sin(M),b=Math.cos(M),w=r+Math.atan2(y,e-b),x=1+s-2*e*b;M-=v=(M-o*r-e*y+x*w-.5*g*n)/(2*e*y*w)}while(Math.abs(v)>h&&--m>0);c=a*Math.sqrt(x),d=l*w/f}else c=a*(t+g),d=l*r/f;return[c*Math.sin(d),i-c*Math.cos(d)]}return l.invert=function(t,l){var u=t*t+(l-=i)*l,c=(1+s-u/(a*a))/(2*e),h=y(c),p=Math.sin(h),d=r+Math.atan2(p,e-c);return[m(t/Math.sqrt(u))*f/d,m(1-2*(h-o*r-e*p+(1+s-2*e*c)*d)/n)]},l}(d3.geo.healpix=function(){var t=2,n=x(jt),e=n(t),r=e.stream;return e.lobes=function(e){return arguments.length?n(t=+e):t},e.stream=function(n){var a=e.rotate(),i=r(n),o=(e.rotate([0,0]),r(n));return e.rotate(a),i.sphere=function(){var n;d3.geo.stream((n=180/t,{type:"Polygon",coordinates:[d3.range(-180,180+n/2,n).map(function(t,n){return[t,1&n?89.999999:Nt]}).concat(d3.range(180,-180-n/2,-n).map(function(t,n){return[t,1&n?-89.999999:-Nt]}))]}),o)},i},e}).raw=jt,(d3.geo.hill=function(){var t=1,n=x(Lt),e=n(t);return e.ratio=function(e){return arguments.length?n(t=+e):t},e}).raw=Lt;var Pt=.7109889596207567,Ct=.0528035274542;function Dt(t,n){return n>-Pt?((t=D(t,n))[1]+=Ct,t):F(t,n)}function It(t,n){return Math.abs(n)>Pt?((t=D(t,n))[1]-=n>0?Ct:-Ct,t):F(t,n)}function Rt(t,n){return[3*t/(2*f)*Math.sqrt(f*f/3-n*n),n]}function Ft(t){function n(n,e){if(Math.abs(Math.abs(e)-p)<c)return[0,e<0?-2:2];var r=Math.sin(e),a=Math.pow((1+r)/(1-r),t/2),i=.5*(a+1/a)+Math.cos(n*=t);return[2*Math.sin(n)/i,(a-1/a)/i]}return n.invert=function(n,e){var r=Math.abs(e);if(Math.abs(r-2)<c)return n?null:[0,M(e)*p];if(r>2)return null;var a=(n/=2)*n,i=(e/=2)*e,o=2*e/(1+a+i);return o=Math.pow((1+o)/(1-o),1/t),[Math.atan2(2*n,1-a-i)/t,m((o-1)/(o+1))]},n}function Ot(t,n){return[t*(1+Math.sqrt(Math.cos(n)))/2,n/(Math.cos(n/2)*Math.cos(t/6))]}function Ut(t,n){var e=t*t,r=n*n;return[t*(.975534+r*(-.0143059*e-.119161+-.0547009*r)),n*(1.00384+e*(.0802894+-.02855*r+199025e-9*e)+r*(.0998909+-.0491032*r))]}function Ht(t,n){return[Math.sin(t)/Math.cos(n),Math.tan(n)*Math.cos(t)]}function Bt(t){var n=Math.cos(t),e=Math.tan(f/4+t/2);function r(r,a){var i=a-t,o=Math.abs(i)<c?r*n:Math.abs(o=f/4+a/2)<c||Math.abs(Math.abs(o)-p)<c?0:r*i/Math.log(Math.tan(o)/e);return[o,i]}return r.invert=function(r,a){var i,o=a+t;return[Math.abs(a)<c?r/n:Math.abs(i=f/4+o/2)<c||Math.abs(Math.abs(i)-p)<c?0:r*Math.log(Math.tan(i)/e)/a,o]},r}function Qt(t,n){return[t,1.25*Math.log(Math.tan(f/4+.4*n))]}function Vt(t){var n=t.length-1;function e(e,r){for(var a,i=Math.cos(r),o=2/(1+i*Math.cos(e)),s=o*i*Math.sin(e),l=o*Math.sin(r),u=n,c=t[u],h=c[0],f=c[1];--u>=0;)h=(c=t[u])[0]+s*(a=h)-l*f,f=c[1]+s*f+l*a;return[h=s*(a=h)-l*f,f=s*f+l*a]}return e.invert=function(e,r){var a=20,i=e,o=r;do{for(var s,l=n,u=t[l],h=u[0],f=u[1],p=0,d=0;--l>=0;)p=h+i*(s=p)-o*d,d=f+i*d+o*s,h=(u=t[l])[0]+i*(s=h)-o*f,f=u[1]+i*f+o*s;var g,v,M=(p=h+i*(s=p)-o*d)*p+(d=f+i*d+o*s)*d;i-=g=((h=i*(s=h)-o*f-e)*p+(f=i*f+o*s-r)*d)/M,o-=v=(f*p-h*d)/M}while(Math.abs(g)+Math.abs(v)>c*c&&--a>0);if(a){var y=Math.sqrt(i*i+o*o),b=2*Math.atan(.5*y),w=Math.sin(b);return[Math.atan2(i*w,y*Math.cos(b)),y?m(o*w/y):0]}},e}Dt.invert=function(t,n){return n>-Pt?D.invert(t,n-Ct):F.invert(t,n)},(d3.geo.sinuMollweide=function(){return w(Dt).rotate([-20,-55])}).raw=Dt,It.invert=function(t,n){return Math.abs(n)>Pt?D.invert(t,n+(n>0?Ct:-Ct)):F.invert(t,n)},(d3.geo.homolosine=function(){return w(It)}).raw=It,Rt.invert=function(t,n){return[2/3*f*t/Math.sqrt(f*f/3-n*n),n]},(d3.geo.kavrayskiy7=function(){return w(Rt)}).raw=Rt,(d3.geo.lagrange=function(){var t=.5,n=x(Ft),e=n(t);return e.spacing=function(e){return arguments.length?n(t=+e):t},e}).raw=Ft,Ot.invert=function(t,n){var e=Math.abs(t),r=Math.abs(n),a=f/Math.SQRT2,i=c,o=p;r<a?o*=r/a:i+=6*y(a/r);for(var s=0;s<25;s++){var l=Math.sin(o),u=b(Math.cos(o)),h=Math.sin(o/2),d=Math.cos(o/2),g=Math.sin(i/6),v=Math.cos(i/6),M=.5*i*(1+u)-e,m=o/(d*v)-r,w=u?-.25*i*l/u:0,x=.5*(1+u),k=(1+.5*o*h/d)/(d*v),S=o/d*(g/6)/(v*v),_=w*S-k*x,q=(M*S-m*x)/_,T=(m*w-M*k)/_;if(o-=q,i-=T,Math.abs(q)<c&&Math.abs(T)<c)break}return[t<0?-i:i,n<0?-o:o]},(d3.geo.larrivee=function(){return w(Ot)}).raw=Ot,Ut.invert=function(t,n){var e=M(t)*f,r=n/2,a=50;do{var i=e*e,o=r*r,s=e*r,l=e*(.975534+o*(-.0143059*i-.119161+-.0547009*o))-t,u=r*(1.00384+i*(.0802894+-.02855*o+199025e-9*i)+o*(.0998909+-.0491032*o))-n,h=.975534-o*(.119161+3*i*.0143059+.0547009*o),p=-s*(.238322+.2188036*o+.0286118*i),d=s*(.1605788+7961e-7*i+-.0571*o),g=1.00384+i*(.0802894+199025e-9*i)+o*(3*(.0998909-.02855*i)-.245516*o),v=p*d-g*h,m=(u*p-l*g)/v,y=(l*d-u*h)/v;e-=m,r-=y}while((Math.abs(m)>c||Math.abs(y)>c)&&--a>0);return a&&[e,r]},(d3.geo.laskowski=function(){return w(Ut)}).raw=Ut,Ht.invert=function(t,n){var e=t*t,r=n*n,a=r+1,i=t?Math.SQRT1_2*Math.sqrt((a-Math.sqrt(e*e+2*e*(r-1)+a*a))/e+1):1/Math.sqrt(a);return[m(t*i),M(n)*y(i)]},(d3.geo.littrow=function(){return w(Ht)}).raw=Ht,(d3.geo.loximuthal=function(){return R(Bt).parallel(40)}).raw=Bt,Qt.invert=function(t,n){return[t,2.5*Math.atan(Math.exp(.8*n))-.625*f]},(d3.geo.miller=function(){return w(Qt)}).raw=Qt;var Gt={alaska:[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],gs48:[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],gs50:[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],miller:[[.9245,0],[0,0],[.01943,0]],lee:[[.721316,0],[0,0],[-.00881625,-.00617325]]};function Yt(t,n){var e=Math.sqrt(6),r=Math.sqrt(7),a=Math.asin(7*Math.sin(n)/(3*e));return[e*t*(2*Math.cos(2*a/3)-1)/r,9*Math.sin(a/3)/r]}function Wt(t,n){for(var e,r=(1+Math.SQRT1_2)*Math.sin(n),a=n,i=0;i<25&&(a-=e=(Math.sin(a/2)+Math.sin(a)-r)/(.5*Math.cos(a/2)+Math.cos(a)),!(Math.abs(e)<c));i++);return[t*(1+2*Math.cos(a)/Math.cos(a/2))/(3*Math.SQRT2),2*Math.sqrt(3)*Math.sin(a/2)/Math.sqrt(2+Math.SQRT2)]}function $t(t,n){for(var e,r=Math.sqrt(6/(4+f)),a=(1+f/4)*Math.sin(n),i=n/2,o=0;o<25&&(i-=e=(i/2+Math.sin(i)-a)/(.5+Math.cos(i)),!(Math.abs(e)<c));o++);return[r*(.5+Math.cos(i))*t/1.5,r*i]}function Zt(t,n){var e=n*n,r=e*e;return[t*(.8707-.131979*e+r*(r*(.003971*e-.001529*r)-.013791)),n*(1.007226+e*(.015085+r*(.028874*e-.044475-.005916*r)))]}function Xt(t,n){return[t*(1+Math.cos(n))/2,2*(n-Math.tan(n/2))]}(d3.geo.modifiedStereographic=function(){var t=Gt.miller,n=x(Vt),e=n(t);return e.coefficients=function(e){return arguments.length?n(t="string"==typeof e?Gt[e]:e):t},e}).raw=Vt,Yt.invert=function(t,n){var e=Math.sqrt(6),r=Math.sqrt(7),a=3*m(n*r/9);return[t*r/(e*(2*Math.cos(2*a/3)-1)),m(3*Math.sin(a)*e/7)]},(d3.geo.mtFlatPolarParabolic=function(){return w(Yt)}).raw=Yt,Wt.invert=function(t,n){var e=n*Math.sqrt(2+Math.SQRT2)/(2*Math.sqrt(3)),r=2*m(e);return[3*Math.SQRT2*t/(1+2*Math.cos(r)/Math.cos(r/2)),m((e+Math.sin(r))/(1+Math.SQRT1_2))]},(d3.geo.mtFlatPolarQuartic=function(){return w(Wt)}).raw=Wt,$t.invert=function(t,n){var e=Math.sqrt(6/(4+f)),r=n/e;return Math.abs(Math.abs(r)-p)<c&&(r=r<0?-p:p),[1.5*t/(e*(.5+Math.cos(r))),m((r/2+Math.sin(r))/(1+f/4))]},(d3.geo.mtFlatPolarSinusoidal=function(){return w($t)}).raw=$t,Zt.invert=function(t,n){var e,r=n,a=25;do{var i=r*r,o=i*i;r-=e=(r*(1.007226+i*(.015085+o*(.028874*i-.044475-.005916*o)))-n)/(1.007226+i*(.045255+o*(.259866*i-.311325-.005916*11*o)))}while(Math.abs(e)>c&&--a>0);return[t/(.8707+(i=r*r)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),r]},(d3.geo.naturalEarth=function(){return w(Zt)}).raw=Zt,Xt.invert=function(t,n){for(var e=n/2,r=0,a=1/0;r<10&&Math.abs(a)>c;r++){var i=Math.cos(n/2);n-=a=(n-Math.tan(n/2)-e)/(1-.5/(i*i))}return[2*t/(1+Math.cos(n)),n]},(d3.geo.nellHammer=function(){return w(Xt)}).raw=Xt;var Jt=1.0148,Kt=.23185,tn=-.14499,nn=.02406,en=1.790857183;function rn(t,n){var e=n*n;return[t,n*(Jt+e*e*(Kt+e*(tn+nn*e)))]}rn.invert=function(t,n){n>en?n=en:n<-1.790857183&&(n=-1.790857183);var e,r=n;do{var a=r*r;r-=e=(r*(Jt+a*a*(Kt+a*(tn+nn*a)))-n)/(1.0148+a*a*(1.1592500000000001+a*(.21654*a-1.01493)))}while(Math.abs(e)>c);return[t,r]},(d3.geo.patterson=function(){return w(rn)}).raw=rn;var an=bt(St);function on(t,n){if(Math.abs(n)<c)return[t,0];var e=Math.tan(n),r=t*Math.sin(n);return[Math.sin(r)/e,n+(1-Math.cos(r))/e]}function sn(t){var n=Math.sin(t);function e(e,r){var a=n?Math.tan(e*n/2)/n:e/2;if(!r)return[2*a,-t];var i=2*Math.atan(a*Math.sin(r)),o=1/Math.tan(r);return[Math.sin(i)*o,r+(1-Math.cos(i))*o-t]}return e.invert=function(e,r){if(Math.abs(r+=t)<c)return[n?2*Math.atan(n*e/2)/n:e,0];var a,i=e*e+r*r,o=0,s=10;do{var l=Math.tan(o),u=1/Math.cos(o),h=i-2*r*o+o*o;o-=a=(l*h+2*(o-r))/(2+h*u*u+2*(o-r)*l)}while(Math.abs(a)>c&&--s>0);var p=e*(l=Math.tan(o)),d=Math.tan(Math.abs(r)<Math.abs(o+1/l)?.5*m(p):.5*y(p)+f/4)/Math.sin(o);return[n?2*Math.atan(n*d)/n:2*d,o]},e}(d3.geo.peirceQuincuncial=function(){return an().quincuncial(!0).rotate([-90,-90,45]).clipAngle(179.999999)}).raw=an.raw,on.invert=function(t,n){if(Math.abs(n)<c)return[t,0];var e,r=t*t+n*n,a=.5*n,i=10;do{var o=Math.tan(a),s=1/Math.cos(a),l=r-2*n*a+a*a;a-=e=(o*l+2*(a-n))/(2+l*s*s+2*(a-n)*o)}while(Math.abs(e)>c&&--i>0);return o=Math.tan(a),[(Math.abs(n)<Math.abs(a+1/o)?m(t*o):M(t)*(y(Math.abs(t*o))+p))/Math.sin(a),a]},(d3.geo.polyconic=function(){return w(on)}).raw=on,(d3.geo.rectangularPolyconic=function(){return R(sn)}).raw=sn;var ln=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function un(t,n){var e,r=Math.min(18,36*Math.abs(n)/f),a=Math.floor(r),i=r-a,o=(e=ln[a])[0],s=e[1],l=(e=ln[++a])[0],u=e[1],c=(e=ln[Math.min(19,++a)])[0],h=e[1];return[t*(l+i*(c-o)/2+i*i*(c-2*l+o)/2),(n>0?p:-p)*(u+i*(h-s)/2+i*i*(h-2*u+s)/2)]}function cn(t,n){var e=function(t){function n(n,e){var r=Math.cos(e),a=(t-1)/(t-r*Math.cos(n));return[a*r*Math.sin(n),a*Math.sin(e)]}return n.invert=function(n,e){var r=n*n+e*e,a=Math.sqrt(r),i=(t-Math.sqrt(1-r*(t+1)/(t-1)))/((t-1)/a+a/(t-1));return[Math.atan2(n*i,a*Math.sqrt(1-i*i)),a?m(e*i/a):0]},n}(t);if(!n)return e;var r=Math.cos(n),a=Math.sin(n);function i(n,i){var o=e(n,i),s=o[1],l=s*a/(t-1)+r;return[o[0]*r/l,s/l]}return i.invert=function(n,i){var o=(t-1)/(t-1-i*a);return e.invert(o*n,o*i*r)},i}function hn(t,n){var e=Math.tan(n/2),r=Math.sin(f/4*e);return[t*(.74482-.34588*r*r),1.70711*e]}function fn(t){if(!t)return d3.geo.azimuthalEquidistant.raw;var n=-t/2,e=-n,r=t*t,a=Math.tan(e),i=.5/Math.sin(e);function o(a,i){var o=y(Math.cos(i)*Math.cos(a-n)),s=y(Math.cos(i)*Math.cos(a-e));return[((o*=o)-(s*=s))/(2*t),(i<0?-1:1)*b(4*r*s-(r-o+s)*(r-o+s))/(2*t)]}return o.invert=function(t,r){var o,s,l=r*r,u=Math.cos(Math.sqrt(l+(o=t+n)*o)),c=Math.cos(Math.sqrt(l+(o=t+e)*o));return[Math.atan2(s=u-c,o=(u+c)*a),(r<0?-1:1)*y(Math.sqrt(o*o+s*s)*i)]},o}function pn(t){var n=Math.cos(t);function e(t,e){var r=d3.geo.gnomonic.raw(t,e);return r[0]*=n,r}return e.invert=function(t,e){return d3.geo.gnomonic.raw.invert(t/n,e)},e}function dn(t,n){if(Math.abs(n)<c)return[t,0];var e=Math.abs(n/p),r=m(e);if(Math.abs(t)<c||Math.abs(Math.abs(n)-p)<c)return[0,M(n)*f*Math.tan(r/2)];var a=Math.cos(r),i=Math.abs(f/t-t/f)/2,o=i*i,s=a/(e+a-1),l=s*(2/e-1),u=l*l,h=u+o,d=s-u,g=o+s;return[M(t)*f*(i*d+Math.sqrt(o*d*d-h*(s*s-u)))/h,M(n)*f*(l*g-i*Math.sqrt((o+1)*h-g*g))/h]}function gn(t,n){if(Math.abs(n)<c)return[t,0];var e=Math.abs(n/p),r=m(e);if(Math.abs(t)<c||Math.abs(Math.abs(n)-p)<c)return[0,M(n)*f*Math.tan(r/2)];var a=Math.cos(r),i=Math.abs(f/t-t/f)/2,o=i*i,s=a*(Math.sqrt(1+o)-i*a)/(1+o*e*e);return[M(t)*f*s,M(n)*f*b(1-s*(2*i+s))]}function vn(t,n){if(Math.abs(n)<c)return[t,0];var e=n/p,r=m(e);if(Math.abs(t)<c||Math.abs(Math.abs(n)-p)<c)return[0,f*Math.tan(r/2)];var a=(f/t-t/f)/2,i=e/(1+Math.cos(r));return[f*(M(t)*b(a*a+1-i*i)-a),f*i]}function Mn(t,n){if(!n)return[t,0];var e=Math.abs(n);if(!t||e===p)return[0,n];var r=e/p,a=r*r,i=(8*r-a*(a+2)-5)/(2*a*(r-1)),o=i*i,s=r*i,l=a+o+2*s,u=r+3*i,c=t/p,h=c+1/c,f=M(Math.abs(t)-p)*Math.sqrt(h*h-4),d=f*f,g=(f*(l+o-1)+2*b(l*(a+o*d-1)+(1-a)*(a*(u*u+4*o)+12*s*o+4*o*o)))/(4*l+d);return[M(t)*p*g,M(n)*p*b(1+f*Math.abs(g)-g*g)]}ln.forEach(function(t){t[1]*=1.0144}),un.invert=function(t,n){var e=n/p,r=90*e,a=Math.min(18,Math.abs(r/5)),i=Math.max(0,Math.floor(a));do{var o=ln[i][1],s=ln[i+1][1],l=ln[Math.min(19,i+2)][1],u=l-o,c=l-2*s+o,f=2*(Math.abs(e)-s)/u,d=c/u,M=f*(1-d*f*(1-2*d*f));if(M>=0||1===i){r=(n>=0?5:-5)*(M+a);var m,y=50;do{M=(a=Math.min(18,Math.abs(r)/5))-(i=Math.floor(a)),o=ln[i][1],s=ln[i+1][1],l=ln[Math.min(19,i+2)][1],r-=(m=(n>=0?p:-p)*(s+M*(l-o)/2+M*M*(l-2*s+o)/2)-n)*v}while(Math.abs(m)>h&&--y>0);break}}while(--i>=0);var b=ln[i][0],w=ln[i+1][0],x=ln[Math.min(19,i+2)][0];return[t/(w+M*(x-b)/2+M*M*(x-2*w+b)/2),r*g]},(d3.geo.robinson=function(){return w(un)}).raw=un,(d3.geo.satellite=function(){var t=1.4,n=0,e=x(cn),r=e(t,n);return r.distance=function(r){return arguments.length?e(t=+r,n):t},r.tilt=function(r){return arguments.length?e(t,n=r*f/180):180*n/f},r}).raw=cn,hn.invert=function(t,n){var e=n/1.70711,r=Math.sin(f/4*e);return[t/(.74482-.34588*r*r),2*Math.atan(e)]},(d3.geo.times=function(){return w(hn)}).raw=hn,(d3.geo.twoPointEquidistant=function(){var t=[[0,0],[0,0]],n=x(fn),e=n(0),r=e.rotate;return delete e.rotate,e.points=function(e){if(!arguments.length)return t;t=e;var a=d3.geo.interpolate(e[0],e[1]),i=a(.5),o=d3.geo.rotation([-i[0],-i[1]])(e[0]),s=.5*a.distance,l=-m(Math.sin(o[1]*g)/Math.sin(s));return o[0]>0&&(l=f-l),r.call(o,[-i[0],-i[1],-l*v]),n(2*s)},e}).raw=fn,(d3.geo.twoPointAzimuthal=function(){var t=[[0,0],[0,0]],n=x(pn),e=n(0),r=e.rotate;return delete e.rotate,e.points=function(e){if(!arguments.length)return t;t=e;var a=d3.geo.interpolate(e[0],e[1]),i=a(.5),o=d3.geo.rotation([-i[0],-i[1]])(e[0]),s=.5*a.distance,l=-m(Math.sin(o[1]*g)/Math.sin(s));return o[0]>0&&(l=f-l),r.call(o,[-i[0],-i[1],-l*v]),n(s)},e}).raw=pn,dn.invert=function(t,n){if(Math.abs(n)<c)return[t,0];if(Math.abs(t)<c)return[0,p*Math.sin(2*Math.atan(n/f))];var e=(t/=f)*t,r=(n/=f)*n,a=e+r,i=a*a,o=-Math.abs(n)*(1+a),s=o-2*r+e,l=-2*o+1+2*r+i,u=r/l+(2*s*s*s/(l*l*l)-9*o*s/(l*l))/27,h=(o-s*s/(3*l))/l,d=2*Math.sqrt(-h/3),g=y(3*u/(h*d))/3;return[f*(a-1+Math.sqrt(1+2*(e-r)+i))/(2*t),M(n)*f*(-d*Math.cos(g+f/3)-s/(3*l))]},(d3.geo.vanDerGrinten=function(){return w(dn)}).raw=dn,gn.invert=function(t,n){if(!t)return[0,p*Math.sin(2*Math.atan(n/f))];var e=Math.abs(t/f),r=(1-e*e-(n/=f)*n)/(2*e),a=Math.sqrt(r*r+1);return[M(t)*f*(a-r),M(n)*p*Math.sin(2*Math.atan2(Math.sqrt((1-2*r*e)*(r+a)-e),Math.sqrt(a+r+e)))]},(d3.geo.vanDerGrinten2=function(){return w(gn)}).raw=gn,vn.invert=function(t,n){if(!n)return[t,0];var e=n/f,r=(f*f*(1-e*e)-t*t)/(2*f*t);return[t?f*(M(t)*Math.sqrt(r*r+1)-r):0,p*Math.sin(2*Math.atan(e))]},(d3.geo.vanDerGrinten3=function(){return w(vn)}).raw=vn,Mn.invert=function(t,n){if(!t||!n)return[t,n];n/=f;var e=M(t)*t/p,r=(e*e-1+4*n*n)/Math.abs(e),a=r*r,i=2*n,o=50;do{var s=i*i,l=(8*i-s*(s+2)-5)/(2*s*(i-1)),u=(3*i-s*i-10)/(2*s*i),h=l*l,d=i*l,g=i+l,v=g*g,m=i+3*l,y=-2*g*(4*d*h+(1-4*s+3*s*s)*(1+u)+h*(14*s-6-a+(8*s-8-2*a)*u)+d*(12*s-8+(10*s-10-a)*u)),b=Math.sqrt(v*(s+h*a-1)+(1-s)*(s*(m*m+4*h)+h*(12*d+4*h)));i-=\u03b4=(r*(v+h-1)+2*b-e*(4*v+a))/(r*(2*l*u+2*g*(1+u))+y/b-8*g*(r*(-1+h+v)+2*b)*(1+u)/(a+4*v))}while(\u03b4>c&&--o>0);return[M(t)*(Math.sqrt(r*r+4)+r)*f/4,p*i]},(d3.geo.vanDerGrinten4=function(){return w(Mn)}).raw=Mn;var mn,yn,bn=(mn=4*f+3*Math.sqrt(3),P((yn=2*Math.sqrt(2*f*Math.sqrt(3)/mn))*Math.sqrt(3)/f,yn,mn/6));function wn(t,n){return[t*Math.sqrt(1-3*n*n/(f*f)),n]}function xn(t,n){var e=.90631*Math.sin(n),r=Math.sqrt(1-e*e),a=Math.sqrt(2/(1+r*Math.cos(t/=3)));return[2.66723*r*a*Math.sin(t),1.24104*e*a]}function kn(t,n){var e=Math.cos(n),r=Math.cos(t)*e,a=1-r,i=Math.cos(t=Math.atan2(Math.sin(t)*e,-Math.sin(n))),o=Math.sin(t);return[o*(e=b(1-r*r))-i*a,-i*e-o*a]}function Sn(t,n){var e=S(t,n);return[(e[0]+t/p)/2,(e[1]+n)/2]}function _n(t,n){var e=Math.cos(n),r=Math.tan(n),a=Math.cos(t),i=Math.sin(t);return[Math.asin(e*i),Math.atan2(r,a)]}(d3.geo.wagner4=function(){return w(bn)}).raw=bn,wn.invert=function(t,n){return[t/Math.sqrt(1-3*n*n/(f*f)),n]},(d3.geo.wagner6=function(){return w(wn)}).raw=wn,xn.invert=function(t,n){var e=t/2.66723,r=n/1.24104,a=Math.sqrt(e*e+r*r),i=2*m(a/2);return[3*Math.atan2(t*Math.tan(i),2.66723*a),a&&m(n*Math.sin(i)/(1.24104*.90631*a))]},(d3.geo.wagner7=function(){return w(xn)}).raw=xn,kn.invert=function(t,n){var e=-.5*(t*t+n*n),r=Math.sqrt(-e*(2+e)),a=n*e+t*r,i=t*e-n*r,o=Math.sqrt(i*i+a*a);return[Math.atan2(r*a,o*(1+e)),o?-m(r*i/o):0]},(d3.geo.wiechel=function(){return w(kn)}).raw=kn,Sn.invert=function(t,n){var e=t,r=n,a=25;do{var i,o=Math.cos(r),s=Math.sin(r),l=Math.sin(2*r),u=s*s,h=o*o,f=Math.sin(e),d=Math.cos(e/2),g=Math.sin(e/2),v=g*g,M=1-h*d*d,m=M?y(o*d)*Math.sqrt(i=1/M):i=0,b=.5*(2*m*o*g+e/p)-t,w=.5*(m*s+r)-n,x=.5*i*(h*v+m*o*d*u)+.5/p,k=i*(f*l/4-m*s*g),S=.125*i*(l*g-m*s*h*f),_=.5*i*(u*d+m*v*o)+.5,q=k*S-_*x,T=(w*k-b*_)/q,z=(b*S-w*x)/q;e-=T,r-=z}while((Math.abs(T)>c||Math.abs(z)>c)&&--a>0);return[e,r]},(d3.geo.winkel3=function(){return w(Sn)}).raw=Sn,_n.invert=function(t,n){return[Math.asin(Math.cos(t)*Math.sin(n)),Math.atan2(Math.tan(t),Math.cos(n))]},(d3.geo.cassini=function(){return w(_n)}).raw=_n}();